/* esm.sh - esbuild bundle(hot-formula-parser@4.0.0) es2022 production */
var lt=Object.create;var Mn=Object.defineProperty;var ct=Object.getOwnPropertyDescriptor;var vt=Object.getOwnPropertyNames;var Et=Object.getPrototypeOf,gt=Object.prototype.hasOwnProperty;var vr=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var pt=(r,e,n,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of vt(e))!gt.call(r,o)&&o!==n&&Mn(r,o,{get:()=>e[o],enumerable:!(a=ct(e,o))||a.enumerable});return r};var Cn=(r,e,n)=>(n=r!=null?lt(Et(r)):{},pt(e||!r||!r.__esModule?Mn(n,"default",{value:r,enumerable:!0}):n,r));var Ln=vr((mu,nn)=>{function en(){}en.prototype={on:function(r,e,n){var a=this.e||(this.e={});return(a[r]||(a[r]=[])).push({fn:e,ctx:n}),this},once:function(r,e,n){var a=this;function o(){a.off(r,o),e.apply(n,arguments)}return o._=e,this.on(r,o,n)},emit:function(r){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[r]||[]).slice(),a=0,o=n.length;for(a;a<o;a++)n[a].fn.apply(n[a].ctx,e);return this},off:function(r,e){var n=this.e||(this.e={}),a=n[r],o=[];if(a&&e)for(var l=0,c=a.length;l<c;l++)a[l].fn!==e&&a[l].fn._!==e&&o.push(a[l]);return o.length?n[r]=o:delete n[r],this}};nn.exports=en;nn.exports.TinyEmitter=en});var wr=vr(Kr=>{Kr.nil=new Error("#NULL!");Kr.div0=new Error("#DIV/0!");Kr.value=new Error("#VALUE!");Kr.ref=new Error("#REF!");Kr.name=new Error("#NAME?");Kr.num=new Error("#NUM!");Kr.na=new Error("#N/A");Kr.error=new Error("#ERROR!");Kr.data=new Error("#GETTING_DATA")});var Hr=vr(_=>{var Qr=wr();_.flattenShallow=function(r){return!r||!r.reduce?r:r.reduce(function(e,n){var a=Array.isArray(e),o=Array.isArray(n);return a&&o?e.concat(n):a?(e.push(n),e):o?[e].concat(n):[e,n]})};_.isFlat=function(r){if(!r)return!1;for(var e=0;e<r.length;++e)if(Array.isArray(r[e]))return!1;return!0};_.flatten=function(){for(var r=_.argsToArray.apply(null,arguments);!_.isFlat(r);)r=_.flattenShallow(r);return r};_.argsToArray=function(r){var e=[];return _.arrayEach(r,function(n){e.push(n)}),e};_.numbers=function(){var r=this.flatten.apply(null,arguments);return r.filter(function(e){return typeof e=="number"})};_.cleanFloat=function(r){var e=1e14;return Math.round(r*e)/e};_.parseBool=function(r){if(typeof r=="boolean"||r instanceof Error)return r;if(typeof r=="number")return r!==0;if(typeof r=="string"){var e=r.toUpperCase();if(e==="TRUE")return!0;if(e==="FALSE")return!1}return r instanceof Date&&!isNaN(r)?!0:Qr.value};_.parseNumber=function(r){return r===void 0||r===""||isNaN(r)?Qr.value:parseFloat(r)};_.parseNumberArray=function(r){var e;if(!r||(e=r.length)===0)return Qr.value;for(var n;e--;){if(n=_.parseNumber(r[e]),n===Qr.value)return n;r[e]=n}return r};_.parseMatrix=function(r){var e;if(!r||(e=r.length)===0)return Qr.value;for(var n,a=0;a<r.length;a++)if(n=_.parseNumberArray(r[a]),r[a]=n,n instanceof Error)return n;return r};var Fn=new Date(Date.UTC(1900,0,1));_.parseDate=function(r){if(!isNaN(r)){if(r instanceof Date)return new Date(r);var e=parseInt(r,10);return e<0?Qr.num:e<=60?new Date(Fn.getTime()+(e-1)*864e5):new Date(Fn.getTime()+(e-2)*864e5)}return typeof r=="string"&&(r=new Date(r),!isNaN(r))?r:Qr.value};_.parseDateArray=function(r){for(var e=r.length,n;e--;){if(n=this.parseDate(r[e]),n===Qr.value)return n;r[e]=n}return r};_.anyIsError=function(){for(var r=arguments.length;r--;)if(arguments[r]instanceof Error)return!0;return!1};_.arrayValuesToNumbers=function(r){for(var e=r.length,n;e--;)if(n=r[e],typeof n!="number"){if(n===!0){r[e]=1;continue}if(n===!1){r[e]=0;continue}if(typeof n=="string"){var a=this.parseNumber(n);a instanceof Error?r[e]=0:r[e]=a}}return r};_.rest=function(r,e){return e=e||1,!r||typeof r.slice!="function"?r:r.slice(e)};_.initial=function(r,e){return e=e||1,!r||typeof r.slice!="function"?r:r.slice(0,r.length-e)};_.arrayEach=function(r,e){for(var n=-1,a=r.length;++n<a&&e(r[n],n,r)!==!1;);return r};_.transpose=function(r){return r?r[0].map(function(e,n){return r.map(function(a){return a[n]})}):Qr.value}});var Ue=vr(k=>{var kr=Hr(),Er=wr();k.ASC=function(){throw new Error("ASC is not implemented")};k.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")};k.CHAR=function(r){return r=kr.parseNumber(r),r instanceof Error?r:String.fromCharCode(r)};k.CLEAN=function(r){r=r||"";var e=/[\0-\x1F]/g;return r.replace(e,"")};k.CODE=function(r){r=r||"";var e=r.charCodeAt(0);return isNaN(e)&&(e=Er.na),e};k.CONCATENATE=function(){for(var r=kr.flatten(arguments),e=0;(e=r.indexOf(!0))>-1;)r[e]="TRUE";for(var n=0;(n=r.indexOf(!1))>-1;)r[n]="FALSE";return r.join("")};k.DBCS=function(){throw new Error("DBCS is not implemented")};k.DOLLAR=function(){throw new Error("DOLLAR is not implemented")};k.EXACT=function(r,e){return arguments.length!==2?Er.na:r===e};k.FIND=function(r,e,n){return arguments.length<2?Er.na:(n=n===void 0?0:n,e?e.indexOf(r,n-1)+1:null)};k.FIXED=function(){throw new Error("FIXED is not implemented")};k.HTML2TEXT=function(r){var e="";return r&&(r instanceof Array?r.forEach(function(n){e!==""&&(e+=`
`),e+=n.replace(/<(?:.|\n)*?>/gm,"")}):e=r.replace(/<(?:.|\n)*?>/gm,"")),e};k.LEFT=function(r,e){return e=e===void 0?1:e,e=kr.parseNumber(e),e instanceof Error||typeof r!="string"?Er.value:r?r.substring(0,e):null};k.LEN=function(r){return arguments.length===0?Er.error:typeof r=="string"?r?r.length:0:r.length?r.length:Er.value};k.LOWER=function(r){return typeof r!="string"?Er.value:r&&r.toLowerCase()};k.MID=function(r,e,n){if(e=kr.parseNumber(e),n=kr.parseNumber(n),kr.anyIsError(e,n)||typeof r!="string")return n;var a=e-1,o=a+n;return r.substring(a,o)};k.NUMBERVALUE=function(r,e,n){return e=typeof e>"u"?".":e,n=typeof n>"u"?",":n,Number(r.replace(e,".").replace(n,""))};k.PRONETIC=function(){throw new Error("PRONETIC is not implemented")};k.PROPER=function(r){return r===void 0||r.length===0||(r===!0&&(r="TRUE"),r===!1&&(r="FALSE"),isNaN(r)&&typeof r=="number")?Er.value:(typeof r=="number"&&(r=""+r),r.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))};k.REGEXEXTRACT=function(r,e){if(arguments.length<2)return Er.na;var n=r.match(new RegExp(e));return n?n[n.length>1?n.length-1:0]:null};k.REGEXMATCH=function(r,e,n){if(arguments.length<2)return Er.na;var a=r.match(new RegExp(e));return n?a:!!a};k.REGEXREPLACE=function(r,e,n){return arguments.length<3?Er.na:r.replace(new RegExp(e),n)};k.REPLACE=function(r,e,n,a){return e=kr.parseNumber(e),n=kr.parseNumber(n),kr.anyIsError(e,n)||typeof r!="string"||typeof a!="string"?Er.value:r.substr(0,e-1)+a+r.substr(e-1+n)};k.REPT=function(r,e){return e=kr.parseNumber(e),e instanceof Error?e:new Array(e+1).join(r)};k.RIGHT=function(r,e){return e=e===void 0?1:e,e=kr.parseNumber(e),e instanceof Error?e:r?r.substring(r.length-e):Er.na};k.SEARCH=function(r,e,n){var a;return typeof r!="string"||typeof e!="string"?Er.value:(n=n===void 0?0:n,a=e.toLowerCase().indexOf(r.toLowerCase(),n-1)+1,a===0?Er.value:a)};k.SPLIT=function(r,e){return r.split(e)};k.SUBSTITUTE=function(r,e,n,a){if(arguments.length<2)return Er.na;if(!r||!e||!n)return r;if(a===void 0)return r.replace(new RegExp(e,"g"),n);for(var o=0,l=0;r.indexOf(e,o)>0;)if(o=r.indexOf(e,o+1),l++,l===a)return r.substring(0,o)+n+r.substring(o+e.length)};k.T=function(r){return typeof r=="string"?r:""};k.TEXT=function(){throw new Error("TEXT is not implemented")};k.TRIM=function(r){return typeof r!="string"?Er.value:r.replace(/ +/g," ").trim()};k.UNICHAR=k.CHAR;k.UNICODE=k.CODE;k.UPPER=function(r){return typeof r!="string"?Er.value:r.toUpperCase()};k.VALUE=function(){throw new Error("VALUE is not implemented")}});var un=vr((tn,bn)=>{(function(r,e){typeof tn=="object"?bn.exports=e():typeof define=="function"&&define.amd?define(e):r.jStat=e()})(tn,function(){var r=function(e,n){var a=Array.prototype.concat,o=Array.prototype.slice,l=Object.prototype.toString;function c(h,N){var m=h>N?h:N;return e.pow(10,17-~~(e.log(m>0?m:-m)*e.LOG10E))}var i=Array.isArray||function(N){return l.call(N)==="[object Array]"};function t(h){return l.call(h)==="[object Function]"}function u(h){return typeof h=="number"?h-h===0:!1}function f(h){return a.apply([],h)}function s(){return new s._init(arguments)}s.fn=s.prototype,s._init=function(N){if(i(N[0]))if(i(N[0][0])){t(N[1])&&(N[0]=s.map(N[0],N[1]));for(var m=0;m<N[0].length;m++)this[m]=N[0][m];this.length=N[0].length}else this[0]=t(N[1])?s.map(N[0],N[1]):N[0],this.length=1;else if(u(N[0]))this[0]=s.seq.apply(null,N),this.length=1;else{if(N[0]instanceof s)return s(N[0].toArray());this[0]=[],this.length=1}return this},s._init.prototype=s.prototype,s._init.constructor=s,s.utils={calcRdx:c,isArray:i,isFunction:t,isNumber:u,toVector:f},s._random_fn=e.random,s.setRandom=function(N){if(typeof N!="function")throw new TypeError("fn is not a function");s._random_fn=N},s.extend=function(N){var m,A;if(arguments.length===1){for(A in N)s[A]=N[A];return this}for(m=1;m<arguments.length;m++)for(A in arguments[m])N[A]=arguments[m][A];return N},s.rows=function(N){return N.length||1},s.cols=function(N){return N[0].length||1},s.dimensions=function(N){return{rows:s.rows(N),cols:s.cols(N)}},s.row=function(N,m){return i(m)?m.map(function(A){return s.row(N,A)}):N[m]},s.rowa=function(N,m){return s.row(N,m)},s.col=function(N,m){if(i(m)){var A=s.arange(N.length).map(function(){return new Array(m.length)});return m.forEach(function(C,V){s.arange(N.length).forEach(function(P){A[P][V]=N[P][C]})}),A}for(var R=new Array(N.length),y=0;y<N.length;y++)R[y]=[N[y][m]];return R},s.cola=function(N,m){return s.col(N,m).map(function(A){return A[0]})},s.diag=function(N){for(var m=s.rows(N),A=new Array(m),R=0;R<m;R++)A[R]=[N[R][R]];return A},s.antidiag=function(N){for(var m=s.rows(N)-1,A=new Array(m),R=0;m>=0;m--,R++)A[R]=[N[R][m]];return A},s.transpose=function(N){var m=[],A,R,y,C,V;for(i(N[0])||(N=[N]),R=N.length,y=N[0].length,V=0;V<y;V++){for(A=new Array(R),C=0;C<R;C++)A[C]=N[C][V];m.push(A)}return m.length===1?m[0]:m},s.map=function(N,m,A){var R,y,C,V,P;for(i(N[0])||(N=[N]),y=N.length,C=N[0].length,V=A?N:new Array(y),R=0;R<y;R++)for(V[R]||(V[R]=new Array(C)),P=0;P<C;P++)V[R][P]=m(N[R][P],R,P);return V.length===1?V[0]:V},s.cumreduce=function(N,m,A){var R,y,C,V,P;for(i(N[0])||(N=[N]),y=N.length,C=N[0].length,V=A?N:new Array(y),R=0;R<y;R++)for(V[R]||(V[R]=new Array(C)),C>0&&(V[R][0]=N[R][0]),P=1;P<C;P++)V[R][P]=m(V[R][P-1],N[R][P]);return V.length===1?V[0]:V},s.alter=function(N,m){return s.map(N,m,!0)},s.create=function(N,m,A){var R=new Array(N),y,C;for(t(m)&&(A=m,m=N),y=0;y<N;y++)for(R[y]=new Array(m),C=0;C<m;C++)R[y][C]=A(y,C);return R};function v(){return 0}s.zeros=function(N,m){return u(m)||(m=N),s.create(N,m,v)};function E(){return 1}s.ones=function(N,m){return u(m)||(m=N),s.create(N,m,E)},s.rand=function(N,m){return u(m)||(m=N),s.create(N,m,s._random_fn)};function p(h,N){return h===N?1:0}s.identity=function(N,m){return u(m)||(m=N),s.create(N,m,p)},s.symmetric=function(N){var m=N.length,A,R;if(N.length!==N[0].length)return!1;for(A=0;A<m;A++)for(R=0;R<m;R++)if(N[R][A]!==N[A][R])return!1;return!0},s.clear=function(N){return s.alter(N,v)},s.seq=function(N,m,A,R){t(R)||(R=!1);var y=[],C=c(N,m),V=(m*C-N*C)/((A-1)*C),P=N,Y;for(Y=0;P<=m&&Y<A;Y++,P=(N*C+V*C*Y)/C)y.push(R?R(P,Y):P);return y},s.arange=function(N,m,A){var R=[],y;if(A=A||1,m===n&&(m=N,N=0),N===m||A===0)return[];if(N<m&&A<0)return[];if(N>m&&A>0)return[];if(A>0)for(y=N;y<m;y+=A)R.push(y);else for(y=N;y>m;y+=A)R.push(y);return R},s.slice=function(){function h(m,A,R,y){var C,V=[],P=m.length;if(A===n&&R===n&&y===n)return s.copy(m);if(A=A||0,R=R||m.length,A=A>=0?A:P+A,R=R>=0?R:P+R,y=y||1,A===R||y===0)return[];if(A<R&&y<0)return[];if(A>R&&y>0)return[];if(y>0)for(C=A;C<R;C+=y)V.push(m[C]);else for(C=A;C>R;C+=y)V.push(m[C]);return V}function N(m,A){var R,y;if(A=A||{},u(A.row)){if(u(A.col))return m[A.row][A.col];var C=s.rowa(m,A.row);return R=A.col||{},h(C,R.start,R.end,R.step)}if(u(A.col)){var V=s.cola(m,A.col);return y=A.row||{},h(V,y.start,y.end,y.step)}y=A.row||{},R=A.col||{};var P=h(m,y.start,y.end,y.step);return P.map(function(Y){return h(Y,R.start,R.end,R.step)})}return N}(),s.sliceAssign=function(N,m,A){var R,y;if(u(m.row)){if(u(m.col))return N[m.row][m.col]=A;m.col=m.col||{},m.col.start=m.col.start||0,m.col.end=m.col.end||N[0].length,m.col.step=m.col.step||1,R=s.arange(m.col.start,e.min(N.length,m.col.end),m.col.step);var C=m.row;return R.forEach(function(P,Y){N[C][P]=A[Y]}),N}if(u(m.col)){m.row=m.row||{},m.row.start=m.row.start||0,m.row.end=m.row.end||N.length,m.row.step=m.row.step||1,y=s.arange(m.row.start,e.min(N[0].length,m.row.end),m.row.step);var V=m.col;return y.forEach(function(P,Y){N[P][V]=A[Y]}),N}return A[0].length===n&&(A=[A]),m.row.start=m.row.start||0,m.row.end=m.row.end||N.length,m.row.step=m.row.step||1,m.col.start=m.col.start||0,m.col.end=m.col.end||N[0].length,m.col.step=m.col.step||1,y=s.arange(m.row.start,e.min(N.length,m.row.end),m.row.step),R=s.arange(m.col.start,e.min(N[0].length,m.col.end),m.col.step),y.forEach(function(P,Y){R.forEach(function(Ir,z){N[P][Ir]=A[Y][z]})}),N},s.diagonal=function(N){var m=s.zeros(N.length,N.length);return N.forEach(function(A,R){m[R][R]=A}),m},s.copy=function(N){return N.map(function(m){return u(m)?m:m.map(function(A){return A})})};var g=s.prototype;return g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return this.length>1?o.call(this):o.call(this)[0]},g.map=function(N,m){return s(s.map(this,N,m))},g.cumreduce=function(N,m){return s(s.cumreduce(this,N,m))},g.alter=function(N){return s.alter(this,N),this},function(h){for(var N=0;N<h.length;N++)(function(m){g[m]=function(A){var R=this,y;return A?(setTimeout(function(){A.call(R,g[m].call(R))}),this):(y=s[m](this),i(y)?s(y):y)}})(h[N])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(h){for(var N=0;N<h.length;N++)(function(m){g[m]=function(A,R){var y=this;return R?(setTimeout(function(){R.call(y,g[m].call(y,A))}),this):s(s[m](this,A))}})(h[N])}("row col".split(" ")),function(h){for(var N=0;N<h.length;N++)(function(m){g[m]=function(){return s(s[m].apply(null,arguments))}})(h[N])}("create zeros ones rand identity".split(" ")),s}(Math);return function(e,n){var a=e.utils.isFunction;function o(i,t){return i-t}function l(i,t,u){return n.max(t,n.min(i,u))}e.sum=function(t){for(var u=0,f=t.length;--f>=0;)u+=t[f];return u},e.sumsqrd=function(t){for(var u=0,f=t.length;--f>=0;)u+=t[f]*t[f];return u},e.sumsqerr=function(t){for(var u=e.mean(t),f=0,s=t.length,v;--s>=0;)v=t[s]-u,f+=v*v;return f},e.sumrow=function(t){for(var u=0,f=t.length;--f>=0;)u+=t[f];return u},e.product=function(t){for(var u=1,f=t.length;--f>=0;)u*=t[f];return u},e.min=function(t){for(var u=t[0],f=0;++f<t.length;)t[f]<u&&(u=t[f]);return u},e.max=function(t){for(var u=t[0],f=0;++f<t.length;)t[f]>u&&(u=t[f]);return u},e.unique=function(t){for(var u={},f=[],s=0;s<t.length;s++)u[t[s]]||(u[t[s]]=!0,f.push(t[s]));return f},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(t){return n.pow(e.product(t),1/t.length)},e.median=function(t){var u=t.length,f=t.slice().sort(o);return u&1?f[u/2|0]:(f[u/2-1]+f[u/2])/2},e.cumsum=function(t){return e.cumreduce(t,function(u,f){return u+f})},e.cumprod=function(t){return e.cumreduce(t,function(u,f){return u*f})},e.diff=function(t){var u=[],f=t.length,s;for(s=1;s<f;s++)u.push(t[s]-t[s-1]);return u},e.rank=function(i){var t,u=[],f={};for(t=0;t<i.length;t++){var s=i[t];f[s]?f[s]++:(f[s]=1,u.push(s))}var v=u.sort(o),E={},p=1;for(t=0;t<v.length;t++){var s=v[t],g=f[s],h=p,N=p+g-1,m=(h+N)/2;E[s]=m,p+=g}return i.map(function(A){return E[A]})},e.mode=function(t){var u=t.length,f=t.slice().sort(o),s=1,v=0,E=0,p=[],g;for(g=0;g<u;g++)f[g]===f[g+1]?s++:(s>v?(p=[f[g]],v=s,E=0):s===v&&(p.push(f[g]),E++),s=1);return E===0?p[0]:p},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,u){return e.sumsqerr(t)/(t.length-(u?1:0))},e.pooledvariance=function(t){var u=t.reduce(function(s,v){return s+e.sumsqerr(v)},0),f=t.reduce(function(s,v){return s+v.length},0);return u/(f-t.length)},e.deviation=function(i){for(var t=e.mean(i),u=i.length,f=new Array(u),s=0;s<u;s++)f[s]=i[s]-t;return f},e.stdev=function(t,u){return n.sqrt(e.variance(t,u))},e.pooledstdev=function(t){return n.sqrt(e.pooledvariance(t))},e.meandev=function(t){for(var u=e.mean(t),f=[],s=t.length-1;s>=0;s--)f.push(n.abs(t[s]-u));return e.mean(f)},e.meddev=function(t){for(var u=e.median(t),f=[],s=t.length-1;s>=0;s--)f.push(n.abs(t[s]-u));return e.median(f)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(t){var u=t.length,f=t.slice().sort(o);return[f[n.round(u/4)-1],f[n.round(u/2)-1],f[n.round(u*3/4)-1]]},e.quantiles=function(t,u,f,s){var v=t.slice().sort(o),E=[u.length],p=t.length,g,h,N,m,A,R;for(typeof f>"u"&&(f=3/8),typeof s>"u"&&(s=3/8),g=0;g<u.length;g++)h=u[g],N=f+h*(1-f-s),m=p*h+N,A=n.floor(l(m,1,p-1)),R=l(m-A,0,1),E[g]=(1-R)*v[A-1]+R*v[A];return E},e.percentile=function(t,u,f){var s=t.slice().sort(o),v=u*(s.length+(f?1:-1))+(f?0:1),E=parseInt(v),p=v-E;return E+1<s.length?s[E-1]+p*(s[E]-s[E-1]):s[E-1]},e.percentileOfScore=function(t,u,f){var s=0,v=t.length,E=!1,p,g;for(f==="strict"&&(E=!0),g=0;g<v;g++)p=t[g],(E&&p<u||!E&&p<=u)&&s++;return s/v},e.histogram=function(t,u){u=u||4;var f=e.min(t),s=(e.max(t)-f)/u,v=t.length,E=[],p;for(p=0;p<u;p++)E[p]=0;for(p=0;p<v;p++)E[n.min(n.floor((t[p]-f)/s),u-1)]+=1;return E},e.covariance=function(t,u){var f=e.mean(t),s=e.mean(u),v=t.length,E=new Array(v),p;for(p=0;p<v;p++)E[p]=(t[p]-f)*(u[p]-s);return e.sum(E)/(v-1)},e.corrcoeff=function(t,u){return e.covariance(t,u)/e.stdev(t,1)/e.stdev(u,1)},e.spearmancoeff=function(i,t){return i=e.rank(i),t=e.rank(t),e.corrcoeff(i,t)},e.stanMoment=function(t,u){for(var f=e.mean(t),s=e.stdev(t),v=t.length,E=0,p=0;p<v;p++)E+=n.pow((t[p]-f)/s,u);return E/t.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var c=e.prototype;(function(i){for(var t=0;t<i.length;t++)(function(u){c[u]=function(f,s){var v=[],E=0,p=this;if(a(f)&&(s=f,f=!1),s)return setTimeout(function(){s.call(p,c[u].call(p,f))}),this;if(this.length>1){for(p=f===!0?this:this.transpose();E<p.length;E++)v[E]=e[u](p[E]);return v}return e[u](this[0],f)}})(i[t])})("cumsum cumprod".split(" ")),function(i){for(var t=0;t<i.length;t++)(function(u){c[u]=function(f,s){var v=[],E=0,p=this;if(a(f)&&(s=f,f=!1),s)return setTimeout(function(){s.call(p,c[u].call(p,f))}),this;if(this.length>1){for(u!=="sumrow"&&(p=f===!0?this:this.transpose());E<p.length;E++)v[E]=e[u](p[E]);return f===!0?e[u](e.utils.toVector(v)):v}return e[u](this[0],f)}})(i[t])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(i){for(var t=0;t<i.length;t++)(function(u){c[u]=function(){var f=[],s=0,v=this,E=Array.prototype.slice.call(arguments),p;if(a(E[E.length-1])){p=E[E.length-1];var g=E.slice(0,E.length-1);return setTimeout(function(){p.call(v,c[u].apply(v,g))}),this}else{p=void 0;var h=function(m){return e[u].apply(v,[m].concat(E))}}if(this.length>1){for(v=v.transpose();s<v.length;s++)f[s]=h(v[s]);return f}return h(this[0])}})(i[t])}("quantiles percentileOfScore".split(" "))}(r,Math),function(e,n){e.gammaln=function(o){var l=0,c=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015,t,u,f;for(f=(u=t=o)+5.5,f-=(t+.5)*n.log(f);l<6;l++)i+=c[l]/++u;return n.log(2.5066282746310007*i/t)-f},e.loggam=function(o){var l,c,i,t,u,f,s,v=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(l=o,s=0,o==1||o==2)return 0;for(o<=7&&(s=n.floor(7-o),l=o+s),c=1/(l*l),i=2*n.PI,u=v[9],f=8;f>=0;f--)u*=c,u+=v[f];if(t=u/l+.5*n.log(i)+(l-.5)*n.log(l)-l,o<=7)for(f=1;f<=s;f++)t-=n.log(l-1),l-=1;return t},e.gammafn=function(o){var l=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],i=!1,t=0,u=0,f=0,s=o,v,E,p,g;if(o>171.6243769536076)return 1/0;if(s<=0)if(g=s%1+36e-17,g)i=(s&1?-1:1)*n.PI/n.sin(n.PI*g),s=1-s;else return 1/0;for(p=s,s<1?E=s++:E=(s-=t=(s|0)-1)-1,v=0;v<8;++v)f=(f+l[v])*E,u=u*E+c[v];if(g=f/u+1,p<s)g/=p;else if(p>s)for(v=0;v<t;++v)g*=s,s++;return i&&(g=i/g),g},e.gammap=function(o,l){return e.lowRegGamma(o,l)*e.gammafn(o)},e.lowRegGamma=function(o,l){var c=e.gammaln(o),i=o,t=1/o,u=t,f=l+1-o,s=1/1e-30,v=1/f,E=v,p=1,g=-~(n.log(o>=1?o:1/o)*8.5+o*.4+17),h;if(l<0||o<=0)return NaN;if(l<o+1){for(;p<=g;p++)t+=u*=l/++i;return t*n.exp(-l+o*n.log(l)-c)}for(;p<=g;p++)h=-p*(p-o),f+=2,v=h*v+f,s=f+h/s,v=1/v,E*=v*s;return 1-E*n.exp(-l+o*n.log(l)-c)},e.factorialln=function(o){return o<0?NaN:e.gammaln(o+1)},e.factorial=function(o){return o<0?NaN:e.gammafn(o+1)},e.combination=function(o,l){return o>170||l>170?n.exp(e.combinationln(o,l)):e.factorial(o)/e.factorial(l)/e.factorial(o-l)},e.combinationln=function(o,l){return e.factorialln(o)-e.factorialln(l)-e.factorialln(o-l)},e.permutation=function(o,l){return e.factorial(o)/e.factorial(o-l)},e.betafn=function(o,l){if(!(o<=0||l<=0))return o+l>170?n.exp(e.betaln(o,l)):e.gammafn(o)*e.gammafn(l)/e.gammafn(o+l)},e.betaln=function(o,l){return e.gammaln(o)+e.gammaln(l)-e.gammaln(o+l)},e.betacf=function(o,l,c){var i=1e-30,t=1,u=l+c,f=l+1,s=l-1,v=1,E=1-u*o/f,p,g,h,N;for(n.abs(E)<i&&(E=i),E=1/E,N=E;t<=100&&(p=2*t,g=t*(c-t)*o/((s+p)*(l+p)),E=1+g*E,n.abs(E)<i&&(E=i),v=1+g/v,n.abs(v)<i&&(v=i),E=1/E,N*=E*v,g=-(l+t)*(u+t)*o/((l+p)*(f+p)),E=1+g*E,n.abs(E)<i&&(E=i),v=1+g/v,n.abs(v)<i&&(v=i),E=1/E,h=E*v,N*=h,!(n.abs(h-1)<3e-7));t++);return N},e.gammapinv=function(o,l){var c=0,i=l-1,t=1e-8,u=e.gammaln(l),f,s,v,E,p,g,h;if(o>=1)return n.max(100,l+100*n.sqrt(l));if(o<=0)return 0;for(l>1?(g=n.log(i),h=n.exp(i*(g-1)-u),p=o<.5?o:1-o,v=n.sqrt(-2*n.log(p)),f=(2.30753+v*.27061)/(1+v*(.99229+v*.04481))-v,o<.5&&(f=-f),f=n.max(.001,l*n.pow(1-1/(9*l)-f/(3*n.sqrt(l)),3))):(v=1-l*(.253+l*.12),o<v?f=n.pow(o/v,1/l):f=1-n.log(1-(o-v)/(1-v)));c<12;c++){if(f<=0)return 0;if(s=e.lowRegGamma(l,f)-o,l>1?v=h*n.exp(-(f-i)+i*(n.log(f)-g)):v=n.exp(-f+i*n.log(f)-u),E=s/v,f-=v=E/(1-.5*n.min(1,E*((l-1)/f-1))),f<=0&&(f=.5*(f+v)),n.abs(v)<t*f)break}return f},e.erf=function(o){var l=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],c=l.length-1,i=!1,t=0,u=0,f,s,v,E;for(o<0&&(o=-o,i=!0),f=2/(2+o),s=4*f-2;c>0;c--)v=t,t=s*t-u+l[c],u=v;return E=f*n.exp(-o*o+.5*(l[0]+s*t)-u),i?E-1:1-E},e.erfc=function(o){return 1-e.erf(o)},e.erfcinv=function(o){var l=0,c,i,t,u;if(o>=2)return-100;if(o<=0)return 100;for(u=o<1?o:2-o,t=n.sqrt(-2*n.log(u/2)),c=-.70711*((2.30753+t*.27061)/(1+t*(.99229+t*.04481))-t);l<2;l++)i=e.erfc(c)-u,c+=i/(1.1283791670955126*n.exp(-c*c)-c*i);return o<1?c:-c},e.ibetainv=function(o,l,c){var i=1e-8,t=l-1,u=c-1,f=0,s,v,E,p,g,h,N,m,A,R,y;if(o<=0)return 0;if(o>=1)return 1;for(l>=1&&c>=1?(E=o<.5?o:1-o,p=n.sqrt(-2*n.log(E)),N=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,o<.5&&(N=-N),m=(N*N-3)/6,A=2/(1/(2*l-1)+1/(2*c-1)),R=N*n.sqrt(m+A)/A-(1/(2*c-1)-1/(2*l-1))*(m+5/6-2/(3*A)),N=l/(l+c*n.exp(2*R))):(s=n.log(l/(l+c)),v=n.log(c/(l+c)),p=n.exp(l*s)/l,g=n.exp(c*v)/c,R=p+g,o<p/R?N=n.pow(l*R*o,1/l):N=1-n.pow(c*R*(1-o),1/c)),y=-e.gammaln(l)-e.gammaln(c)+e.gammaln(l+c);f<10;f++){if(N===0||N===1)return N;if(h=e.ibeta(N,l,c)-o,p=n.exp(t*n.log(N)+u*n.log(1-N)+y),g=h/p,N-=p=g/(1-.5*n.min(1,g*(t/N-u/(1-N)))),N<=0&&(N=.5*(N+p)),N>=1&&(N=.5*(N+p+1)),n.abs(p)<i*N&&f>0)break}return N},e.ibeta=function(o,l,c){var i=o===0||o===1?0:n.exp(e.gammaln(l+c)-e.gammaln(l)-e.gammaln(c)+l*n.log(o)+c*n.log(1-o));return o<0||o>1?!1:o<(l+1)/(l+c+2)?i*e.betacf(o,l,c)/l:1-i*e.betacf(1-o,c,l)/c},e.randn=function(o,l){var c,i,t,u,f;if(l||(l=o),o)return e.create(o,l,function(){return e.randn()});do c=e._random_fn(),i=1.7156*(e._random_fn()-.5),t=c-.449871,u=n.abs(i)+.386595,f=t*t+u*(.196*u-.25472*t);while(f>.27597&&(f>.27846||i*i>-4*n.log(c)*c*c));return i/c},e.randg=function(o,l,c){var i=o,t,u,f,s,v,E;if(c||(c=l),o||(o=1),l)return E=e.zeros(l,c),E.alter(function(){return e.randg(o)}),E;o<1&&(o+=1),t=o-1/3,u=1/n.sqrt(9*t);do{do v=e.randn(),s=1+u*v;while(s<=0);s=s*s*s,f=e._random_fn()}while(f>1-.331*n.pow(v,4)&&n.log(f)>.5*v*v+t*(1-s+n.log(s)));if(o==i)return t*s;do f=e._random_fn();while(f===0);return n.pow(f,1/i)*t*s},function(a){for(var o=0;o<a.length;o++)(function(l){e.fn[l]=function(){return e(e.map(this,function(c){return e[l](c)}))}})(a[o])}("gammaln gammafn factorial factorialln".split(" ")),function(a){for(var o=0;o<a.length;o++)(function(l){e.fn[l]=function(){return e(e[l].apply(null,arguments))}})(a[o])}("randn".split(" "))}(r,Math),function(e,n){(function(i){for(var t=0;t<i.length;t++)(function(u){e[u]=function f(s,v,E){return this instanceof f?(this._a=s,this._b=v,this._c=E,this):new f(s,v,E)},e.fn[u]=function(f,s,v){var E=e[u](f,s,v);return E.data=this,E},e[u].prototype.sample=function(f){var s=this._a,v=this._b,E=this._c;return f?e.alter(f,function(){return e[u].sample(s,v,E)}):e[u].sample(s,v,E)},function(f){for(var s=0;s<f.length;s++)(function(v){e[u].prototype[v]=function(E){var p=this._a,g=this._b,h=this._c;return!E&&E!==0&&(E=this.data),typeof E!="number"?e.fn.map.call(E,function(N){return e[u][v](N,p,g,h)}):e[u][v](E,p,g,h)}})(f[s])}("pdf cdf inv".split(" ")),function(f){for(var s=0;s<f.length;s++)(function(v){e[u].prototype[v]=function(){return e[u][v](this._a,this._b,this._c)}})(f[s])}("mean median mode variance".split(" "))})(i[t])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(t,u,f){return t>1||t<0?0:u==1&&f==1?1:u<512&&f<512?n.pow(t,u-1)*n.pow(1-t,f-1)/e.betafn(u,f):n.exp((u-1)*n.log(t)+(f-1)*n.log(1-t)-e.betaln(u,f))},cdf:function(t,u,f){return t>1||t<0?(t>1)*1:e.ibeta(t,u,f)},inv:function(t,u,f){return e.ibetainv(t,u,f)},mean:function(t,u){return t/(t+u)},median:function(t,u){return e.ibetainv(.5,t,u)},mode:function(t,u){return(t-1)/(t+u-2)},sample:function(t,u){var f=e.randg(t);return f/(f+e.randg(u))},variance:function(t,u){return t*u/(n.pow(t+u,2)*(t+u+1))}}),e.extend(e.centralF,{pdf:function(t,u,f){var s,v,E;return t<0?0:u<=2?t===0&&u<2?1/0:t===0&&u===2?1:1/e.betafn(u/2,f/2)*n.pow(u/f,u/2)*n.pow(t,u/2-1)*n.pow(1+u/f*t,-(u+f)/2):(s=u*t/(f+t*u),v=f/(f+t*u),E=u*v/2,E*e.binomial.pdf((u-2)/2,(u+f-2)/2,s))},cdf:function(t,u,f){return t<0?0:e.ibeta(u*t/(u*t+f),u/2,f/2)},inv:function(t,u,f){return f/(u*(1/e.ibetainv(t,u/2,f/2)-1))},mean:function(t,u){return u>2?u/(u-2):void 0},mode:function(t,u){return t>2?u*(t-2)/(t*(u+2)):void 0},sample:function(t,u){var f=e.randg(t/2)*2,s=e.randg(u/2)*2;return f/t/(s/u)},variance:function(t,u){if(!(u<=4))return 2*u*u*(t+u-2)/(t*(u-2)*(u-2)*(u-4))}}),e.extend(e.cauchy,{pdf:function(t,u,f){return f<0?0:f/(n.pow(t-u,2)+n.pow(f,2))/n.PI},cdf:function(t,u,f){return n.atan((t-u)/f)/n.PI+.5},inv:function(i,t,u){return t+u*n.tan(n.PI*(i-.5))},median:function(t){return t},mode:function(t){return t},sample:function(t,u){return e.randn()*n.sqrt(1/(2*e.randg(.5)))*u+t}}),e.extend(e.chisquare,{pdf:function(t,u){return t<0?0:t===0&&u===2?.5:n.exp((u/2-1)*n.log(t)-t/2-u/2*n.log(2)-e.gammaln(u/2))},cdf:function(t,u){return t<0?0:e.lowRegGamma(u/2,t/2)},inv:function(i,t){return 2*e.gammapinv(i,.5*t)},mean:function(i){return i},median:function(t){return t*n.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(t){return e.randg(t/2)*2},variance:function(t){return 2*t}}),e.extend(e.exponential,{pdf:function(t,u){return t<0?0:u*n.exp(-u*t)},cdf:function(t,u){return t<0?0:1-n.exp(-u*t)},inv:function(i,t){return-n.log(1-i)/t},mean:function(i){return 1/i},median:function(i){return 1/i*n.log(2)},mode:function(){return 0},sample:function(t){return-1/t*n.log(e._random_fn())},variance:function(i){return n.pow(i,-2)}}),e.extend(e.gamma,{pdf:function(t,u,f){return t<0?0:t===0&&u===1?1/f:n.exp((u-1)*n.log(t)-t/f-e.gammaln(u)-u*n.log(f))},cdf:function(t,u,f){return t<0?0:e.lowRegGamma(u,t/f)},inv:function(i,t,u){return e.gammapinv(i,t)*u},mean:function(i,t){return i*t},mode:function(t,u){if(t>1)return(t-1)*u},sample:function(t,u){return e.randg(t)*u},variance:function(t,u){return t*u*u}}),e.extend(e.invgamma,{pdf:function(t,u,f){return t<=0?0:n.exp(-(u+1)*n.log(t)-f/t-e.gammaln(u)+u*n.log(f))},cdf:function(t,u,f){return t<=0?0:1-e.lowRegGamma(u,f/t)},inv:function(i,t,u){return u/e.gammapinv(1-i,t)},mean:function(i,t){return i>1?t/(i-1):void 0},mode:function(t,u){return u/(t+1)},sample:function(t,u){return u/e.randg(t)},variance:function(t,u){if(!(t<=2))return u*u/((t-1)*(t-1)*(t-2))}}),e.extend(e.kumaraswamy,{pdf:function(t,u,f){return t===0&&u===1?f:t===1&&f===1?u:n.exp(n.log(u)+n.log(f)+(u-1)*n.log(t)+(f-1)*n.log(1-n.pow(t,u)))},cdf:function(t,u,f){return t<0?0:t>1?1:1-n.pow(1-n.pow(t,u),f)},inv:function(t,u,f){return n.pow(1-n.pow(1-t,1/f),1/u)},mean:function(i,t){return t*e.gammafn(1+1/i)*e.gammafn(t)/e.gammafn(1+1/i+t)},median:function(t,u){return n.pow(1-n.pow(2,-1/u),1/t)},mode:function(t,u){if(t>=1&&u>=1&&t!==1&&u!==1)return n.pow((t-1)/(t*u-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(t,u,f){return t<=0?0:n.exp(-n.log(t)-.5*n.log(2*n.PI)-n.log(f)-n.pow(n.log(t)-u,2)/(2*f*f))},cdf:function(t,u,f){return t<0?0:.5+.5*e.erf((n.log(t)-u)/n.sqrt(2*f*f))},inv:function(i,t,u){return n.exp(-1.4142135623730951*u*e.erfcinv(2*i)+t)},mean:function(t,u){return n.exp(t+u*u/2)},median:function(t){return n.exp(t)},mode:function(t,u){return n.exp(t-u*u)},sample:function(t,u){return n.exp(e.randn()*u+t)},variance:function(t,u){return(n.exp(u*u)-1)*n.exp(2*t+u*u)}}),e.extend(e.noncentralt,{pdf:function(t,u,f){var s=1e-14;return n.abs(f)<s?e.studentt.pdf(t,u):n.abs(t)<s?n.exp(e.gammaln((u+1)/2)-f*f/2-.5*n.log(n.PI*u)-e.gammaln(u/2)):u/t*(e.noncentralt.cdf(t*n.sqrt(1+2/u),u+2,f)-e.noncentralt.cdf(t,u,f))},cdf:function(t,u,f){var s=1e-14,v=200;if(n.abs(f)<s)return e.studentt.cdf(t,u);var E=!1;t<0&&(E=!0,f=-f);for(var p=e.normal.cdf(-f,0,1),g=s+1,h=g,N=t*t/(t*t+u),m=0,A=n.exp(-f*f/2),R=n.exp(-f*f/2-.5*n.log(2)-e.gammaln(3/2))*f;m<v||h>s||g>s;)h=g,m>0&&(A*=f*f/(2*m),R*=f*f/(2*(m+1/2))),g=A*e.beta.cdf(N,m+.5,u/2)+R*e.beta.cdf(N,m+1,u/2),p+=.5*g,m++;return E?1-p:p}}),e.extend(e.normal,{pdf:function(t,u,f){return n.exp(-.5*n.log(2*n.PI)-n.log(f)-n.pow(t-u,2)/(2*f*f))},cdf:function(t,u,f){return .5*(1+e.erf((t-u)/n.sqrt(2*f*f)))},inv:function(i,t,u){return-1.4142135623730951*u*e.erfcinv(2*i)+t},mean:function(i){return i},median:function(t){return t},mode:function(i){return i},sample:function(t,u){return e.randn()*u+t},variance:function(i,t){return t*t}}),e.extend(e.pareto,{pdf:function(t,u,f){return t<u?0:f*n.pow(u,f)/n.pow(t,f+1)},cdf:function(t,u,f){return t<u?0:1-n.pow(u/t,f)},inv:function(t,u,f){return u/n.pow(1-t,1/f)},mean:function(t,u){if(!(u<=1))return u*n.pow(t,u)/(u-1)},median:function(t,u){return t*(u*n.SQRT2)},mode:function(t){return t},variance:function(i,t){if(!(t<=2))return i*i*t/(n.pow(t-1,2)*(t-2))}}),e.extend(e.studentt,{pdf:function(t,u){return u=u>1e100?1e100:u,1/(n.sqrt(u)*e.betafn(.5,u/2))*n.pow(1+t*t/u,-((u+1)/2))},cdf:function(t,u){var f=u/2;return e.ibeta((t+n.sqrt(t*t+u))/(2*n.sqrt(t*t+u)),f,f)},inv:function(i,t){var u=e.ibetainv(2*n.min(i,1-i),.5*t,.5);return u=n.sqrt(t*(1-u)/u),i>.5?u:-u},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return e.randn()*n.sqrt(t/(2*e.randg(t/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(t,u,f){return t<0||u<0||f<0?0:f/u*n.pow(t/u,f-1)*n.exp(-n.pow(t/u,f))},cdf:function(t,u,f){return t<0?0:1-n.exp(-n.pow(t/u,f))},inv:function(i,t,u){return t*n.pow(-n.log(1-i),1/u)},mean:function(i,t){return i*e.gammafn(1+1/t)},median:function(t,u){return t*n.pow(n.log(2),1/u)},mode:function(t,u){return u<=1?0:t*n.pow((u-1)/u,1/u)},sample:function(t,u){return t*n.pow(-n.log(e._random_fn()),1/u)},variance:function(t,u){return t*t*e.gammafn(1+2/u)-n.pow(e.weibull.mean(t,u),2)}}),e.extend(e.uniform,{pdf:function(t,u,f){return t<u||t>f?0:1/(f-u)},cdf:function(t,u,f){return t<u?0:t<f?(t-u)/(f-u):1},inv:function(i,t,u){return t+i*(u-t)},mean:function(t,u){return .5*(t+u)},median:function(t,u){return e.mean(t,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,u){return t/2+u/2+(u/2-t/2)*(2*e._random_fn()-1)},variance:function(t,u){return n.pow(u-t,2)/12}});function a(i,t,u,f){for(var s=0,v=1,E=1,p=1,g=0,h=0,N;n.abs((E-h)/E)>f;)h=E,N=-(t+g)*(t+u+g)*i/(t+2*g)/(t+2*g+1),s=E+N*s,v=p+N*v,g=g+1,N=g*(u-g)*i/(t+2*g-1)/(t+2*g),E=s+N*E,p=v+N*p,s=s/p,v=v/p,E=E/p,p=1;return E/t}e.extend(e.binomial,{pdf:function(t,u,f){return f===0||f===1?u*f===t?1:0:e.combination(u,t)*n.pow(f,t)*n.pow(1-f,u-t)},cdf:function(t,u,f){var s,v=1e-10;if(t<0)return 0;if(t>=u)return 1;if(f<0||f>1||u<=0)return NaN;t=n.floor(t);var E=f,p=t+1,g=u-t,h=p+g,N=n.exp(e.gammaln(h)-e.gammaln(g)-e.gammaln(p)+p*n.log(E)+g*n.log(1-E));return E<(p+1)/(h+2)?s=N*a(E,p,g,v):s=1-N*a(1-E,g,p,v),n.round((1-s)*(1/v))/(1/v)}}),e.extend(e.negbin,{pdf:function(t,u,f){return t!==t>>>0?!1:t<0?0:e.combination(t+u-1,u-1)*n.pow(1-f,t)*n.pow(f,u)},cdf:function(t,u,f){var s=0,v=0;if(t<0)return 0;for(;v<=t;v++)s+=e.negbin.pdf(v,u,f);return s}}),e.extend(e.hypgeom,{pdf:function(t,u,f,s){if(t!==t|0)return!1;if(t<0||t<f-(u-s))return 0;if(t>s||t>f)return 0;if(f*2>u)return s*2>u?e.hypgeom.pdf(u-f-s+t,u,u-f,u-s):e.hypgeom.pdf(s-t,u,u-f,s);if(s*2>u)return e.hypgeom.pdf(f-t,u,f,u-s);if(f<s)return e.hypgeom.pdf(t,u,s,f);for(var v=1,E=0,p=0;p<t;p++){for(;v>1&&E<s;)v*=1-f/(u-E),E++;v*=(s-p)*(f-p)/((p+1)*(u-f-s+p+1))}for(;E<s;E++)v*=1-f/(u-E);return n.min(1,n.max(0,v))},cdf:function(t,u,f,s){if(t<0||t<f-(u-s))return 0;if(t>=s||t>=f)return 1;if(f*2>u)return s*2>u?e.hypgeom.cdf(u-f-s+t,u,u-f,u-s):1-e.hypgeom.cdf(s-t-1,u,u-f,s);if(s*2>u)return 1-e.hypgeom.cdf(f-t-1,u,f,u-s);if(f<s)return e.hypgeom.cdf(t,u,s,f);for(var v=1,E=1,p=0,g=0;g<t;g++){for(;v>1&&p<s;){var h=1-f/(u-p);E*=h,v*=h,p++}E*=(s-g)*(f-g)/((g+1)*(u-f-s+g+1)),v+=E}for(;p<s;p++)v*=1-f/(u-p);return n.min(1,n.max(0,v))}}),e.extend(e.poisson,{pdf:function(t,u){return u<0||t%1!==0||t<0?0:n.pow(u,t)*n.exp(-u)/e.factorial(t)},cdf:function(t,u){var f=[],s=0;if(t<0)return 0;for(;s<=t;s++)f.push(e.poisson.pdf(s,u));return e.sum(f)},mean:function(i){return i},variance:function(i){return i},sampleSmall:function(t){var u=1,f=0,s=n.exp(-t);do f++,u*=e._random_fn();while(u>s);return f-1},sampleLarge:function(t){var u=t,f,s,v,E,p,g,h,N,m,A;for(E=n.sqrt(u),p=n.log(u),h=.931+2.53*E,g=-.059+.02483*h,N=1.1239+1.1328/(h-3.4),m=.9277-3.6224/(h-2);;){if(s=n.random()-.5,v=n.random(),A=.5-n.abs(s),f=n.floor((2*g/A+h)*s+u+.43),A>=.07&&v<=m)return f;if(!(f<0||A<.013&&v>A)&&n.log(v)+n.log(N)-n.log(g/(A*A)+h)<=-u+f*p-e.loggam(f+1))return f}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),e.extend(e.triangular,{pdf:function(t,u,f,s){return f<=u||s<u||s>f?NaN:t<u||t>f?0:t<s?2*(t-u)/((f-u)*(s-u)):t===s?2/(f-u):2*(f-t)/((f-u)*(f-s))},cdf:function(t,u,f,s){return f<=u||s<u||s>f?NaN:t<=u?0:t>=f?1:t<=s?n.pow(t-u,2)/((f-u)*(s-u)):1-n.pow(f-t,2)/((f-u)*(f-s))},inv:function(t,u,f,s){return f<=u||s<u||s>f?NaN:t<=(s-u)/(f-u)?u+(f-u)*n.sqrt(t*((s-u)/(f-u))):u+(f-u)*(1-n.sqrt((1-t)*(1-(s-u)/(f-u))))},mean:function(t,u,f){return(t+u+f)/3},median:function(t,u,f){if(f<=(t+u)/2)return u-n.sqrt((u-t)*(u-f))/n.sqrt(2);if(f>(t+u)/2)return t+n.sqrt((u-t)*(f-t))/n.sqrt(2)},mode:function(t,u,f){return f},sample:function(t,u,f){var s=e._random_fn();return s<(f-t)/(u-t)?t+n.sqrt(s*(u-t)*(f-t)):u-n.sqrt((1-s)*(u-t)*(u-f))},variance:function(t,u,f){return(t*t+u*u+f*f-t*u-t*f-u*f)/18}}),e.extend(e.arcsine,{pdf:function(t,u,f){return f<=u?NaN:t<=u||t>=f?0:2/n.PI*n.pow(n.pow(f-u,2)-n.pow(2*t-u-f,2),-.5)},cdf:function(t,u,f){return t<u?0:t<f?2/n.PI*n.asin(n.sqrt((t-u)/(f-u))):1},inv:function(i,t,u){return t+(.5-.5*n.cos(n.PI*i))*(u-t)},mean:function(t,u){return u<=t?NaN:(t+u)/2},median:function(t,u){return u<=t?NaN:(t+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,u){return(t+u)/2+(u-t)/2*n.sin(2*n.PI*e.uniform.sample(0,1))},variance:function(t,u){return u<=t?NaN:n.pow(u-t,2)/8}});function o(i){return i/n.abs(i)}e.extend(e.laplace,{pdf:function(t,u,f){return f<=0?0:n.exp(-n.abs(t-u)/f)/(2*f)},cdf:function(t,u,f){return f<=0?0:t<u?.5*n.exp((t-u)/f):1-.5*n.exp(-(t-u)/f)},mean:function(i){return i},median:function(i){return i},mode:function(i){return i},variance:function(i,t){return 2*t*t},sample:function(t,u){var f=e._random_fn()-.5;return t-u*o(f)*n.log(1-2*n.abs(f))}});function l(i,t,u){var f=12,s=6,v=-30,E=-50,p=60,g=8,h=3,N=2,m=3,A=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],R=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],y=i*.5;if(y>=g)return 1;var C=2*e.normal.cdf(y,0,1,1,0)-1;C>=n.exp(E/u)?C=n.pow(C,u):C=0;var V;i>h?V=N:V=m;for(var P=y,Y=(g-y)/V,Ir=P+Y,z=0,W=u-1,Ar=1;Ar<=V;Ar++){for(var pr=0,j=.5*(Ir+P),Pr=.5*(Ir-P),Dr=1;Dr<=f;Dr++){var Rr,Tr;s<Dr?(Rr=f-Dr+1,Tr=A[Rr-1]):(Rr=Dr,Tr=-A[Rr-1]);var Lr=Pr*Tr,$=j+Lr,Sr=$*$;if(Sr>p)break;var Zr=2*e.normal.cdf($,0,1,1,0),rn=2*e.normal.cdf($,i,1,1,0),te=Zr*.5-rn*.5;te>=n.exp(v/W)&&(te=R[Rr-1]*n.exp(-(.5*Sr))*n.pow(te,W),pr+=te)}pr*=2*Pr*u/n.sqrt(2*n.PI),z+=pr,P=Ir,Ir+=Y}return C+=z,C<=n.exp(v/t)?0:(C=n.pow(C,t),C>=1?1:C)}function c(i,t,u){var f=.322232421088,s=.099348462606,v=-1,E=.588581570495,p=-.342242088547,g=.531103462366,h=-.204231210125,N=.10353775285,m=-453642210148e-16,A=.0038560700634,R=.8832,y=.2368,C=1.214,V=1.208,P=1.4142,Y=120,Ir=.5-.5*i,z=n.sqrt(n.log(1/(Ir*Ir))),W=z+((((z*m+h)*z+p)*z+v)*z+f)/((((z*A+N)*z+g)*z+E)*z+s);u<Y&&(W+=(W*W*W+W)/u/4);var Ar=R-y*W;return u<Y&&(Ar+=-C/u+V*W/u),W*(Ar*n.log(t-1)+P)}e.extend(e.tukey,{cdf:function(t,u,f){var s=1,v=u,E=16,p=8,g=-30,h=1e-14,N=100,m=800,A=5e3,R=25e3,y=1,C=.5,V=.25,P=.125,Y=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],Ir=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(f<2||s<1||v<2)return NaN;if(!Number.isFinite(t))return 1;if(f>R)return l(t,s,v);var z=f*.5,W=z*n.log(f)-f*n.log(2)-e.gammaln(z),Ar=z-1,pr=f*.25,j;f<=N?j=y:f<=m?j=C:f<=A?j=V:j=P,W+=n.log(j);for(var Pr=0,Dr=1;Dr<=50;Dr++){for(var Rr=0,Tr=(2*Dr-1)*j,Lr=1;Lr<=E;Lr++){var $,Sr;p<Lr?($=Lr-p-1,Sr=W+Ar*n.log(Tr+Y[$]*j)-(Y[$]*j+Tr)*pr):($=Lr-1,Sr=W+Ar*n.log(Tr-Y[$]*j)+(Y[$]*j-Tr)*pr);var Zr;if(Sr>=g){p<Lr?Zr=t*n.sqrt((Y[$]*j+Tr)*.5):Zr=t*n.sqrt((-(Y[$]*j)+Tr)*.5);var rn=l(Zr,s,v),te=rn*Ir[$]*n.exp(Sr);Rr+=te}}if(Dr*j>=1&&Rr<=h)break;Pr+=Rr}if(Rr>h)throw new Error("tukey.cdf failed to converge");return Pr>1&&(Pr=1),Pr},inv:function(i,t,u){var f=1,s=t,v=1e-4,E=50;if(u<2||f<1||s<2)return NaN;if(i<0||i>1)return NaN;if(i===0)return 0;if(i===1)return 1/0;var p=c(i,s,u),g=e.tukey.cdf(p,t,u)-i,h;g>0?h=n.max(0,p-1):h=p+1;for(var N=e.tukey.cdf(h,t,u)-i,m,A=1;A<E;A++){m=h-N*(h-p)/(N-g),g=N,p=h,m<0&&(m=0,N=-i),N=e.tukey.cdf(m,t,u)-i,h=m;var R=n.abs(h-p);if(R<v)return m}throw new Error("tukey.inv failed to converge")}})}(r,Math),function(e,n){var a=Array.prototype.push,o=e.utils.isArray;function l(c){return o(c)||c instanceof e}e.extend({add:function(i,t){return l(t)?(l(t[0])||(t=[t]),e.map(i,function(u,f,s){return u+t[f][s]})):e.map(i,function(u){return u+t})},subtract:function(i,t){return l(t)?(l(t[0])||(t=[t]),e.map(i,function(u,f,s){return u-t[f][s]||0})):e.map(i,function(u){return u-t})},divide:function(i,t){return l(t)?(l(t[0])||(t=[t]),e.multiply(i,e.inv(t))):e.map(i,function(u){return u/t})},multiply:function(i,t){var u,f,s,v,E,p,g,h;if(i.length===void 0&&t.length===void 0)return i*t;if(E=i.length,p=i[0].length,g=e.zeros(E,s=l(t)?t[0].length:p),h=0,l(t)){for(;h<s;h++)for(u=0;u<E;u++){for(v=0,f=0;f<p;f++)v+=i[u][f]*t[f][h];g[u][h]=v}return E===1&&h===1?g[0][0]:g}return e.map(i,function(N){return N*t})},outer:function(i,t){return e.multiply(i.map(function(u){return[u]}),[t])},dot:function(i,t){l(i[0])||(i=[i]),l(t[0])||(t=[t]);for(var u=i[0].length===1&&i.length!==1?e.transpose(i):i,f=t[0].length===1&&t.length!==1?e.transpose(t):t,s=[],v=0,E=u.length,p=u[0].length,g,h;v<E;v++){for(s[v]=[],g=0,h=0;h<p;h++)g+=u[v][h]*f[v][h];s[v]=g}return s.length===1?s[0]:s},pow:function(i,t){return e.map(i,function(u){return n.pow(u,t)})},exp:function(i){return e.map(i,function(t){return n.exp(t)})},log:function(i){return e.map(i,function(t){return n.log(t)})},abs:function(i){return e.map(i,function(t){return n.abs(t)})},norm:function(i,t){var u=0,f=0;for(isNaN(t)&&(t=2),l(i[0])&&(i=i[0]);f<i.length;f++)u+=n.pow(n.abs(i[f]),t);return n.pow(u,1/t)},angle:function(i,t){return n.acos(e.dot(i,t)/(e.norm(i)*e.norm(t)))},aug:function(i,t){var u=[],f;for(f=0;f<i.length;f++)u.push(i[f].slice());for(f=0;f<u.length;f++)a.apply(u[f],t[f]);return u},inv:function(i){for(var t=i.length,u=i[0].length,f=e.identity(t,u),s=e.gauss_jordan(i,f),v=[],E=0,p;E<t;E++)for(v[E]=[],p=u;p<s[0].length;p++)v[E][p-u]=s[E][p];return v},det:function(i){var t=i.length,u=t*2,f=new Array(u),s=t-1,v=u-1,E=s-t+1,p=v,g=0,h=0,N;if(t===2)return i[0][0]*i[1][1]-i[0][1]*i[1][0];for(;g<u;g++)f[g]=1;for(g=0;g<t;g++){for(N=0;N<t;N++)f[E<0?E+t:E]*=i[g][N],f[p<t?p+t:p]*=i[g][N],E++,p--;E=--s-t+1,p=--v}for(g=0;g<t;g++)h+=f[g];for(;g<u;g++)h-=f[g];return h},gauss_elimination:function(i,t){var u=0,f=0,s=i.length,v=i[0].length,E=1,p=0,g=[],h,N,m,A;for(i=e.aug(i,t),h=i[0].length,u=0;u<s;u++){for(N=i[u][u],f=u,A=u+1;A<v;A++)N<n.abs(i[A][u])&&(N=i[A][u],f=A);if(f!=u)for(A=0;A<h;A++)m=i[u][A],i[u][A]=i[f][A],i[f][A]=m;for(f=u+1;f<s;f++)for(E=i[f][u]/i[u][u],A=u;A<h;A++)i[f][A]=i[f][A]-E*i[u][A]}for(u=s-1;u>=0;u--){for(p=0,f=u+1;f<=s-1;f++)p=p+g[f]*i[u][f];g[u]=(i[u][h-1]-p)/i[u][u]}return g},gauss_jordan:function(i,t){var u=e.aug(i,t),f=u.length,s=u[0].length,v=0,E,p,g;for(p=0;p<f;p++){var h=p;for(g=p+1;g<f;g++)n.abs(u[g][p])>n.abs(u[h][p])&&(h=g);var N=u[p];for(u[p]=u[h],u[h]=N,g=p+1;g<f;g++)for(v=u[g][p]/u[p][p],E=p;E<s;E++)u[g][E]-=u[p][E]*v}for(p=f-1;p>=0;p--){for(v=u[p][p],g=0;g<p;g++)for(E=s-1;E>p-1;E--)u[g][E]-=u[p][E]*u[g][p]/v;for(u[p][p]/=v,E=f;E<s;E++)u[p][E]/=v}return u},triaUpSolve:function(i,t){var u=i[0].length,f=e.zeros(1,u)[0],s,v=!1;return t[0].length!=null&&(t=t.map(function(E){return E[0]}),v=!0),e.arange(u-1,-1,-1).forEach(function(E){s=e.arange(E+1,u).map(function(p){return f[p]*i[E][p]}),f[E]=(t[E]-e.sum(s))/i[E][E]}),v?f.map(function(E){return[E]}):f},triaLowSolve:function(i,t){var u=i[0].length,f=e.zeros(1,u)[0],s,v=!1;return t[0].length!=null&&(t=t.map(function(E){return E[0]}),v=!0),e.arange(u).forEach(function(E){s=e.arange(E).map(function(p){return i[E][p]*f[p]}),f[E]=(t[E]-e.sum(s))/i[E][E]}),v?f.map(function(E){return[E]}):f},lu:function(i){var t=i.length,u=e.identity(t),f=e.zeros(i.length,i[0].length),s;return e.arange(t).forEach(function(v){f[0][v]=i[0][v]}),e.arange(1,t).forEach(function(v){e.arange(v).forEach(function(E){s=e.arange(E).map(function(p){return u[v][p]*f[p][E]}),u[v][E]=(i[v][E]-e.sum(s))/f[E][E]}),e.arange(v,t).forEach(function(E){s=e.arange(v).map(function(p){return u[v][p]*f[p][E]}),f[v][E]=i[s.length][E]-e.sum(s)})}),[u,f]},cholesky:function(i){var t=i.length,u=e.zeros(i.length,i[0].length),f;return e.arange(t).forEach(function(s){f=e.arange(s).map(function(v){return n.pow(u[s][v],2)}),u[s][s]=n.sqrt(i[s][s]-e.sum(f)),e.arange(s+1,t).forEach(function(v){f=e.arange(s).map(function(E){return u[s][E]*u[v][E]}),u[v][s]=(i[s][v]-e.sum(f))/u[s][s]})}),u},gauss_jacobi:function(i,t,u,f){for(var s=0,v=0,E=i.length,p=[],g=[],h=[],N,m,A,R;s<E;s++)for(p[s]=[],g[s]=[],h[s]=[],v=0;v<E;v++)s>v?(p[s][v]=i[s][v],g[s][v]=h[s][v]=0):s<v?(g[s][v]=i[s][v],p[s][v]=h[s][v]=0):(h[s][v]=i[s][v],p[s][v]=g[s][v]=0);for(A=e.multiply(e.multiply(e.inv(h),e.add(p,g)),-1),m=e.multiply(e.inv(h),t),N=u,R=e.add(e.multiply(A,u),m),s=2;n.abs(e.norm(e.subtract(R,N)))>f;)N=R,R=e.add(e.multiply(A,N),m),s++;return R},gauss_seidel:function(i,t,u,f){for(var s=0,v=i.length,E=[],p=[],g=[],h,N,m,A,R;s<v;s++)for(E[s]=[],p[s]=[],g[s]=[],h=0;h<v;h++)s>h?(E[s][h]=i[s][h],p[s][h]=g[s][h]=0):s<h?(p[s][h]=i[s][h],E[s][h]=g[s][h]=0):(g[s][h]=i[s][h],E[s][h]=p[s][h]=0);for(A=e.multiply(e.multiply(e.inv(e.add(g,E)),p),-1),m=e.multiply(e.inv(e.add(g,E)),t),N=u,R=e.add(e.multiply(A,u),m),s=2;n.abs(e.norm(e.subtract(R,N)))>f;)N=R,R=e.add(e.multiply(A,N),m),s=s+1;return R},SOR:function(i,t,u,f,s){for(var v=0,E=i.length,p=[],g=[],h=[],N,m,A,R,y;v<E;v++)for(p[v]=[],g[v]=[],h[v]=[],N=0;N<E;N++)v>N?(p[v][N]=i[v][N],g[v][N]=h[v][N]=0):v<N?(g[v][N]=i[v][N],p[v][N]=h[v][N]=0):(h[v][N]=i[v][N],p[v][N]=g[v][N]=0);for(R=e.multiply(e.inv(e.add(h,e.multiply(p,s))),e.subtract(e.multiply(h,1-s),e.multiply(g,s))),A=e.multiply(e.multiply(e.inv(e.add(h,e.multiply(p,s))),t),s),m=u,y=e.add(e.multiply(R,u),A),v=2;n.abs(e.norm(e.subtract(y,m)))>f;)m=y,y=e.add(e.multiply(R,m),A),v++;return y},householder:function(i){for(var t=i.length,u=i[0].length,f=0,s=[],v=[],E,p,g,h,N;f<t-1;f++){for(E=0,h=f+1;h<u;h++)E+=i[h][f]*i[h][f];for(N=i[f+1][f]>0?-1:1,E=N*n.sqrt(E),p=n.sqrt((E*E-i[f+1][f]*E)/2),s=e.zeros(t,1),s[f+1][0]=(i[f+1][f]-E)/(2*p),g=f+2;g<t;g++)s[g][0]=i[g][f]/(2*p);v=e.subtract(e.identity(t,u),e.multiply(e.multiply(s,e.transpose(s)),2)),i=e.multiply(v,e.multiply(i,v))}return i},QR:function(){var c=e.sum,i=e.arange;function t(u){var f=u.length,s=u[0].length,v=e.zeros(s,s);u=e.copy(u);var E,p,g;for(p=0;p<s;p++){for(v[p][p]=n.sqrt(c(i(f).map(function(h){return u[h][p]*u[h][p]}))),E=0;E<f;E++)u[E][p]=u[E][p]/v[p][p];for(g=p+1;g<s;g++)for(v[p][g]=c(i(f).map(function(h){return u[h][p]*u[h][g]})),E=0;E<f;E++)u[E][g]=u[E][g]-u[E][p]*v[p][g]}return[u,v]}return t}(),lstsq:function(){function c(t){t=e.copy(t);var u=t.length,f=e.identity(u);return e.arange(u-1,-1,-1).forEach(function(s){e.sliceAssign(f,{row:s},e.divide(e.slice(f,{row:s}),t[s][s])),e.sliceAssign(t,{row:s},e.divide(e.slice(t,{row:s}),t[s][s])),e.arange(s).forEach(function(v){var E=e.multiply(t[v][s],-1),p=e.slice(t,{row:v}),g=e.multiply(e.slice(t,{row:s}),E);e.sliceAssign(t,{row:v},e.add(p,g));var h=e.slice(f,{row:v}),N=e.multiply(e.slice(f,{row:s}),E);e.sliceAssign(f,{row:v},e.add(h,N))})}),f}function i(t,u){var f=!1;u[0].length===void 0&&(u=u.map(function(R){return[R]}),f=!0);var s=e.QR(t),v=s[0],E=s[1],p=t[0].length,g=e.slice(v,{col:{end:p}}),h=e.slice(E,{row:{end:p}}),N=c(h),m=e.transpose(g);m[0].length===void 0&&(m=[m]);var A=e.multiply(e.multiply(N,m),u);return A.length===void 0&&(A=[[A]]),f?A.map(function(R){return R[0]}):A}return i}(),jacobi:function(i){for(var t=1,u=i.length,f=e.identity(u,u),s=[],v,E,p,g,h,N,m,A;t===1;){for(N=i[0][1],g=0,h=1,E=0;E<u;E++)for(p=0;p<u;p++)E!=p&&N<n.abs(i[E][p])&&(N=n.abs(i[E][p]),g=E,h=p);for(i[g][g]===i[h][h]?m=i[g][h]>0?n.PI/4:-n.PI/4:m=n.atan(2*i[g][h]/(i[g][g]-i[h][h]))/2,A=e.identity(u,u),A[g][g]=n.cos(m),A[g][h]=-n.sin(m),A[h][g]=n.sin(m),A[h][h]=n.cos(m),f=e.multiply(f,A),v=e.multiply(e.multiply(e.inv(A),i),A),i=v,t=0,E=1;E<u;E++)for(p=1;p<u;p++)E!=p&&n.abs(i[E][p])>.001&&(t=1)}for(E=0;E<u;E++)s.push(i[E][E]);return[f,s]},rungekutta:function(i,t,u,f,s,v){var E,p,g,h,N;if(v===2)for(;f<=u;)E=t*i(f,s),p=t*i(f+t,s+E),g=s+(E+p)/2,s=g,f=f+t;if(v===4)for(;f<=u;)E=t*i(f,s),p=t*i(f+t/2,s+E/2),h=t*i(f+t/2,s+p/2),N=t*i(f+t,s+h),g=s+(E+2*p+2*h+N)/6,s=g,f=f+t;return s},romberg:function(i,t,u,f){for(var s=0,v=(u-t)/2,E=[],p=[],g=[],h,N,m,A,R;s<f/2;){for(R=i(t),m=t,A=0;m<=u;m=m+v,A++)E[A]=m;for(h=E.length,m=1;m<h-1;m++)R+=(m%2!==0?4:2)*i(E[m]);R=v/3*(R+i(u)),g[s]=R,v/=2,s++}for(N=g.length,h=1;N!==1;){for(m=0;m<N-1;m++)p[m]=(n.pow(4,h)*g[m+1]-g[m])/(n.pow(4,h)-1);N=p.length,g=p,p=[],h++}return g},richardson:function(i,t,u,f){function s(y,C){for(var V=0,P=y.length,Y;V<P;V++)y[V]===C&&(Y=V);return Y}for(var v=n.abs(u-i[s(i,u)+1]),E=0,p=[],g=[],h,N,m,A,R;f>=v;)h=s(i,u+f),N=s(i,u),p[E]=(t[h]-2*t[N]+t[2*N-h])/(f*f),f/=2,E++;for(A=p.length,m=1;A!=1;){for(R=0;R<A-1;R++)g[R]=(n.pow(4,m)*p[R+1]-p[R])/(n.pow(4,m)-1);A=g.length,p=g,g=[],m++}return p},simpson:function(i,t,u,f){for(var s=(u-t)/f,v=i(t),E=[],p=t,g=0,h=1,N;p<=u;p=p+s,g++)E[g]=p;for(N=E.length;h<N-1;h++)v+=(h%2!==0?4:2)*i(E[h]);return s/3*(v+i(u))},hermite:function(i,t,u,f){for(var s=i.length,v=0,E=0,p=[],g=[],h=[],N=[],m;E<s;E++){for(p[E]=1,m=0;m<s;m++)E!=m&&(p[E]*=(f-i[m])/(i[E]-i[m]));for(g[E]=0,m=0;m<s;m++)E!=m&&(g[E]+=1/(i[E]-i[m]));h[E]=(1-2*(f-i[E])*g[E])*(p[E]*p[E]),N[E]=(f-i[E])*(p[E]*p[E]),v+=h[E]*t[E]+N[E]*u[E]}return v},lagrange:function(i,t,u){for(var f=0,s=0,v,E,p=i.length;s<p;s++){for(E=t[s],v=0;v<p;v++)s!=v&&(E*=(u-i[v])/(i[s]-i[v]));f+=E}return f},cubic_spline:function(i,t,u){for(var f=i.length,s=0,v,E=[],p=[],g=[],h=[],N=[],m=[],A=[];s<f-1;s++)N[s]=i[s+1]-i[s];for(g[0]=0,s=1;s<f-1;s++)g[s]=3/N[s]*(t[s+1]-t[s])-3/N[s-1]*(t[s]-t[s-1]);for(s=1;s<f-1;s++)E[s]=[],p[s]=[],E[s][s-1]=N[s-1],E[s][s]=2*(N[s-1]+N[s]),E[s][s+1]=N[s],p[s][0]=g[s];for(h=e.multiply(e.inv(E),p),v=0;v<f-1;v++)m[v]=(t[v+1]-t[v])/N[v]-N[v]*(h[v+1][0]+2*h[v][0])/3,A[v]=(h[v+1][0]-h[v][0])/(3*N[v]);for(v=0;v<f&&!(i[v]>u);v++);return v-=1,t[v]+(u-i[v])*m[v]+e.sq(u-i[v])*h[v]+(u-i[v])*e.sq(u-i[v])*A[v]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(i){var t=i.length,u=i[0].length,f=0,s,v,E=[],p=[],g=[],h=[],N=[],m=[],A=[],R=[],y=[],C=[];for(f=0;f<t;f++)E[f]=e.sum(i[f])/u;for(f=0;f<u;f++)for(A[f]=[],s=0;s<t;s++)A[f][s]=i[s][f]-E[s];for(A=e.transpose(A),f=0;f<t;f++)for(R[f]=[],s=0;s<t;s++)R[f][s]=e.dot([A[f]],[A[s]])/(u-1);for(g=e.jacobi(R),y=g[0],p=g[1],C=e.transpose(y),f=0;f<p.length;f++)for(s=f;s<p.length;s++)p[f]<p[s]&&(v=p[f],p[f]=p[s],p[s]=v,h=C[f],C[f]=C[s],C[s]=h);for(m=e.transpose(A),f=0;f<t;f++)for(N[f]=[],s=0;s<m.length;s++)N[f][s]=e.dot([C[f]],[m[s]]);return[i,p,C,N]}}),function(c){for(var i=0;i<c.length;i++)(function(t){e.fn[t]=function(u,f){var s=this;return f?(setTimeout(function(){f.call(s,e.fn[t].call(s,u))},15),this):typeof e[t](this,u)=="number"?e[t](this,u):e(e[t](this,u))}})(c[i])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(e,n){var a=[].slice,o=e.utils.isNumber,l=e.utils.isArray;e.extend({zscore:function(){var t=a.call(arguments);return o(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var t=a.call(arguments),u;return l(t[1])?(u=e.zscore(t[0],t[1],t[3]),t[2]===1?e.normal.cdf(-n.abs(u),0,1):e.normal.cdf(-n.abs(u),0,1)*2):t.length>2?(u=e.zscore(t[0],t[1],t[2]),t[3]===1?e.normal.cdf(-n.abs(u),0,1):e.normal.cdf(-n.abs(u),0,1)*2):(u=t[0],t[1]===1?e.normal.cdf(-n.abs(u),0,1):e.normal.cdf(-n.abs(u),0,1)*2)}}),e.extend(e.fn,{zscore:function(t,u){return(t-this.mean())/this.stdev(u)},ztest:function(t,u,f){var s=n.abs(this.zscore(t,f));return u===1?e.normal.cdf(-s,0,1):e.normal.cdf(-s,0,1)*2}}),e.extend({tscore:function(){var t=a.call(arguments);return t.length===4?(t[0]-t[1])/(t[2]/n.sqrt(t[3])):(t[0]-e.mean(t[1]))/(e.stdev(t[1],!0)/n.sqrt(t[1].length))},ttest:function(){var t=a.call(arguments),u;return t.length===5?(u=n.abs(e.tscore(t[0],t[1],t[2],t[3])),t[4]===1?e.studentt.cdf(-u,t[3]-1):e.studentt.cdf(-u,t[3]-1)*2):o(t[1])?(u=n.abs(t[0]),t[2]==1?e.studentt.cdf(-u,t[1]-1):e.studentt.cdf(-u,t[1]-1)*2):(u=n.abs(e.tscore(t[0],t[1])),t[2]==1?e.studentt.cdf(-u,t[1].length-1):e.studentt.cdf(-u,t[1].length-1)*2)}}),e.extend(e.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(t,u){return u===1?1-e.studentt.cdf(n.abs(this.tscore(t)),this.cols()-1):e.studentt.cdf(-n.abs(this.tscore(t)),this.cols()-1)*2}}),e.extend({anovafscore:function(){var t=a.call(arguments),u,f,s,v,E,p,g,h;if(t.length===1){for(E=new Array(t[0].length),g=0;g<t[0].length;g++)E[g]=t[0][g];t=E}for(f=new Array,g=0;g<t.length;g++)f=f.concat(t[g]);for(s=e.mean(f),u=0,g=0;g<t.length;g++)u=u+t[g].length*n.pow(e.mean(t[g])-s,2);for(u/=t.length-1,p=0,g=0;g<t.length;g++)for(v=e.mean(t[g]),h=0;h<t[g].length;h++)p+=n.pow(t[g][h]-v,2);return p/=f.length-t.length,u/p},anovaftest:function(){var t=a.call(arguments),u,f,s,v;if(o(t[0]))return 1-e.centralF.cdf(t[0],t[1],t[2]);var E=e.anovafscore(t);for(u=t.length-1,s=0,v=0;v<t.length;v++)s=s+t[v].length;return f=s-u-1,1-e.centralF.cdf(E,u,f)},ftest:function(t,u,f){return 1-e.centralF.cdf(t,u,f)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t=0,u;for(u=0;u<this.length;u++)t=t+this[u].length;return e.ftest(this.anovafscore(),this.length-1,t-this.length)}}),e.extend({qscore:function(){var t=a.call(arguments),u,f,s,v,E;return o(t[0])?(u=t[0],f=t[1],s=t[2],v=t[3],E=t[4]):(u=e.mean(t[0]),f=e.mean(t[1]),s=t[0].length,v=t[1].length,E=t[2]),n.abs(u-f)/(E*n.sqrt((1/s+1/v)/2))},qtest:function(){var t=a.call(arguments),u;t.length===3?(u=t[0],t=t.slice(1)):t.length===7?(u=e.qscore(t[0],t[1],t[2],t[3],t[4]),t=t.slice(5)):(u=e.qscore(t[0],t[1],t[2]),t=t.slice(3));var f=t[0],s=t[1];return 1-e.tukey.cdf(u,s,f-s)},tukeyhsd:function(t){for(var u=e.pooledstdev(t),f=t.map(function(h){return e.mean(h)}),s=t.reduce(function(h,N){return h+N.length},0),v=[],E=0;E<t.length;++E)for(var p=E+1;p<t.length;++p){var g=e.qtest(f[E],f[p],t[E].length,t[p].length,u,s,t.length);v.push([[E,p],g])}return v}}),e.extend({normalci:function(){var t=a.call(arguments),u=new Array(2),f;return t.length===4?f=n.abs(e.normal.inv(t[1]/2,0,1)*t[2]/n.sqrt(t[3])):f=n.abs(e.normal.inv(t[1]/2,0,1)*e.stdev(t[2])/n.sqrt(t[2].length)),u[0]=t[0]-f,u[1]=t[0]+f,u},tci:function(){var t=a.call(arguments),u=new Array(2),f;return t.length===4?f=n.abs(e.studentt.inv(t[1]/2,t[3]-1)*t[2]/n.sqrt(t[3])):f=n.abs(e.studentt.inv(t[1]/2,t[2].length-1)*e.stdev(t[2],!0)/n.sqrt(t[2].length)),u[0]=t[0]-f,u[1]=t[0]+f,u},significant:function(t,u){return t<u}}),e.extend(e.fn,{normalci:function(t,u){return e.normalci(t,u,this.toArray())},tci:function(t,u){return e.tci(t,u,this.toArray())}});function c(i,t,u,f){if(i>1||u>1||i<=0||u<=0)throw new Error("Proportions should be greater than 0 and less than 1");var s=(i*t+u*f)/(t+f),v=n.sqrt(s*(1-s)*(1/t+1/f));return(i-u)/v}e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,u,f,s){var v=c(t,u,f,s);return e.ztest(v,1)},twoSidedDifferenceOfProportions:function(t,u,f,s){var v=c(t,u,f,s);return e.ztest(v,2)}})}(r,Math),r.models=function(){function e(c){var i=c[0].length,t=r.arange(i).map(function(u){var f=r.arange(i).filter(function(s){return s!==u});return n(r.col(c,u).map(function(s){return s[0]}),r.col(c,f))});return t}function n(c,i){var t=c.length,u=i[0].length-1,f=t-u-1,s=r.lstsq(i,c),v=r.multiply(i,s.map(function(A){return[A]})).map(function(A){return A[0]}),E=r.subtract(c,v),p=r.mean(c),g=r.sum(v.map(function(A){return Math.pow(A-p,2)})),h=r.sum(c.map(function(A,R){return Math.pow(A-v[R],2)})),N=g+h,m=g/N;return{exog:i,endog:c,nobs:t,df_model:u,df_resid:f,coef:s,predict:v,resid:E,ybar:p,SST:N,SSE:g,SSR:h,R2:m}}function a(c){var i=e(c.exog),t=Math.sqrt(c.SSR/c.df_resid),u=i.map(function(p){var g=p.SST,h=p.R2;return t/Math.sqrt(g*(1-h))}),f=c.coef.map(function(p,g){return(p-0)/u[g]}),s=f.map(function(p){var g=r.studentt.cdf(p,c.df_resid);return(g>.5?1-g:g)*2}),v=r.studentt.inv(.975,c.df_resid),E=c.coef.map(function(p,g){var h=v*u[g];return[p-h,p+h]});return{se:u,t:f,p:s,sigmaHat:t,interval95:E}}function o(c){var i=c.R2/c.df_model/((1-c.R2)/c.df_resid),t=function(f,s,v){return r.beta.cdf(f/(v/s+f),s/2,v/2)},u=1-t(i,c.df_model,c.df_resid);return{F_statistic:i,pvalue:u}}function l(c,i){var t=n(c,i),u=a(t),f=o(t),s=1-(1-t.R2)*((t.nobs-1)/t.df_resid);return t.t=u,t.f=f,t.adjust_R2=s,t}return{ols:l}}(),r.extend({buildxmatrix:function(){for(var n=new Array(arguments.length),a=0;a<arguments.length;a++){var o=[1];n[a]=o.concat(arguments[a])}return r(n)},builddxmatrix:function(){for(var n=new Array(arguments[0].length),a=0;a<arguments[0].length;a++){var o=[1];n[a]=o.concat(arguments[0][a])}return r(n)},buildjxmatrix:function(n){for(var a=new Array(n.length),o=0;o<n.length;o++)a[o]=n[o];return r.builddxmatrix(a)},buildymatrix:function(n){return r(n).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(n,a){var o,l,c,i,t;if(n.cols()==a.rows()){if(a.rows()>1){for(i=[],o=0;o<n.rows();o++)for(i[o]=[],l=0;l<a.cols();l++){for(t=0,c=0;c<n.cols();c++)t+=n.toArray()[o][c]*a.toArray()[c][l];i[o][l]=t}return r(i)}for(i=[],o=0;o<n.rows();o++)for(i[o]=[],l=0;l<a.cols();l++){for(t=0,c=0;c<n.cols();c++)t+=n.toArray()[o][c]*a.toArray()[l];i[o][l]=t}return r(i)}},regress:function(n,a){var o=r.xtranspxinv(n),l=n.transpose(),c=r.matrixmult(r(o),l);return r.matrixmult(c,a)},regresst:function(n,a,o){var l=r.regress(n,a),c={};c.anova={};var i=r.jMatYBar(n,l);c.yBar=i;var t=a.mean();c.anova.residuals=r.residuals(a,i),c.anova.ssr=r.ssr(i,t),c.anova.msr=c.anova.ssr/(n[0].length-1),c.anova.sse=r.sse(a,i),c.anova.mse=c.anova.sse/(a.length-(n[0].length-1)-1),c.anova.sst=r.sst(a,t),c.anova.mst=c.anova.sst/(a.length-1),c.anova.r2=1-c.anova.sse/c.anova.sst,c.anova.r2<0&&(c.anova.r2=0),c.anova.fratio=c.anova.msr/c.anova.mse,c.anova.pvalue=r.anovaftest(c.anova.fratio,n[0].length-1,a.length-(n[0].length-1)-1),c.anova.rmse=Math.sqrt(c.anova.mse),c.anova.r2adj=1-c.anova.mse/c.anova.mst,c.anova.r2adj<0&&(c.anova.r2adj=0),c.stats=new Array(n[0].length);for(var u=r.xtranspxinv(n),f,s,v,E=0;E<l.length;E++)f=Math.sqrt(c.anova.mse*Math.abs(u[E][E])),s=Math.abs(l[E]/f),v=r.ttest(s,a.length-n[0].length-1,o),c.stats[E]=[l[E],f,s,v];return c.regress=l,c},xtranspx:function(n){return r.matrixmult(n.transpose(),n)},xtranspxinv:function(n){var a=r.matrixmult(n.transpose(),n),o=r.inv(a);return o},jMatYBar:function(n,a){var o=r.matrixmult(n,a);return new r(o)},residuals:function(n,a){return r.matrixsubtract(n,a)},ssr:function(n,a){for(var o=0,l=0;l<n.length;l++)o+=Math.pow(n[l]-a,2);return o},sse:function(n,a){for(var o=0,l=0;l<n.length;l++)o+=Math.pow(n[l]-a[l],2);return o},sst:function(n,a){for(var o=0,l=0;l<n.length;l++)o+=Math.pow(n[l]-a,2);return o},matrixsubtract:function(n,a){for(var o=new Array(n.length),l=0;l<n.length;l++){o[l]=new Array(n[l].length);for(var c=0;c<n[l].length;c++)o[l][c]=n[l][c]-a[l][c]}return r(o)}}),r.jStat=r,r})});var qe=vr(oe=>{var At="=",Rt=[">",">=","<","<=","=","<>"],ae="operator",be="literal",Tt=[ae,be];oe.TOKEN_TYPE_OPERATOR=ae;oe.TOKEN_TYPE_LITERAL=be;function Fe(r,e){if(Tt.indexOf(e)===-1)throw new Error("Unsupported token type: "+e);return{value:r,type:e}}function Ot(r){return typeof r!="string"||/^\d+(\.\d+)?$/.test(r)&&(r=r.indexOf(".")===-1?parseInt(r,10):parseFloat(r)),r}function yt(r){for(var e=r.length,n=[],a=0,o="",l="";a<e;){var c=r.charAt(a);switch(c){case">":case"<":case"=":l=l+c,o.length>0&&(n.push(o),o="");break;default:l.length>0&&(n.push(l),l=""),o=o+c;break}a++}return o.length>0&&n.push(o),l.length>0&&n.push(l),n}function Mt(r){for(var e="",n=[],a=0;a<r.length;a++){var o=r[a];a===0&&Rt.indexOf(o)>=0?n.push(Fe(o,ae)):e+=o}return e.length>0&&n.push(Fe(Ot(e),be)),n.length>0&&n[0].type!==ae&&n.unshift(Fe(At,ae)),n}function Ct(r){for(var e=[],n,a=0;a<r.length;a++){var o=r[a];switch(o.type){case ae:n=o.value;break;case be:e.push(o.value);break}}return Lt(e,n)}function Lt(r,e){var n=!1;switch(e){case">":n=r[0]>r[1];break;case">=":n=r[0]>=r[1];break;case"<":n=r[0]<r[1];break;case"<=":n=r[0]<=r[1];break;case"=":n=r[0]==r[1];break;case"<>":n=r[0]!=r[1];break}return n}oe.parse=function(r){return Mt(yt(r))};oe.createToken=Fe;oe.compute=Ct});var an=vr(re=>{var qn=Hr(),Dt=wr();re.UNIQUE=function(){for(var r=[],e=0;e<arguments.length;++e){for(var n=!1,a=arguments[e],o=0;o<r.length&&(n=r[o]===a,!n);++o);n||r.push(a)}return r};re.FLATTEN=qn.flatten;re.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};re.REFERENCE=function(r,e){if(!arguments.length)return Dt.error;try{for(var n=e.split("."),a=r,o=0;o<n.length;++o){var l=n[o];if(l[l.length-1]==="]"){var c=l.indexOf("["),i=l.substring(c+1,l.length-1);a=a[l.substring(0,c)][i]}else a=a[l]}return a}catch{}};re.JOIN=function(r,e){return r.join(e)};re.NUMBERS=function(){var r=qn.flatten(arguments);return r.filter(function(e){return typeof e=="number"})}});var Ne=vr(O=>{var zr=he(),wt=Ue(),U=un(),I=Hr(),Or=qe(),w=wr(),on=an(),dt=2.5066282746310002;O.AVEDEV=function(){var r=I.parseNumberArray(I.flatten(arguments));return r instanceof Error?r:U.sum(U(r).subtract(U.mean(r)).abs()[0])/r.length};O.AVERAGE=function(){for(var r=I.numbers(I.flatten(arguments)),e=r.length,n=0,a=0,o,l=0;l<e;l++)n+=r[l],a+=1;return o=n/a,isNaN(o)&&(o=w.num),o};O.AVERAGEA=function(){for(var r=I.flatten(arguments),e=r.length,n=0,a=0,o,l=0;l<e;l++){var c=r[l];typeof c=="number"&&(n+=c),c===!0&&n++,c!==null&&a++}return o=n/a,isNaN(o)&&(o=w.num),o};O.AVERAGEIF=function(r,e,n){if(arguments.length<=1)return w.na;if(n=n||r,r=I.flatten(r),n=I.parseNumberArray(I.flatten(n)),n instanceof Error)return n;for(var a=0,o=0,l=e===void 0||e==="*",c=l?null:Or.parse(e+""),i=0;i<r.length;i++){var t=r[i];if(l)o+=n[i],a++;else{var u=[Or.createToken(t,Or.TOKEN_TYPE_LITERAL)].concat(c);Or.compute(u)&&(o+=n[i],a++)}}return o/a};O.AVERAGEIFS=function(){for(var r=I.argsToArray(arguments),e=(r.length-1)/2,n=I.flatten(r[0]),a=0,o=0,l=0;l<n.length;l++){for(var c=!1,i=0;i<e;i++){var t=r[2*i+1][l],u=r[2*i+2],f=u===void 0||u==="*",s=!1;if(f)s=!0;else{var v=Or.parse(u+""),E=[Or.createToken(t,Or.TOKEN_TYPE_LITERAL)].concat(v);s=Or.compute(E)}if(!s){c=!1;break}c=!0}c&&(o+=n[l],a++)}var p=o/a;return isNaN(p)?0:p};O.BETA={};O.BETA.DIST=function(r,e,n,a,o,l){return arguments.length<4||(o=o===void 0?0:o,l=l===void 0?1:l,r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),o=I.parseNumber(o),l=I.parseNumber(l),I.anyIsError(r,e,n,o,l))?w.value:(r=(r-o)/(l-o),a?U.beta.cdf(r,e,n):U.beta.pdf(r,e,n))};O.BETA.INV=function(r,e,n,a,o){return a=a===void 0?0:a,o=o===void 0?1:o,r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),a=I.parseNumber(a),o=I.parseNumber(o),I.anyIsError(r,e,n,a,o)?w.value:U.beta.inv(r,e,n)*(o-a)+a};O.BINOM={};O.BINOM.DIST=function(r,e,n,a){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),a=I.parseNumber(a),I.anyIsError(r,e,n,a)?w.value:a?U.binomial.cdf(r,e,n):U.binomial.pdf(r,e,n)};O.BINOM.DIST.RANGE=function(r,e,n,a){if(a=a===void 0?n:a,r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),a=I.parseNumber(a),I.anyIsError(r,e,n,a))return w.value;for(var o=0,l=n;l<=a;l++)o+=zr.COMBIN(r,l)*Math.pow(e,l)*Math.pow(1-e,r-l);return o};O.BINOM.INV=function(r,e,n){if(r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n))return w.value;for(var a=0;a<=r;){if(U.binomial.cdf(a,r,e)>=n)return a;a++}};O.CHISQ={};O.CHISQ.DIST=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:n?U.chisquare.cdf(r,e):U.chisquare.pdf(r,e)};O.CHISQ.DIST.RT=function(r,e){return!r|!e?w.na:r<1||e>Math.pow(10,10)?w.num:typeof r!="number"||typeof e!="number"?w.value:1-U.chisquare.cdf(r,e)};O.CHISQ.INV=function(r,e){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:U.chisquare.inv(r,e)};O.CHISQ.INV.RT=function(r,e){return!r|!e?w.na:r<0||r>1||e<1||e>Math.pow(10,10)?w.num:typeof r!="number"||typeof e!="number"?w.value:U.chisquare.inv(1-r,e)};O.CHISQ.TEST=function(r,e){if(arguments.length!==2)return w.na;if(!(r instanceof Array)||!(e instanceof Array)||r.length!==e.length||r[0]&&e[0]&&r[0].length!==e[0].length)return w.value;var n=r.length,a,o,l;for(o=0;o<n;o++)r[o]instanceof Array||(a=r[o],r[o]=[],r[o].push(a)),e[o]instanceof Array||(a=e[o],e[o]=[],e[o].push(a));var c=r[0].length,i=c===1?n-1:(n-1)*(c-1),t=0,u=Math.PI;for(o=0;o<n;o++)for(l=0;l<c;l++)t+=Math.pow(r[o][l]-e[o][l],2)/e[o][l];function f(s,v){var E=Math.exp(-.5*s);v%2===1&&(E=E*Math.sqrt(2*s/u));for(var p=v;p>=2;)E=E*s/p,p=p-2;for(var g=E,h=v;g>1e-10*E;)h=h+2,g=g*s/h,E=E+g;return 1-E}return Math.round(f(t,i)*1e6)/1e6};O.COLUMN=function(r,e){if(arguments.length!==2)return w.na;if(e<0)return w.num;if(!(r instanceof Array)||typeof e!="number")return w.value;if(r.length!==0)return U.col(r,e)};O.COLUMNS=function(r){return arguments.length!==1?w.na:r instanceof Array?r.length===0?0:U.cols(r):w.value};O.CONFIDENCE={};O.CONFIDENCE.NORM=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:U.normalci(1,r,e,n)[1]-1};O.CONFIDENCE.T=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:U.tci(1,r,e,n)[1]-1};O.CORREL=function(r,e){return r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e)?w.value:U.corrcoeff(r,e)};O.COUNT=function(){return I.numbers(I.flatten(arguments)).length};O.COUNTA=function(){var r=I.flatten(arguments);return r.length-O.COUNTBLANK(r)};O.COUNTIN=function(r,e){var n=0;r=I.flatten(r);for(var a=0;a<r.length;a++)r[a]===e&&n++;return n};O.COUNTBLANK=function(){for(var r=I.flatten(arguments),e=0,n,a=0;a<r.length;a++)n=r[a],(n===null||n==="")&&e++;return e};O.COUNTIF=function(r,e){r=I.flatten(r);var n=e===void 0||e==="*";if(n)return r.length;for(var a=0,o=Or.parse(e+""),l=0;l<r.length;l++){var c=r[l],i=[Or.createToken(c,Or.TOKEN_TYPE_LITERAL)].concat(o);Or.compute(i)&&a++}return a};O.COUNTIFS=function(){for(var r=I.argsToArray(arguments),e=new Array(I.flatten(r[0]).length),n=0;n<e.length;n++)e[n]=!0;for(n=0;n<r.length;n+=2){var a=I.flatten(r[n]),o=r[n+1],l=o===void 0||o==="*";if(!l)for(var c=Or.parse(o+""),i=0;i<a.length;i++){var t=a[i],u=[Or.createToken(t,Or.TOKEN_TYPE_LITERAL)].concat(c);e[i]=e[i]&&Or.compute(u)}}var f=0;for(n=0;n<e.length;n++)e[n]&&f++;return f};O.COUNTUNIQUE=function(){return on.UNIQUE.apply(null,I.flatten(arguments)).length};O.COVARIANCE={};O.COVARIANCE.P=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;for(var n=U.mean(r),a=U.mean(e),o=0,l=r.length,c=0;c<l;c++)o+=(r[c]-n)*(e[c]-a);return o/l};O.COVARIANCE.S=function(r,e){return r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e)?w.value:U.covariance(r,e)};O.DEVSQ=function(){var r=I.parseNumberArray(I.flatten(arguments));if(r instanceof Error)return r;for(var e=U.mean(r),n=0,a=0;a<r.length;a++)n+=Math.pow(r[a]-e,2);return n};O.EXPON={};O.EXPON.DIST=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:n?U.exponential.cdf(r,e):U.exponential.pdf(r,e)};O.F={};O.F.DIST=function(r,e,n,a){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:a?U.centralF.cdf(r,e,n):U.centralF.pdf(r,e,n)};O.F.DIST.RT=function(r,e,n){return arguments.length!==3?w.na:r<0||e<1||n<1?w.num:typeof r!="number"||typeof e!="number"||typeof n!="number"?w.value:1-U.centralF.cdf(r,e,n)};O.F.INV=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:r<=0||r>1?w.num:U.centralF.inv(r,e,n)};O.F.INV.RT=function(r,e,n){return arguments.length!==3?w.na:r<0||r>1||e<1||e>Math.pow(10,10)||n<1||n>Math.pow(10,10)?w.num:typeof r!="number"||typeof e!="number"||typeof n!="number"?w.value:U.centralF.inv(1-r,e,n)};O.F.TEST=function(r,e){if(!r||!e||!(r instanceof Array)||!(e instanceof Array))return w.na;if(r.length<2||e.length<2)return w.div0;var n=function(i,t){for(var u=0,f=0;f<i.length;f++)u+=Math.pow(i[f]-t,2);return u},a=zr.SUM(r)/r.length,o=zr.SUM(e)/e.length,l=n(r,a)/(r.length-1),c=n(e,o)/(e.length-1);return l/c};O.FISHER=function(r){return r=I.parseNumber(r),r instanceof Error?r:Math.log((1+r)/(1-r))/2};O.FISHERINV=function(r){if(r=I.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e-1)/(e+1)};O.FORECAST=function(r,e,n){if(r=I.parseNumber(r),e=I.parseNumberArray(I.flatten(e)),n=I.parseNumberArray(I.flatten(n)),I.anyIsError(r,e,n))return w.value;for(var a=U.mean(n),o=U.mean(e),l=n.length,c=0,i=0,t=0;t<l;t++)c+=(n[t]-a)*(e[t]-o),i+=Math.pow(n[t]-a,2);var u=c/i,f=o-u*a;return f+u*r};O.FREQUENCY=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;for(var n=r.length,a=e.length,o=[],l=0;l<=a;l++){o[l]=0;for(var c=0;c<n;c++)l===0?r[c]<=e[0]&&(o[0]+=1):l<a?r[c]>e[l-1]&&r[c]<=e[l]&&(o[l]+=1):l===a&&r[c]>e[a-1]&&(o[a]+=1)}return o};O.GAMMA=function(r){return r=I.parseNumber(r),r instanceof Error?r:r===0||parseInt(r,10)===r&&r<0?w.num:U.gammafn(r)};O.GAMMA.DIST=function(r,e,n,a){return arguments.length!==4?w.na:r<0||e<=0||n<=0||typeof r!="number"||typeof e!="number"||typeof n!="number"?w.value:a?U.gamma.cdf(r,e,n,!0):U.gamma.pdf(r,e,n,!1)};O.GAMMA.INV=function(r,e,n){return arguments.length!==3?w.na:r<0||r>1||e<=0||n<=0?w.num:typeof r!="number"||typeof e!="number"||typeof n!="number"?w.value:U.gamma.inv(r,e,n)};O.GAMMALN=function(r){return r=I.parseNumber(r),r instanceof Error?r:U.gammaln(r)};O.GAMMALN.PRECISE=function(r){return arguments.length!==1?w.na:r<=0?w.num:typeof r!="number"?w.value:U.gammaln(r)};O.GAUSS=function(r){return r=I.parseNumber(r),r instanceof Error?r:U.normal.cdf(r,0,1)-.5};O.GEOMEAN=function(){var r=I.parseNumberArray(I.flatten(arguments));return r instanceof Error?r:U.geomean(r)};O.GROWTH=function(r,e,n,a){if(r=I.parseNumberArray(r),r instanceof Error)return r;var o;if(e===void 0)for(e=[],o=1;o<=r.length;o++)e.push(o);if(n===void 0)for(n=[],o=1;o<=r.length;o++)n.push(o);if(e=I.parseNumberArray(e),n=I.parseNumberArray(n),I.anyIsError(e,n))return w.value;a===void 0&&(a=!0);var l=r.length,c=0,i=0,t=0,u=0;for(o=0;o<l;o++){var f=e[o],s=Math.log(r[o]);c+=f,i+=s,t+=f*s,u+=f*f}c/=l,i/=l,t/=l,u/=l;var v,E;a?(v=(t-c*i)/(u-c*c),E=i-v*c):(v=t/u,E=0);var p=[];for(o=0;o<n.length;o++)p.push(Math.exp(E+v*n[o]));return p};O.HARMEAN=function(){var r=I.parseNumberArray(I.flatten(arguments));if(r instanceof Error)return r;for(var e=r.length,n=0,a=0;a<e;a++)n+=1/r[a];return e/n};O.HYPGEOM={};O.HYPGEOM.DIST=function(r,e,n,a,o){if(r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),a=I.parseNumber(a),I.anyIsError(r,e,n,a))return w.value;function l(i,t,u,f){return zr.COMBIN(u,i)*zr.COMBIN(f-u,t-i)/zr.COMBIN(f,t)}function c(i,t,u,f){for(var s=0,v=0;v<=i;v++)s+=l(v,t,u,f);return s}return o?c(r,e,n,a):l(r,e,n,a)};O.INTERCEPT=function(r,e){return r=I.parseNumberArray(r),e=I.parseNumberArray(e),I.anyIsError(r,e)?w.value:r.length!==e.length?w.na:O.FORECAST(0,r,e)};O.KURT=function(){var r=I.parseNumberArray(I.flatten(arguments));if(r instanceof Error)return r;for(var e=U.mean(r),n=r.length,a=0,o=0;o<n;o++)a+=Math.pow(r[o]-e,4);return a=a/Math.pow(U.stdev(r,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*a-3*(n-1)*(n-1)/((n-2)*(n-3))};O.LARGE=function(r,e){return r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e)?r:r.sort(function(n,a){return a-n})[e-1]};O.LINEST=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;for(var n=U.mean(r),a=U.mean(e),o=e.length,l=0,c=0,i=0;i<o;i++)l+=(e[i]-a)*(r[i]-n),c+=Math.pow(e[i]-a,2);var t=l/c,u=n-t*a;return[t,u]};O.LOGEST=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;for(var n=0;n<r.length;n++)r[n]=Math.log(r[n]);var a=O.LINEST(r,e);return a[0]=Math.round(Math.exp(a[0])*1e6)/1e6,a[1]=Math.round(Math.exp(a[1])*1e6)/1e6,a};O.LOGNORM={};O.LOGNORM.DIST=function(r,e,n,a){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:a?U.lognormal.cdf(r,e,n):U.lognormal.pdf(r,e,n)};O.LOGNORM.INV=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:U.lognormal.inv(r,e,n)};O.MAX=function(){var r=I.numbers(I.flatten(arguments));return r.length===0?0:Math.max.apply(Math,r)};O.MAXA=function(){var r=I.arrayValuesToNumbers(I.flatten(arguments));return r.length===0?0:Math.max.apply(Math,r)};O.MEDIAN=function(){var r=I.arrayValuesToNumbers(I.flatten(arguments)),e=U.median(r);return isNaN(e)&&(e=w.num),e};O.MIN=function(){var r=I.numbers(I.flatten(arguments));return r.length===0?0:Math.min.apply(Math,r)};O.MINA=function(){var r=I.arrayValuesToNumbers(I.flatten(arguments));return r.length===0?0:Math.min.apply(Math,r)};O.MODE={};O.MODE.MULT=function(){var r=I.parseNumberArray(I.flatten(arguments));if(r instanceof Error)return r;for(var e=r.length,n={},a=[],o=0,l,c=0;c<e;c++)l=r[c],n[l]=n[l]?n[l]+1:1,n[l]>o&&(o=n[l],a=[]),n[l]===o&&(a[a.length]=l);return a};O.MODE.SNGL=function(){var r=I.parseNumberArray(I.flatten(arguments));return r instanceof Error?r:O.MODE.MULT(r).sort(function(e,n){return e-n})[0]};O.NEGBINOM={};O.NEGBINOM.DIST=function(r,e,n,a){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:a?U.negbin.cdf(r,e,n):U.negbin.pdf(r,e,n)};O.NORM={};O.NORM.DIST=function(r,e,n,a){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:n<=0?w.num:a?U.normal.cdf(r,e,n):U.normal.pdf(r,e,n)};O.NORM.INV=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:U.normal.inv(r,e,n)};O.NORM.S={};O.NORM.S.DIST=function(r,e){return r=I.parseNumber(r),r instanceof Error?w.value:e?U.normal.cdf(r,0,1):U.normal.pdf(r,0,1)};O.NORM.S.INV=function(r){return r=I.parseNumber(r),r instanceof Error?w.value:U.normal.inv(r,0,1)};O.PEARSON=function(r,e){if(e=I.parseNumberArray(I.flatten(e)),r=I.parseNumberArray(I.flatten(r)),I.anyIsError(e,r))return w.value;for(var n=U.mean(r),a=U.mean(e),o=r.length,l=0,c=0,i=0,t=0;t<o;t++)l+=(r[t]-n)*(e[t]-a),c+=Math.pow(r[t]-n,2),i+=Math.pow(e[t]-a,2);return l/Math.sqrt(c*i)};O.PERCENTILE={};O.PERCENTILE.EXC=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e))return w.value;r=r.sort(function(l,c){return l-c});var n=r.length;if(e<1/(n+1)||e>1-1/(n+1))return w.num;var a=e*(n+1)-1,o=Math.floor(a);return I.cleanFloat(a===o?r[a]:r[o]+(a-o)*(r[o+1]-r[o]))};O.PERCENTILE.INC=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e))return w.value;r=r.sort(function(l,c){return l-c});var n=r.length,a=e*(n-1),o=Math.floor(a);return I.cleanFloat(a===o?r[a]:r[o]+(a-o)*(r[o+1]-r[o]))};O.PERCENTRANK={};O.PERCENTRANK.EXC=function(r,e,n){if(n=n===void 0?3:n,r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n))return w.value;r=r.sort(function(f,s){return f-s});for(var a=on.UNIQUE.apply(null,r),o=r.length,l=a.length,c=Math.pow(10,n),i=0,t=!1,u=0;!t&&u<l;)e===a[u]?(i=(r.indexOf(a[u])+1)/(o+1),t=!0):e>=a[u]&&(e<a[u+1]||u===l-1)&&(i=(r.indexOf(a[u])+1+(e-a[u])/(a[u+1]-a[u]))/(o+1),t=!0),u++;return Math.floor(i*c)/c};O.PERCENTRANK.INC=function(r,e,n){if(n=n===void 0?3:n,r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n))return w.value;r=r.sort(function(f,s){return f-s});for(var a=on.UNIQUE.apply(null,r),o=r.length,l=a.length,c=Math.pow(10,n),i=0,t=!1,u=0;!t&&u<l;)e===a[u]?(i=r.indexOf(a[u])/(o-1),t=!0):e>=a[u]&&(e<a[u+1]||u===l-1)&&(i=(r.indexOf(a[u])+(e-a[u])/(a[u+1]-a[u]))/(o-1),t=!0),u++;return Math.floor(i*c)/c};O.PERMUT=function(r,e){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:zr.FACT(r)/zr.FACT(r-e)};O.PERMUTATIONA=function(r,e){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:Math.pow(r,e)};O.PHI=function(r){return r=I.parseNumber(r),r instanceof Error?w.value:Math.exp(-.5*r*r)/dt};O.POISSON={};O.POISSON.DIST=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:n?U.poisson.cdf(r,e):U.poisson.pdf(r,e)};O.PROB=function(r,e,n,a){if(n===void 0)return 0;if(a=a===void 0?n:a,r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),n=I.parseNumber(n),a=I.parseNumber(a),I.anyIsError(r,e,n,a))return w.value;if(n===a)return r.indexOf(n)>=0?e[r.indexOf(n)]:0;for(var o=r.sort(function(t,u){return t-u}),l=o.length,c=0,i=0;i<l;i++)o[i]>=n&&o[i]<=a&&(c+=e[r.indexOf(o[i])]);return c};O.QUARTILE={};O.QUARTILE.EXC=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e))return w.value;switch(e){case 1:return O.PERCENTILE.EXC(r,.25);case 2:return O.PERCENTILE.EXC(r,.5);case 3:return O.PERCENTILE.EXC(r,.75);default:return w.num}};O.QUARTILE.INC=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e))return w.value;switch(e){case 1:return O.PERCENTILE.INC(r,.25);case 2:return O.PERCENTILE.INC(r,.5);case 3:return O.PERCENTILE.INC(r,.75);default:return w.num}};O.RANK={};O.RANK.AVG=function(r,e,n){if(r=I.parseNumber(r),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;e=I.flatten(e),n=n||!1;var a=n?function(i,t){return i-t}:function(i,t){return t-i};e=e.sort(a);for(var o=e.length,l=0,c=0;c<o;c++)e[c]===r&&l++;return l>1?(2*e.indexOf(r)+l+1)/2:e.indexOf(r)+1};O.RANK.EQ=function(r,e,n){if(r=I.parseNumber(r),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;n=n||!1;var a=n?function(o,l){return o-l}:function(o,l){return l-o};return e=e.sort(a),e.indexOf(r)+1};O.ROW=function(r,e){if(arguments.length!==2)return w.na;if(e<0)return w.num;if(!(r instanceof Array)||typeof e!="number")return w.value;if(r.length!==0)return U.row(r,e)};O.ROWS=function(r){return arguments.length!==1?w.na:r instanceof Array?r.length===0?0:U.rows(r):w.value};O.RSQ=function(r,e){return r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e)?w.value:Math.pow(O.PEARSON(r,e),2)};O.SKEW=function(){var r=I.parseNumberArray(I.flatten(arguments));if(r instanceof Error)return r;for(var e=U.mean(r),n=r.length,a=0,o=0;o<n;o++)a+=Math.pow(r[o]-e,3);return n*a/((n-1)*(n-2)*Math.pow(U.stdev(r,!0),3))};O.SKEW.P=function(){var r=I.parseNumberArray(I.flatten(arguments));if(r instanceof Error)return r;for(var e=U.mean(r),n=r.length,a=0,o=0,l=0;l<n;l++)o+=Math.pow(r[l]-e,3),a+=Math.pow(r[l]-e,2);return o=o/n,a=a/n,o/Math.pow(a,3/2)};O.SLOPE=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;for(var n=U.mean(e),a=U.mean(r),o=e.length,l=0,c=0,i=0;i<o;i++)l+=(e[i]-n)*(r[i]-a),c+=Math.pow(e[i]-n,2);return l/c};O.SMALL=function(r,e){return r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e)?r:r.sort(function(n,a){return n-a})[e-1]};O.STANDARDIZE=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:(r-e)/n};O.STDEV={};O.STDEV.P=function(){var r=O.VAR.P.apply(this,arguments),e=Math.sqrt(r);return isNaN(e)&&(e=w.num),e};O.STDEV.S=function(){var r=O.VAR.S.apply(this,arguments),e=Math.sqrt(r);return e};O.STDEVA=function(){var r=O.VARA.apply(this,arguments),e=Math.sqrt(r);return e};O.STDEVPA=function(){var r=O.VARPA.apply(this,arguments),e=Math.sqrt(r);return isNaN(e)&&(e=w.num),e};O.STEYX=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;for(var n=U.mean(e),a=U.mean(r),o=e.length,l=0,c=0,i=0,t=0;t<o;t++)l+=Math.pow(r[t]-a,2),c+=(e[t]-n)*(r[t]-a),i+=Math.pow(e[t]-n,2);return Math.sqrt((l-c*c/i)/(o-2))};O.TRANSPOSE=function(r){return r?U.transpose(r):w.na};O.T=wt.T;O.T.DIST=function(r,e,n){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:n?U.studentt.cdf(r,e):U.studentt.pdf(r,e)};O.T.DIST["2T"]=function(r,e){return arguments.length!==2?w.na:r<0||e<1?w.num:typeof r!="number"||typeof e!="number"?w.value:(1-U.studentt.cdf(r,e))*2};O.T.DIST.RT=function(r,e){return arguments.length!==2?w.na:r<0||e<1?w.num:typeof r!="number"||typeof e!="number"?w.value:1-U.studentt.cdf(r,e)};O.T.INV=function(r,e){return r=I.parseNumber(r),e=I.parseNumber(e),I.anyIsError(r,e)?w.value:U.studentt.inv(r,e)};O.T.INV["2T"]=function(r,e){return r=I.parseNumber(r),e=I.parseNumber(e),r<=0||r>1||e<1?w.num:I.anyIsError(r,e)?w.value:Math.abs(U.studentt.inv(r/2,e))};O.T.TEST=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),I.anyIsError(r,e))return w.value;var n=U.mean(r),a=U.mean(e),o=0,l=0,c;for(c=0;c<r.length;c++)o+=Math.pow(r[c]-n,2);for(c=0;c<e.length;c++)l+=Math.pow(e[c]-a,2);o=o/(r.length-1),l=l/(e.length-1);var i=Math.abs(n-a)/Math.sqrt(o/r.length+l/e.length);return O.T.DIST["2T"](i,r.length+e.length-2)};O.TREND=function(r,e,n){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumberArray(I.flatten(e)),n=I.parseNumberArray(I.flatten(n)),I.anyIsError(r,e,n))return w.value;var a=O.LINEST(r,e),o=a[0],l=a[1],c=[];return n.forEach(function(i){c.push(o*i+l)}),c};O.TRIMMEAN=function(r,e){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e))return w.value;var n=zr.FLOOR(r.length*e,2)/2;return U.mean(I.initial(I.rest(r.sort(function(a,o){return a-o}),n),n))};O.VAR={};O.VAR.P=function(){for(var r=I.numbers(I.flatten(arguments)),e=r.length,n=0,a=O.AVERAGE(r),o,l=0;l<e;l++)n+=Math.pow(r[l]-a,2);return o=n/e,isNaN(o)&&(o=w.num),o};O.VAR.S=function(){for(var r=I.numbers(I.flatten(arguments)),e=r.length,n=0,a=O.AVERAGE(r),o=0;o<e;o++)n+=Math.pow(r[o]-a,2);return n/(e-1)};O.VARA=function(){for(var r=I.flatten(arguments),e=r.length,n=0,a=0,o=O.AVERAGEA(r),l=0;l<e;l++){var c=r[l];typeof c=="number"?n+=Math.pow(c-o,2):c===!0?n+=Math.pow(1-o,2):n+=Math.pow(0-o,2),c!==null&&a++}return n/(a-1)};O.VARPA=function(){for(var r=I.flatten(arguments),e=r.length,n=0,a=0,o=O.AVERAGEA(r),l,c=0;c<e;c++){var i=r[c];typeof i=="number"?n+=Math.pow(i-o,2):i===!0?n+=Math.pow(1-o,2):n+=Math.pow(0-o,2),i!==null&&a++}return l=n/a,isNaN(l)&&(l=w.num),l};O.WEIBULL={};O.WEIBULL.DIST=function(r,e,n,a){return r=I.parseNumber(r),e=I.parseNumber(e),n=I.parseNumber(n),I.anyIsError(r,e,n)?w.value:a?1-Math.exp(-Math.pow(r/n,e)):Math.pow(r,e-1)*Math.exp(-Math.pow(r/n,e))*e/Math.pow(n,e)};O.Z={};O.Z.TEST=function(r,e,n){if(r=I.parseNumberArray(I.flatten(r)),e=I.parseNumber(e),I.anyIsError(r,e))return w.value;n=n||O.STDEV.S(r);var a=r.length;return 1-O.NORM.S.DIST((O.AVERAGE(r)-e)/(n/Math.sqrt(a)),!0)}});var Ge=vr(x=>{var hr=wr();x.CELL=function(){throw new Error("CELL is not implemented")};x.ERROR={};x.ERROR.TYPE=function(r){switch(r){case hr.nil:return 1;case hr.div0:return 2;case hr.value:return 3;case hr.ref:return 4;case hr.name:return 5;case hr.num:return 6;case hr.na:return 7;case hr.data:return 8}return hr.na};x.INFO=function(){throw new Error("INFO is not implemented")};x.ISBLANK=function(r){return r===null};x.ISBINARY=function(r){return/^[01]{1,10}$/.test(r)};x.ISERR=function(r){return[hr.value,hr.ref,hr.div0,hr.num,hr.name,hr.nil].indexOf(r)>=0||typeof r=="number"&&(isNaN(r)||!isFinite(r))};x.ISERROR=function(r){return x.ISERR(r)||r===hr.na};x.ISEVEN=function(r){return!(Math.floor(Math.abs(r))&1)};x.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")};x.ISLOGICAL=function(r){return r===!0||r===!1};x.ISNA=function(r){return r===hr.na};x.ISNONTEXT=function(r){return typeof r!="string"};x.ISNUMBER=function(r){return typeof r=="number"&&!isNaN(r)&&isFinite(r)};x.ISODD=function(r){return!!(Math.floor(Math.abs(r))&1)};x.ISREF=function(){throw new Error("ISREF is not implemented")};x.ISTEXT=function(r){return typeof r=="string"};x.N=function(r){return this.ISNUMBER(r)?r:r instanceof Date?r.getTime():r===!0?1:r===!1?0:this.ISERROR(r)?r:0};x.NA=function(){return hr.na};x.SHEET=function(){throw new Error("SHEET is not implemented")};x.SHEETS=function(){throw new Error("SHEETS is not implemented")};x.TYPE=function(r){if(this.ISNUMBER(r))return 1;if(this.ISTEXT(r))return 2;if(this.ISLOGICAL(r))return 4;if(this.ISERROR(r))return 16;if(Array.isArray(r))return 64}});var he=vr(D=>{var T=Hr(),S=wr(),K=Ne(),Pt=Ge(),_r=qe();D.ABS=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.abs(r);return e};D.ACOS=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.acos(r);return isNaN(e)&&(e=S.num),e};D.ACOSH=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.log(r+Math.sqrt(r*r-1));return isNaN(e)&&(e=S.num),e};D.ACOT=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.atan(1/r);return e};D.ACOTH=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=.5*Math.log((r+1)/(r-1));return isNaN(e)&&(e=S.num),e};D.AGGREGATE=function(r,e,n,a){if(r=T.parseNumber(r),e=T.parseNumber(r),T.anyIsError(r,e))return S.value;switch(r){case 1:return K.AVERAGE(n);case 2:return K.COUNT(n);case 3:return K.COUNTA(n);case 4:return K.MAX(n);case 5:return K.MIN(n);case 6:return D.PRODUCT(n);case 7:return K.STDEV.S(n);case 8:return K.STDEV.P(n);case 9:return D.SUM(n);case 10:return K.VAR.S(n);case 11:return K.VAR.P(n);case 12:return K.MEDIAN(n);case 13:return K.MODE.SNGL(n);case 14:return K.LARGE(n,a);case 15:return K.SMALL(n,a);case 16:return K.PERCENTILE.INC(n,a);case 17:return K.QUARTILE.INC(n,a);case 18:return K.PERCENTILE.EXC(n,a);case 19:return K.QUARTILE.EXC(n,a)}};D.ARABIC=function(r){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))return S.value;var e=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(n){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),e};D.ASIN=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.asin(r);return isNaN(e)&&(e=S.num),e};D.ASINH=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.log(r+Math.sqrt(r*r+1))};D.ATAN=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.atan(r)};D.ATAN2=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:Math.atan2(r,e)};D.ATANH=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.log((1+r)/(1-r))/2;return isNaN(e)&&(e=S.num),e};D.BASE=function(r,e,n){if(n=n||0,r=T.parseNumber(r),e=T.parseNumber(e),n=T.parseNumber(n),T.anyIsError(r,e,n))return S.value;n=n===void 0?0:n;var a=r.toString(e);return new Array(Math.max(n+1-a.length,0)).join("0")+a};D.CEILING=function(r,e,n){if(e=e===void 0?1:Math.abs(e),n=n||0,r=T.parseNumber(r),e=T.parseNumber(e),n=T.parseNumber(n),T.anyIsError(r,e,n))return S.value;if(e===0)return 0;var a=-Math.floor(Math.log(e)/Math.log(10));return r>=0?D.ROUND(Math.ceil(r/e)*e,a):n===0?-D.ROUND(Math.floor(Math.abs(r)/e)*e,a):-D.ROUND(Math.ceil(Math.abs(r)/e)*e,a)};D.CEILING.MATH=D.CEILING;D.CEILING.PRECISE=D.CEILING;D.COMBIN=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:D.FACT(r)/(D.FACT(e)*D.FACT(r-e))};D.COMBINA=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:r===0&&e===0?1:D.COMBIN(r+e-1,r-1)};D.COS=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.cos(r)};D.COSH=function(r){return r=T.parseNumber(r),r instanceof Error?r:(Math.exp(r)+Math.exp(-r))/2};D.COT=function(r){return r=T.parseNumber(r),r instanceof Error?r:1/Math.tan(r)};D.COTH=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e+1)/(e-1)};D.CSC=function(r){return r=T.parseNumber(r),r instanceof Error?r:1/Math.sin(r)};D.CSCH=function(r){return r=T.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)-Math.exp(-r))};D.DECIMAL=function(r,e){return arguments.length<1?S.value:parseInt(r,e)};D.DEGREES=function(r){return r=T.parseNumber(r),r instanceof Error?r:r*180/Math.PI};D.EVEN=function(r){return r=T.parseNumber(r),r instanceof Error?r:D.CEILING(r,-2,-1)};D.EXP=function(r){return arguments.length<1?S.na:typeof r!="number"||arguments.length>1?S.error:(r=Math.exp(r),r)};var Be=[];D.FACT=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.floor(r);return e===0||e===1?1:(Be[e]>0||(Be[e]=D.FACT(e-1)*e),Be[e])};D.FACTDOUBLE=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.floor(r);return e<=0?1:e*D.FACTDOUBLE(e-2)};D.FLOOR=function(r,e){if(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e))return S.value;if(e===0)return 0;if(!(r>0&&e>0)&&!(r<0&&e<0))return S.num;e=Math.abs(e);var n=-Math.floor(Math.log(e)/Math.log(10));return r>=0?D.ROUND(Math.floor(r/e)*e,n):-D.ROUND(Math.ceil(Math.abs(r)/e),n)};D.FLOOR.MATH=function(r,e,n){if(e=e===void 0?1:e,n=n===void 0?0:n,r=T.parseNumber(r),e=T.parseNumber(e),n=T.parseNumber(n),T.anyIsError(r,e,n))return S.value;if(e===0)return 0;e=e?Math.abs(e):1;var a=-Math.floor(Math.log(e)/Math.log(10));return r>=0?D.ROUND(Math.floor(r/e)*e,a):n===0||n===void 0?-D.ROUND(Math.ceil(Math.abs(r)/e)*e,a):-D.ROUND(Math.floor(Math.abs(r)/e)*e,a)};D.FLOOR.PRECISE=D.FLOOR.MATH;D.GCD=function(){var r=T.parseNumberArray(T.flatten(arguments));if(r instanceof Error)return r;for(var e=r.length,n=r[0],a=n<0?-n:n,o=1;o<e;o++){for(var l=r[o],c=l<0?-l:l;a&&c;)a>c?a%=c:c%=a;a+=c}return a};D.INT=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.floor(r)};D.ISO={CEILING:D.CEILING};D.LCM=function(){var r=T.parseNumberArray(T.flatten(arguments));if(r instanceof Error)return r;for(var e,n,a,o,l=1;(a=r.pop())!==void 0;)for(;a>1;){if(a%2){for(e=3,n=Math.floor(Math.sqrt(a));e<=n&&a%e;e+=2);o=e<=n?e:a}else o=2;for(a/=o,l*=o,e=r.length;e;r[--e]%o===0&&(r[e]/=o)===1&&r.splice(e,1));}return l};D.LN=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.log(r)};D.LN10=function(){return Math.log(10)};D.LN2=function(){return Math.log(2)};D.LOG10E=function(){return Math.LOG10E};D.LOG2E=function(){return Math.LOG2E};D.LOG=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:(e=e===void 0?10:e,Math.log(r)/Math.log(e))};D.LOG10=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.log(r)/Math.log(10)};D.MOD=function(r,e){if(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e))return S.value;if(e===0)return S.div0;var n=Math.abs(r%e);return e>0?n:-n};D.MROUND=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:r*e<0?S.num:Math.round(r/e)*e};D.MULTINOMIAL=function(){var r=T.parseNumberArray(T.flatten(arguments));if(r instanceof Error)return r;for(var e=0,n=1,a=0;a<r.length;a++)e+=r[a],n*=D.FACT(r[a]);return D.FACT(e)/n};D.ODD=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.ceil(Math.abs(r));return e=e&1?e:e+1,r>0?e:-e};D.PI=function(){return Math.PI};D.E=function(){return Math.E};D.POWER=function(r,e){if(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e))return S.value;var n=Math.pow(r,e);return isNaN(n)?S.num:n};D.PRODUCT=function(){var r=T.parseNumberArray(T.flatten(arguments));if(r instanceof Error)return r;for(var e=1,n=0;n<r.length;n++)e*=r[n];return e};D.QUOTIENT=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:parseInt(r/e,10)};D.RADIANS=function(r){return r=T.parseNumber(r),r instanceof Error?r:r*Math.PI/180};D.RAND=function(){return Math.random()};D.RANDBETWEEN=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:r+Math.ceil((e-r+1)*Math.random())-1};D.ROMAN=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;for(var e=String(r).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],a="",o=3;o--;)a=(n[+e.pop()+o*10]||"")+a;return new Array(+e.join("")+1).join("M")+a};D.ROUND=function(r,e){return r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:Math.round(r*Math.pow(10,e))/Math.pow(10,e)};D.ROUNDDOWN=function(r,e){if(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e))return S.value;var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)};D.ROUNDUP=function(r,e){if(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e))return S.value;var n=r>0?1:-1;return n*Math.ceil(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)};D.SEC=function(r){return r=T.parseNumber(r),r instanceof Error?r:1/Math.cos(r)};D.SECH=function(r){return r=T.parseNumber(r),r instanceof Error?r:2/(Math.exp(r)+Math.exp(-r))};D.SERIESSUM=function(r,e,n,a){if(r=T.parseNumber(r),e=T.parseNumber(e),n=T.parseNumber(n),a=T.parseNumberArray(a),T.anyIsError(r,e,n,a))return S.value;for(var o=a[0]*Math.pow(r,e),l=1;l<a.length;l++)o+=a[l]*Math.pow(r,e+l*n);return o};D.SIGN=function(r){return r=T.parseNumber(r),r instanceof Error?r:r<0?-1:r===0?0:1};D.SIN=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.sin(r)};D.SINH=function(r){return r=T.parseNumber(r),r instanceof Error?r:(Math.exp(r)-Math.exp(-r))/2};D.SQRT=function(r){return r=T.parseNumber(r),r instanceof Error?r:r<0?S.num:Math.sqrt(r)};D.SQRTPI=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.sqrt(r*Math.PI)};D.SQRT1_2=function(){return 1/Math.sqrt(2)};D.SQRT2=function(){return Math.sqrt(2)};D.SUBTOTAL=function(r,e){if(r=T.parseNumber(r),r instanceof Error)return r;switch(r){case 1:return K.AVERAGE(e);case 2:return K.COUNT(e);case 3:return K.COUNTA(e);case 4:return K.MAX(e);case 5:return K.MIN(e);case 6:return D.PRODUCT(e);case 7:return K.STDEV.S(e);case 8:return K.STDEV.P(e);case 9:return D.SUM(e);case 10:return K.VAR.S(e);case 11:return K.VAR.P(e);case 101:return K.AVERAGE(e);case 102:return K.COUNT(e);case 103:return K.COUNTA(e);case 104:return K.MAX(e);case 105:return K.MIN(e);case 106:return D.PRODUCT(e);case 107:return K.STDEV.S(e);case 108:return K.STDEV.P(e);case 109:return D.SUM(e);case 110:return K.VAR.S(e);case 111:return K.VAR.P(e)}};D.ADD=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:r+e)};D.MINUS=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:r-e)};D.DIVIDE=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:e===0?S.div0:r/e)};D.MULTIPLY=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.value:r*e)};D.GTE=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.error:r>=e)};D.LT=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.error:r<e)};D.LTE=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.error:r<=e)};D.EQ=function(r,e){return arguments.length!==2?S.na:r===e};D.NE=function(r,e){return arguments.length!==2?S.na:r!==e};D.POW=function(r,e){return arguments.length!==2?S.na:(r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e)?S.error:D.POWER(r,e))};D.SUM=function(){var r=0;return T.arrayEach(T.argsToArray(arguments),function(e){if(typeof e=="number")r+=e;else if(typeof e=="string"){var n=parseFloat(e);!isNaN(n)&&(r+=n)}else Array.isArray(e)&&(r+=D.SUM.apply(null,e))}),r};D.SUMIF=function(r,e){if(r=T.parseNumberArray(T.flatten(r)),r instanceof Error)return r;for(var n=0,a=e===void 0||e==="*",o=a?null:_r.parse(e+""),l=0;l<r.length;l++){var c=r[l];if(a)n+=c;else{var i=[_r.createToken(c,_r.TOKEN_TYPE_LITERAL)].concat(o);n+=_r.compute(i)?c:0}}return n};D.SUMIFS=function(){var r=T.argsToArray(arguments),e=T.parseNumberArray(T.flatten(r.shift()));if(e instanceof Error)return e;for(var n=r,a=e.length,o=n.length,l=0,c=0;c<a;c++){for(var i=e[c],t=!1,u=0;u<o;u++){var f=n[u],s=f===void 0||f==="*",v=!1;if(s)v=!0;else{var E=_r.parse(f+""),p=[_r.createToken(i,_r.TOKEN_TYPE_LITERAL)].concat(E);v=_r.compute(p)}if(!v){t=!1;break}t=!0}t&&(l+=i)}return l};D.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return S.value;for(var r=arguments.length+1,e=0,n,a,o,l,c=0;c<arguments[0].length;c++)if(arguments[0][c]instanceof Array)for(var i=0;i<arguments[0][c].length;i++){for(n=1,a=1;a<r;a++){if(l=T.parseNumber(arguments[a-1][c][i]),l instanceof Error)return l;n*=l}e+=n}else{for(n=1,a=1;a<r;a++){if(o=T.parseNumber(arguments[a-1][c]),o instanceof Error)return o;n*=o}e+=n}return e};D.SUMSQ=function(){var r=T.parseNumberArray(T.flatten(arguments));if(r instanceof Error)return r;for(var e=0,n=r.length,a=0;a<n;a++)e+=Pt.ISNUMBER(r[a])?r[a]*r[a]:0;return e};D.SUMX2MY2=function(r,e){if(r=T.parseNumberArray(T.flatten(r)),e=T.parseNumberArray(T.flatten(e)),T.anyIsError(r,e))return S.value;for(var n=0,a=0;a<r.length;a++)n+=r[a]*r[a]-e[a]*e[a];return n};D.SUMX2PY2=function(r,e){if(r=T.parseNumberArray(T.flatten(r)),e=T.parseNumberArray(T.flatten(e)),T.anyIsError(r,e))return S.value;var n=0;r=T.parseNumberArray(T.flatten(r)),e=T.parseNumberArray(T.flatten(e));for(var a=0;a<r.length;a++)n+=r[a]*r[a]+e[a]*e[a];return n};D.SUMXMY2=function(r,e){if(r=T.parseNumberArray(T.flatten(r)),e=T.parseNumberArray(T.flatten(e)),T.anyIsError(r,e))return S.value;var n=0;r=T.flatten(r),e=T.flatten(e);for(var a=0;a<r.length;a++)n+=Math.pow(r[a]-e[a],2);return n};D.TAN=function(r){return r=T.parseNumber(r),r instanceof Error?r:Math.tan(r)};D.TANH=function(r){if(r=T.parseNumber(r),r instanceof Error)return r;var e=Math.exp(2*r);return(e-1)/(e+1)};D.TRUNC=function(r,e){if(e=e===void 0?0:e,r=T.parseNumber(r),e=T.parseNumber(e),T.anyIsError(r,e))return S.value;var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,e))/Math.pow(10,e)}});var Bn=vr(fn=>{var Gn;(function(r){typeof DO_NOT_EXPORT_BESSEL>"u"?typeof fn=="object"?r(fn):typeof define=="function"&&define.amd?define(function(){var e={};return r(e),e}):r(Gn={}):r(Gn={})})(function(r){r.version="1.0.2";var e=Math;function n(u,f){for(var s=0,v=0;s<u.length;++s)v=f*v+u[s];return v}function a(u,f,s,v,E){if(f===0)return s;if(f===1)return v;for(var p=2/u,g=v,h=1;h<f;++h)g=v*h*p+E*s,s=v,v=g;return g}function o(u,f,s,v,E){return function(g,h){if(v){if(g===0)return v==1?-1/0:1/0;if(g<0)return NaN}if(h===0)return u(g);if(h===1)return f(g);if(h<0)return NaN;h|=0;var N=u(g),m=f(g);return a(g,h,N,m,E)}}var l=function(){var u=.636619772,f=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),s=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),v=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),E=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function p(R){var y=0,C=0,V=0,P=R*R;if(R<8)C=n(f,P),V=n(s,P),y=C/V;else{var Y=R-.785398164;P=64/P,C=n(v,P),V=n(E,P),y=e.sqrt(u/R)*(e.cos(Y)*C-e.sin(Y)*V*8/R)}return y}var g=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),h=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),N=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function A(R){var y=0,C=0,V=0,P=R*R,Y=e.abs(R)-2.356194491;return Math.abs(R)<8?(C=R*n(g,P),V=n(h,P),y=C/V):(P=64/P,C=n(N,P),V=n(m,P),y=e.sqrt(u/e.abs(R))*(e.cos(Y)*C-e.sin(Y)*V*8/e.abs(R)),R<0&&(y=-y)),y}return function R(y,C){if(C=Math.round(C),!isFinite(y))return isNaN(y)?y:0;if(C<0)return(C%2?-1:1)*R(y,-C);if(y<0)return(C%2?-1:1)*R(-y,C);if(C===0)return p(y);if(C===1)return A(y);if(y===0)return 0;var V=0;if(y>C)V=a(y,C,p(y),A(y),-1);else{for(var P=2*e.floor((C+e.floor(e.sqrt(40*C)))/2),Y=!1,Ir=0,z=0,W=1,Ar=0,pr=2/y,j=P;j>0;j--)Ar=j*pr*W-Ir,Ir=W,W=Ar,e.abs(W)>1e10&&(W*=1e-10,Ir*=1e-10,V*=1e-10,z*=1e-10),Y&&(z+=W),Y=!Y,j==C&&(V=Ir);z=2*z-W,V/=z}return V}}(),c=function(){var u=.636619772,f=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),s=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),v=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),E=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function p(R){var y=0,C=0,V=0,P=R*R,Y=R-.785398164;return R<8?(C=n(f,P),V=n(s,P),y=C/V+u*l(R,0)*e.log(R)):(P=64/P,C=n(v,P),V=n(E,P),y=e.sqrt(u/R)*(e.sin(Y)*C+e.cos(Y)*V*8/R)),y}var g=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),h=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),N=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function A(R){var y=0,C=0,V=0,P=R*R,Y=R-2.356194491;return R<8?(C=R*n(g,P),V=n(h,P),y=C/V+u*(l(R,1)*e.log(R)-1/R)):(P=64/P,C=n(N,P),V=n(m,P),y=e.sqrt(u/R)*(e.sin(Y)*C+e.cos(Y)*V*8/R)),y}return o(p,A,"BESSELY",1,-1)}(),i=function(){var u=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),f=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function s(g){return g<=3.75?n(u,g*g/(3.75*3.75)):e.exp(e.abs(g))/e.sqrt(e.abs(g))*n(f,3.75/e.abs(g))}var v=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),E=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function p(g){return g<3.75?g*n(v,g*g/(3.75*3.75)):(g<0?-1:1)*e.exp(e.abs(g))/e.sqrt(e.abs(g))*n(E,3.75/e.abs(g))}return function g(h,N){if(N=Math.round(N),N===0)return s(h);if(N===1)return p(h);if(N<0)return NaN;if(e.abs(h)===0)return 0;if(h==1/0)return 1/0;var m=0,A,R=2/e.abs(h),y=0,C=1,V=0,P=2*e.round((N+e.round(e.sqrt(40*N)))/2);for(A=P;A>0;A--)V=A*R*C+y,y=C,C=V,e.abs(C)>1e10&&(C*=1e-10,y*=1e-10,m*=1e-10),A==N&&(m=y);return m*=g(h,0)/C,h<0&&N%2?-m:m}}(),t=function(){var u=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),f=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function s(g){return g<=2?-e.log(g/2)*i(g,0)+n(u,g*g/4):e.exp(-g)/e.sqrt(g)*n(f,2/g)}var v=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),E=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function p(g){return g<=2?e.log(g/2)*i(g,1)+1/g*n(v,g*g/4):e.exp(-g)/e.sqrt(g)*n(E,2/g)}return o(s,p,"BESSELK",2,1)}();r.besselj=l,r.bessely=c,r.besseli=i,r.besselk=t})});var ln=vr(L=>{var d=wr(),Yn=un(),Ur=Ue(),G=Hr(),Ye=Bn();function sn(r){return/^[01]{1,10}$/.test(r)}L.BESSELI=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:Ye.besseli(r,e)};L.BESSELJ=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:Ye.besselj(r,e)};L.BESSELK=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:Ye.besselk(r,e)};L.BESSELY=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:Ye.bessely(r,e)};L.BIN2DEC=function(r){if(!sn(r))return d.num;var e=parseInt(r,2),n=r.toString();return n.length===10&&n.substring(0,1)==="1"?parseInt(n.substring(1),2)-512:e};L.BIN2HEX=function(r,e){if(!sn(r))return d.num;var n=r.toString();if(n.length===10&&n.substring(0,1)==="1")return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var a=parseInt(r,2).toString(16);return e===void 0?a:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=a.length?Ur.REPT("0",e-a.length)+a:d.num)};L.BIN2OCT=function(r,e){if(!sn(r))return d.num;var n=r.toString();if(n.length===10&&n.substring(0,1)==="1")return(1073741312+parseInt(n.substring(1),2)).toString(8);var a=parseInt(r,2).toString(8);return e===void 0?a:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=a.length?Ur.REPT("0",e-a.length)+a:d.num)};L.BITAND=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:r<0||e<0||Math.floor(r)!==r||Math.floor(e)!==e||r>0xffffffffffff||e>0xffffffffffff?d.num:r&e};L.BITLSHIFT=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:r<0||Math.floor(r)!==r||r>0xffffffffffff||Math.abs(e)>53?d.num:e>=0?r<<e:r>>-e};L.BITOR=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:r<0||e<0||Math.floor(r)!==r||Math.floor(e)!==e||r>0xffffffffffff||e>0xffffffffffff?d.num:r|e};L.BITRSHIFT=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:r<0||Math.floor(r)!==r||r>0xffffffffffff||Math.abs(e)>53?d.num:e>=0?r>>e:r<<-e};L.BITXOR=function(r,e){return r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:r<0||e<0||Math.floor(r)!==r||Math.floor(e)!==e||r>0xffffffffffff||e>0xffffffffffff?d.num:r^e};L.COMPLEX=function(r,e,n){if(r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e))return r;if(n=n===void 0?"i":n,n!=="i"&&n!=="j")return d.value;if(r===0&&e===0)return 0;if(r===0)return e===1?n:e.toString()+n;if(e===0)return r.toString();var a=e>0?"+":"";return r.toString()+a+(e===1?n:e.toString()+n)};L.CONVERT=function(r,e,n){if(r=G.parseNumber(r),r instanceof Error)return r;for(var a=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],o={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},c=null,i=null,t=e,u=n,f=1,s=1,v,E=0;E<a.length;E++)v=a[E][2]===null?[]:a[E][2],(a[E][1]===t||v.indexOf(t)>=0)&&(c=a[E]),(a[E][1]===u||v.indexOf(u)>=0)&&(i=a[E]);if(c===null){var p=o[e.substring(0,2)],g=l[e.substring(0,1)];e.substring(0,2)==="da"&&(g=["dekao",10,"da"]),p?(f=p[2],t=e.substring(2)):g&&(f=g[1],t=e.substring(g[2].length));for(var h=0;h<a.length;h++)v=a[h][2]===null?[]:a[h][2],(a[h][1]===t||v.indexOf(t)>=0)&&(c=a[h])}if(i===null){var N=o[n.substring(0,2)],m=l[n.substring(0,1)];n.substring(0,2)==="da"&&(m=["dekao",10,"da"]),N?(s=N[2],u=n.substring(2)):m&&(s=m[1],u=n.substring(m[2].length));for(var A=0;A<a.length;A++)v=a[A][2]===null?[]:a[A][2],(a[A][1]===u||v.indexOf(u)>=0)&&(i=a[A])}return c===null||i===null||c[3]!==i[3]?d.na:r*c[6]*f/(i[6]*s)};L.DEC2BIN=function(r,e){if(r=G.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,3}$/.test(r)||r<-512||r>511)return d.num;if(r<0)return"1"+Ur.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var n=parseInt(r,10).toString(2);return typeof e>"u"?n:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=n.length?Ur.REPT("0",e-n.length)+n:d.num)};L.DEC2HEX=function(r,e){if(r=G.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,12}$/.test(r)||r<-549755813888||r>549755813887)return d.num;if(r<0)return(1099511627776+r).toString(16);var n=parseInt(r,10).toString(16);return typeof e>"u"?n:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=n.length?Ur.REPT("0",e-n.length)+n:d.num)};L.DEC2OCT=function(r,e){if(r=G.parseNumber(r),r instanceof Error)return r;if(!/^-?[0-9]{1,9}$/.test(r)||r<-536870912||r>536870911)return d.num;if(r<0)return(1073741824+r).toString(8);var n=parseInt(r,10).toString(8);return typeof e>"u"?n:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=n.length?Ur.REPT("0",e-n.length)+n:d.num)};L.DELTA=function(r,e){return e=e===void 0?0:e,r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:r===e?1:0};L.ERF=function(r,e){return e=e===void 0?0:e,r=G.parseNumber(r),e=G.parseNumber(e),G.anyIsError(r,e)?d.value:Yn.erf(r)};L.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")};L.ERFC=function(r){return isNaN(r)?d.value:Yn.erfc(r)};L.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")};L.GESTEP=function(r,e){return e=e||0,r=G.parseNumber(r),G.anyIsError(e,r)?r:r>=e?1:0};L.HEX2BIN=function(r,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return d.num;var n=r.length===10&&r.substring(0,1).toLowerCase()==="f",a=n?parseInt(r,16)-1099511627776:parseInt(r,16);if(a<-512||a>511)return d.num;if(n)return"1"+Ur.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);var o=a.toString(2);return e===void 0?o:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=o.length?Ur.REPT("0",e-o.length)+o:d.num)};L.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return d.num;var e=parseInt(r,16);return e>=549755813888?e-1099511627776:e};L.HEX2OCT=function(r,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return d.num;var n=parseInt(r,16);if(n>536870911&&n<0xffe0000000)return d.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var a=n.toString(8);return e===void 0?a:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=a.length?Ur.REPT("0",e-a.length)+a:d.num)};L.IMABS=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.value:Math.sqrt(Math.pow(e,2)+Math.pow(n,2))};L.IMAGINARY=function(r){if(r===void 0||r===!0||r===!1)return d.value;if(r===0||r==="0")return 0;if(["i","j"].indexOf(r)>=0)return 1;r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var e=r.indexOf("+"),n=r.indexOf("-");e===0&&(e=r.indexOf("+",1)),n===0&&(n=r.indexOf("-",1));var a=r.substring(r.length-1,r.length),o=a==="i"||a==="j";return e>=0||n>=0?o?e>=0?isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?d.num:Number(r.substring(e+1,r.length-1)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?d.num:-Number(r.substring(n+1,r.length-1)):d.num:o?isNaN(r.substring(0,r.length-1))?d.num:r.substring(0,r.length-1):isNaN(r)?d.num:0};L.IMARGUMENT=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.value:e===0&&n===0?d.div0:e===0&&n>0?Math.PI/2:e===0&&n<0?-Math.PI/2:n===0&&e>0?0:n===0&&e<0?-Math.PI:e>0?Math.atan(n/e):e<0&&n>=0?Math.atan(n/e)+Math.PI:Math.atan(n/e)-Math.PI};L.IMCONJUGATE=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",n!==0?L.COMPLEX(e,-n,a):r};L.IMCOS=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",L.COMPLEX(Math.cos(e)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(e)*(Math.exp(n)-Math.exp(-n))/2,a)};L.IMCOSH=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",L.COMPLEX(Math.cos(n)*(Math.exp(e)+Math.exp(-e))/2,Math.sin(n)*(Math.exp(e)-Math.exp(-e))/2,a)};L.IMCOT=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.value:L.IMDIV(L.IMCOS(r),L.IMSIN(r))};L.IMDIV=function(r,e){var n=L.IMREAL(r),a=L.IMAGINARY(r),o=L.IMREAL(e),l=L.IMAGINARY(e);if(G.anyIsError(n,a,o,l))return d.value;var c=r.substring(r.length-1),i=e.substring(e.length-1),t="i";if((c==="j"||i==="j")&&(t="j"),o===0&&l===0)return d.num;var u=o*o+l*l;return L.COMPLEX((n*o+a*l)/u,(a*o-n*l)/u,t)};L.IMEXP=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);a=a==="i"||a==="j"?a:"i";var o=Math.exp(e);return L.COMPLEX(o*Math.cos(n),o*Math.sin(n),a)};L.IMLN=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",L.COMPLEX(Math.log(Math.sqrt(e*e+n*n)),Math.atan(n/e),a)};L.IMLOG10=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",L.COMPLEX(Math.log(Math.sqrt(e*e+n*n))/Math.log(10),Math.atan(n/e)/Math.log(10),a)};L.IMLOG2=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",L.COMPLEX(Math.log(Math.sqrt(e*e+n*n))/Math.log(2),Math.atan(n/e)/Math.log(2),a)};L.IMPOWER=function(r,e){e=G.parseNumber(e);var n=L.IMREAL(r),a=L.IMAGINARY(r);if(G.anyIsError(e,n,a))return d.value;var o=r.substring(r.length-1);o=o==="i"||o==="j"?o:"i";var l=Math.pow(L.IMABS(r),e),c=L.IMARGUMENT(r);return L.COMPLEX(l*Math.cos(e*c),l*Math.sin(e*c),o)};L.IMPRODUCT=function(){var r=arguments[0];if(!arguments.length)return d.value;for(var e=1;e<arguments.length;e++){var n=L.IMREAL(r),a=L.IMAGINARY(r),o=L.IMREAL(arguments[e]),l=L.IMAGINARY(arguments[e]);if(G.anyIsError(n,a,o,l))return d.value;r=L.COMPLEX(n*o-a*l,n*l+a*o)}return r};L.IMREAL=function(r){if(r===void 0||r===!0||r===!1)return d.value;if(r===0||r==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var e=r.indexOf("+"),n=r.indexOf("-");e===0&&(e=r.indexOf("+",1)),n===0&&(n=r.indexOf("-",1));var a=r.substring(r.length-1,r.length),o=a==="i"||a==="j";return e>=0||n>=0?o?e>=0?isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?d.num:Number(r.substring(0,e)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?d.num:Number(r.substring(0,n)):d.num:o?isNaN(r.substring(0,r.length-1))?d.num:0:isNaN(r)?d.num:r};L.IMSEC=function(r){if(r===!0||r===!1)return d.value;var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.value:L.IMDIV("1",L.IMCOS(r))};L.IMSECH=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.value:L.IMDIV("1",L.IMCOSH(r))};L.IMSIN=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",L.COMPLEX(Math.sin(e)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(e)*(Math.exp(n)-Math.exp(-n))/2,a)};L.IMSINH=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);return a=a==="i"||a==="j"?a:"i",L.COMPLEX(Math.cos(n)*(Math.exp(e)-Math.exp(-e))/2,Math.sin(n)*(Math.exp(e)+Math.exp(-e))/2,a)};L.IMSQRT=function(r){var e=L.IMREAL(r),n=L.IMAGINARY(r);if(G.anyIsError(e,n))return d.value;var a=r.substring(r.length-1);a=a==="i"||a==="j"?a:"i";var o=Math.sqrt(L.IMABS(r)),l=L.IMARGUMENT(r);return L.COMPLEX(o*Math.cos(l/2),o*Math.sin(l/2),a)};L.IMCSC=function(r){if(r===!0||r===!1)return d.value;var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.num:L.IMDIV("1",L.IMSIN(r))};L.IMCSCH=function(r){if(r===!0||r===!1)return d.value;var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.num:L.IMDIV("1",L.IMSINH(r))};L.IMSUB=function(r,e){var n=this.IMREAL(r),a=this.IMAGINARY(r),o=this.IMREAL(e),l=this.IMAGINARY(e);if(G.anyIsError(n,a,o,l))return d.value;var c=r.substring(r.length-1),i=e.substring(e.length-1),t="i";return(c==="j"||i==="j")&&(t="j"),this.COMPLEX(n-o,a-l,t)};L.IMSUM=function(){if(!arguments.length)return d.value;for(var r=G.flatten(arguments),e=r[0],n=1;n<r.length;n++){var a=this.IMREAL(e),o=this.IMAGINARY(e),l=this.IMREAL(r[n]),c=this.IMAGINARY(r[n]);if(G.anyIsError(a,o,l,c))return d.value;e=this.COMPLEX(a+l,o+c)}return e};L.IMTAN=function(r){if(r===!0||r===!1)return d.value;var e=L.IMREAL(r),n=L.IMAGINARY(r);return G.anyIsError(e,n)?d.value:this.IMDIV(this.IMSIN(r),this.IMCOS(r))};L.OCT2BIN=function(r,e){if(!/^[0-7]{1,10}$/.test(r))return d.num;var n=r.length===10&&r.substring(0,1)==="7",a=n?parseInt(r,8)-1073741824:parseInt(r,8);if(a<-512||a>511)return d.num;if(n)return"1"+Ur.REPT("0",9-(512+a).toString(2).length)+(512+a).toString(2);var o=a.toString(2);return typeof e>"u"?o:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=o.length?Ur.REPT("0",e-o.length)+o:d.num)};L.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return d.num;var e=parseInt(r,8);return e>=536870912?e-1073741824:e};L.OCT2HEX=function(r,e){if(!/^[0-7]{1,10}$/.test(r))return d.num;var n=parseInt(r,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var a=n.toString(16);return e===void 0?a:isNaN(e)?d.value:e<0?d.num:(e=Math.floor(e),e>=a.length?Ur.REPT("0",e-a.length)+a:d.num)}});var Xe=vr(Z=>{var Fr=wr(),Q=Hr(),Sn=new Date(Date.UTC(1900,0,1)),Vt=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Ut=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],He=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];Z.DATE=function(r,e,n){var a;return r=Q.parseNumber(r),e=Q.parseNumber(e),n=Q.parseNumber(n),Q.anyIsError(r,e,n)?a=Fr.value:r<0||e<0||n<0?a=Fr.num:a=new Date(r,e-1,n),a};Z.DATEVALUE=function(r){var e=2,n;return typeof r!="string"||(n=Date.parse(r),isNaN(n))?Fr.value:(n<=-22038912e5&&(e=1),Math.ceil((n-Sn)/864e5)+e)};Z.DAY=function(r){var e=Q.parseDate(r);return e instanceof Error?e:e.getDate()};Z.DAYS=function(r,e){return r=Q.parseDate(r),e=Q.parseDate(e),r instanceof Error?r:e instanceof Error?e:ke(r)-ke(e)};Z.DAYS360=function(r,e,n){if(n=Q.parseBool(n),r=Q.parseDate(r),e=Q.parseDate(e),r instanceof Error)return r;if(e instanceof Error)return e;if(n instanceof Error)return n;var a=r.getMonth(),o=e.getMonth(),l,c;if(n)l=r.getDate()===31?30:r.getDate(),c=e.getDate()===31?30:e.getDate();else{var i=new Date(r.getFullYear(),a+1,0).getDate(),t=new Date(e.getFullYear(),o+1,0).getDate();l=r.getDate()===i?30:r.getDate(),e.getDate()===t?l<30?(o++,c=1):c=30:c=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(o-a)+(c-l)};Z.EDATE=function(r,e){return r=Q.parseDate(r),r instanceof Error?r:isNaN(e)?Fr.value:(e=parseInt(e,10),r.setMonth(r.getMonth()+e),ke(r))};Z.EOMONTH=function(r,e){return r=Q.parseDate(r),r instanceof Error?r:isNaN(e)?Fr.value:(e=parseInt(e,10),ke(new Date(r.getFullYear(),r.getMonth()+e+1,0)))};Z.HOUR=function(r){return r=Q.parseDate(r),r instanceof Error?r:r.getHours()};Z.INTERVAL=function(r){if(typeof r!="number"&&typeof r!="string")return Fr.value;r=parseInt(r,10);var e=Math.floor(r/94608e4);r=r%94608e4;var n=Math.floor(r/2592e3);r=r%2592e3;var a=Math.floor(r/86400);r=r%86400;var o=Math.floor(r/3600);r=r%3600;var l=Math.floor(r/60);r=r%60;var c=r;return e=e>0?e+"Y":"",n=n>0?n+"M":"",a=a>0?a+"D":"",o=o>0?o+"H":"",l=l>0?l+"M":"",c=c>0?c+"S":"","P"+e+n+a+"T"+o+l+c};Z.ISOWEEKNUM=function(r){if(r=Q.parseDate(r),r instanceof Error)return r;r.setHours(0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var e=new Date(r.getFullYear(),0,1);return Math.ceil(((r-e)/864e5+1)/7)};Z.MINUTE=function(r){return r=Q.parseDate(r),r instanceof Error?r:r.getMinutes()};Z.MONTH=function(r){return r=Q.parseDate(r),r instanceof Error?r:r.getMonth()+1};Z.NETWORKDAYS=function(r,e,n){return this.NETWORKDAYS.INTL(r,e,1,n)};Z.NETWORKDAYS.INTL=function(r,e,n,a){if(r=Q.parseDate(r),r instanceof Error)return r;if(e=Q.parseDate(e),e instanceof Error)return e;if(n===void 0?n=He[1]:n=He[n],!(n instanceof Array))return Fr.value;a===void 0?a=[]:a instanceof Array||(a=[a]);for(var o=0;o<a.length;o++){var l=Q.parseDate(a[o]);if(l instanceof Error)return l;a[o]=l}var c=(e-r)/(1e3*60*60*24)+1,i=c,t=r;for(o=0;o<c;o++){var u=new Date().getTimezoneOffset()>0?t.getUTCDay():t.getDay(),f=!1;(u===n[0]||u===n[1])&&(f=!0);for(var s=0;s<a.length;s++){var v=a[s];if(v.getDate()===t.getDate()&&v.getMonth()===t.getMonth()&&v.getFullYear()===t.getFullYear()){f=!0;break}}f&&i--,t.setDate(t.getDate()+1)}return i};Z.NOW=function(){return new Date};Z.SECOND=function(r){return r=Q.parseDate(r),r instanceof Error?r:r.getSeconds()};Z.TIME=function(r,e,n){return r=Q.parseNumber(r),e=Q.parseNumber(e),n=Q.parseNumber(n),Q.anyIsError(r,e,n)?Fr.value:r<0||e<0||n<0?Fr.num:(3600*r+60*e+n)/86400};Z.TIMEVALUE=function(r){return r=Q.parseDate(r),r instanceof Error?r:(3600*r.getHours()+60*r.getMinutes()+r.getSeconds())/86400};Z.TODAY=function(){return new Date};Z.WEEKDAY=function(r,e){if(r=Q.parseDate(r),r instanceof Error)return r;e===void 0&&(e=1);var n=r.getDay();return Ut[e][n]};Z.WEEKNUM=function(r,e){if(r=Q.parseDate(r),r instanceof Error)return r;if(e===void 0&&(e=1),e===21)return this.ISOWEEKNUM(r);var n=Vt[e],a=new Date(r.getFullYear(),0,1),o=a.getDay()<n?1:0;return a-=Math.abs(a.getDay()-n)*24*60*60*1e3,Math.floor((r-a)/(1e3*60*60*24)/7+1)+o};Z.WORKDAY=function(r,e,n){return this.WORKDAY.INTL(r,e,1,n)};Z.WORKDAY.INTL=function(r,e,n,a){if(r=Q.parseDate(r),r instanceof Error)return r;if(e=Q.parseNumber(e),e instanceof Error)return e;if(e<0)return Fr.num;if(n===void 0?n=He[1]:n=He[n],!(n instanceof Array))return Fr.value;a===void 0?a=[]:a instanceof Array||(a=[a]);for(var o=0;o<a.length;o++){var l=Q.parseDate(a[o]);if(l instanceof Error)return l;a[o]=l}for(var c=0;c<e;){r.setDate(r.getDate()+1);var i=r.getDay();if(!(i===n[0]||i===n[1])){for(var t=0;t<a.length;t++){var u=a[t];if(u.getDate()===r.getDate()&&u.getMonth()===r.getMonth()&&u.getFullYear()===r.getFullYear()){c--;break}}c++}}return r};Z.YEAR=function(r){return r=Q.parseDate(r),r instanceof Error?r:r.getFullYear()};function cn(r){return new Date(r,1,29).getMonth()===1}function Se(r,e){return Math.ceil((e-r)/1e3/60/60/24)}Z.YEARFRAC=function(r,e,n){if(r=Q.parseDate(r),r instanceof Error)return r;if(e=Q.parseDate(e),e instanceof Error)return e;n=n||0;var a=r.getDate(),o=r.getMonth()+1,l=r.getFullYear(),c=e.getDate(),i=e.getMonth()+1,t=e.getFullYear();switch(n){case 0:return a===31&&c===31?(a=30,c=30):a===31?a=30:a===30&&c===31&&(c=30),(c+i*30+t*360-(a+o*30+l*360))/360;case 1:var u=function(p,g){var h=p.getFullYear(),N=new Date(h,2,1);if(cn(h)&&p<N&&g>=N)return!0;var m=g.getFullYear(),A=new Date(m,2,1);return cn(m)&&g>=A&&p<A},f=365;if(l===t||l+1===t&&(o>i||o===i&&a>=c))return(l===t&&cn(l)||u(r,e)||i===1&&c===29)&&(f=366),Se(r,e)/f;var s=t-l+1,v=(new Date(t+1,0,1)-new Date(l,0,1))/1e3/60/60/24,E=v/s;return Se(r,e)/E;case 2:return Se(r,e)/360;case 3:return Se(r,e)/365;case 4:return(c+i*30+t*360-(a+o*30+l*360))/360}};function ke(r){var e=r>-22038912e5?2:1;return Math.ceil((r-Sn)/864e5)+e}});var Xn=vr(F=>{var xr=he(),b=Ne(),Hn=ln(),kn=Xe();function br(r,e){if(e)for(var n in e)r[n]=e[n];return r}F.BETADIST=b.BETA.DIST;F.BETAINV=b.BETA.INV;F.BINOMDIST=b.BINOM.DIST;F.CEILING=F.ISOCEILING=br(xr.CEILING.MATH,xr.CEILING);F.CEILINGMATH=xr.CEILING.MATH;F.CEILINGPRECISE=xr.CEILING.PRECISE;F.CHIDIST=b.CHISQ.DIST;F.CHIDISTRT=b.CHISQ.DIST.RT;F.CHIINV=b.CHISQ.INV;F.CHIINVRT=b.CHISQ.INV.RT;F.CHITEST=b.CHISQ.TEST;F.CONFIDENCE=br(b.CONFIDENCE.NORM,b.CONFIDENCE);F.COVAR=b.COVARIANCE.P;F.COVARIANCEP=b.COVARIANCE.P;F.COVARIANCES=b.COVARIANCE.S;F.CRITBINOM=b.BINOM.INV;F.EXPONDIST=b.EXPON.DIST;F.ERFCPRECISE=Hn.ERFC.PRECISE;F.ERFPRECISE=Hn.ERF.PRECISE;F.FDIST=b.F.DIST;F.FDISTRT=b.F.DIST.RT;F.FINVRT=b.F.INV.RT;F.FINV=b.F.INV;F.FLOOR=br(xr.FLOOR.MATH,xr.FLOOR);F.FLOORMATH=xr.FLOOR.MATH;F.FLOORPRECISE=xr.FLOOR.PRECISE;F.FTEST=b.F.TEST;F.GAMMADIST=b.GAMMA.DIST;F.GAMMAINV=b.GAMMA.INV;F.GAMMALNPRECISE=b.GAMMALN.PRECISE;F.HYPGEOMDIST=b.HYPGEOM.DIST;F.LOGINV=b.LOGNORM.INV;F.LOGNORMINV=b.LOGNORM.INV;F.LOGNORMDIST=b.LOGNORM.DIST;F.MODE=br(b.MODE.SNGL,b.MODE);F.MODEMULT=b.MODE.MULT;F.MODESNGL=b.MODE.SNGL;F.NEGBINOMDIST=b.NEGBINOM.DIST;F.NETWORKDAYSINTL=kn.NETWORKDAYS.INTL;F.NORMDIST=b.NORM.DIST;F.NORMINV=b.NORM.INV;F.NORMSDIST=b.NORM.S.DIST;F.NORMSINV=b.NORM.S.INV;F.PERCENTILE=br(b.PERCENTILE.EXC,b.PERCENTILE);F.PERCENTILEEXC=b.PERCENTILE.EXC;F.PERCENTILEINC=b.PERCENTILE.INC;F.PERCENTRANK=br(b.PERCENTRANK.INC,b.PERCENTRANK);F.PERCENTRANKEXC=b.PERCENTRANK.EXC;F.PERCENTRANKINC=b.PERCENTRANK.INC;F.POISSON=br(b.POISSON.DIST,b.POISSON);F.POISSONDIST=b.POISSON.DIST;F.QUARTILE=br(b.QUARTILE.INC,b.QUARTILE);F.QUARTILEEXC=b.QUARTILE.EXC;F.QUARTILEINC=b.QUARTILE.INC;F.RANK=br(b.RANK.EQ,b.RANK);F.RANKAVG=b.RANK.AVG;F.RANKEQ=b.RANK.EQ;F.SKEWP=b.SKEW.P;F.STDEV=br(b.STDEV.S,b.STDEV);F.STDEVP=b.STDEV.P;F.STDEVS=b.STDEV.S;F.TDIST=b.T.DIST;F.TDISTRT=b.T.DIST.RT;F.TINV=b.T.INV;F.TTEST=b.T.TEST;F.VAR=br(b.VAR.S,b.VAR);F.VARP=b.VAR.P;F.VARS=b.VAR.S;F.WEIBULL=br(b.WEIBULL.DIST,b.WEIBULL);F.WEIBULLDIST=b.WEIBULL.DIST;F.WORKDAYINTL=kn.WORKDAY.INTL;F.ZTEST=b.Z.TEST});var Kn=vr(J=>{var yr=wr(),ie=Ne(),Ft=he(),X=Hr(),Ke=qe();function vn(r){var e=[];return X.arrayEach(r,function(n){n&&e.push(n)}),e}J.FINDFIELD=function(r,e){var n=null;return X.arrayEach(r,function(a,o){if(a[0]===e)return n=o,!1}),n??yr.value};function qr(r,e){for(var n={},a=1;a<r[0].length;++a)n[a]=!0;var o=e[0].length;for(a=1;a<e.length;++a)e[a].length>o&&(o=e[a].length);for(var l=1;l<r.length;++l)for(var c=1;c<r[l].length;++c){for(var i=!1,t=!1,u=0;u<e.length;++u){var f=e[u];if(!(f.length<o)){var s=f[0];if(r[l][0]===s){t=!0;for(var v=1;v<f.length;++v)if(!i){var E=f[v]===void 0||f[v]==="*";if(E)i=!0;else{var p=Ke.parse(f[v]+""),g=[Ke.createToken(r[l][c],Ke.TOKEN_TYPE_LITERAL)].concat(p);i=Ke.compute(g)}}}}}t&&(n[c]=n[c]&&i)}for(var h=[],N=0;N<r[0].length;++N)n[N]&&h.push(N-1);return h}J.DAVERAGE=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=0;return X.arrayEach(a,function(i){c+=o[i]}),a.length===0?yr.div0:c/a.length};J.DCOUNT=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];return X.arrayEach(a,function(i){c.push(o[i])}),ie.COUNT(c)};J.DCOUNTA=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];return X.arrayEach(a,function(i){c.push(o[i])}),ie.COUNTA(c)};J.DGET=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);return a.length===0?yr.value:a.length>1?yr.num:o[a[0]]};J.DMAX=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=o[a[0]];return X.arrayEach(a,function(i){c<o[i]&&(c=o[i])}),c};J.DMIN=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=o[a[0]];return X.arrayEach(a,function(i){c>o[i]&&(c=o[i])}),c};J.DPRODUCT=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];X.arrayEach(a,function(t){c.push(o[t])}),c=vn(c);var i=1;return X.arrayEach(c,function(t){i*=t}),i};J.DSTDEV=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];return X.arrayEach(a,function(i){c.push(o[i])}),c=vn(c),ie.STDEV.S(c)};J.DSTDEVP=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];return X.arrayEach(a,function(i){c.push(o[i])}),c=vn(c),ie.STDEV.P(c)};J.DSUM=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];return X.arrayEach(a,function(i){c.push(o[i])}),Ft.SUM(c)};J.DVAR=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];return X.arrayEach(a,function(i){c.push(o[i])}),ie.VAR.S(c)};J.DVARP=function(r,e,n){if(isNaN(e)&&typeof e!="string")return yr.value;var a=qr(r,n),o=[];if(typeof e=="string"){var l=J.FINDFIELD(r,e);o=X.rest(r[l])}else o=X.rest(r[e]);var c=[];return X.arrayEach(a,function(i){c.push(o[i])}),ie.VAR.P(c)}});var Qn=vr(Gr=>{var fe=wr(),En=Hr(),bt=Ge();Gr.AND=function(){for(var r=En.flatten(arguments),e=!0,n=0;n<r.length;n++)r[n]||(e=!1);return e};Gr.CHOOSE=function(){if(arguments.length<2)return fe.na;var r=arguments[0];return r<1||r>254||arguments.length<r+1?fe.value:arguments[r]};Gr.FALSE=function(){return!1};Gr.IF=function(r,e,n){return r?e:n};Gr.IFERROR=function(r,e){return bt.ISERROR(r)?e:r};Gr.IFNA=function(r,e){return r===fe.na?e:r};Gr.NOT=function(r){return!r};Gr.OR=function(){for(var r=En.flatten(arguments),e=!1,n=0;n<r.length;n++)r[n]&&(e=!0);return e};Gr.TRUE=function(){return!0};Gr.XOR=function(){for(var r=En.flatten(arguments),e=0,n=0;n<r.length;n++)r[n]&&e++;return!!(Math.floor(Math.abs(e))&1)};Gr.SWITCH=function(){var r;if(arguments.length>0){var e=arguments[0],n=arguments.length-1,a=Math.floor(n/2),o=!1,l=n%2!==0,c=n%2===0?null:arguments[arguments.length-1];if(a){for(var i=0;i<a;i++)if(e===arguments[i*2+1]){r=arguments[i*2+2],o=!0;break}}o||(r=l?c:fe.na)}else r=fe.value;return r}});var Wn=vr(q=>{var B=wr(),me=Xe(),M=Hr();function gn(r){return r&&r.getTime&&!isNaN(r.getTime())}function pn(r){return r instanceof Date?r:new Date(r)}q.ACCRINT=function(r,e,n,a,o,l,c){return r=pn(r),e=pn(e),n=pn(n),!gn(r)||!gn(e)||!gn(n)?B.value:a<=0||o<=0||[1,2,4].indexOf(l)===-1||[0,1,2,3,4].indexOf(c)===-1||n<=r?B.num:(o=o||0,c=c||0,o*a*me.YEARFRAC(r,n,c))};q.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")};q.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")};q.AMORLINC=function(){throw new Error("AMORLINC is not implemented")};q.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")};q.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")};q.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")};q.COUPNCD=function(){throw new Error("COUPNCD is not implemented")};q.COUPNUM=function(){throw new Error("COUPNUM is not implemented")};q.COUPPCD=function(){throw new Error("COUPPCD is not implemented")};q.CUMIPMT=function(r,e,n,a,o,l){if(r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),M.anyIsError(r,e,n))return B.value;if(r<=0||e<=0||n<=0||a<1||o<1||a>o||l!==0&&l!==1)return B.num;var c=q.PMT(r,e,n,0,l),i=0;a===1&&l===0&&(i=-n,a++);for(var t=a;t<=o;t++)l===1?i+=q.FV(r,t-2,c,n,1)-c:i+=q.FV(r,t-1,c,n,0);return i*=r,i};q.CUMPRINC=function(r,e,n,a,o,l){if(r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),M.anyIsError(r,e,n))return B.value;if(r<=0||e<=0||n<=0||a<1||o<1||a>o||l!==0&&l!==1)return B.num;var c=q.PMT(r,e,n,0,l),i=0;a===1&&(l===0?i=c+n*r:i=c,a++);for(var t=a;t<=o;t++)l>0?i+=c-(q.FV(r,t-2,c,n,1)-c)*r:i+=c-q.FV(r,t-1,c,n,0)*r;return i};q.DB=function(r,e,n,a,o){if(o=o===void 0?12:o,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),M.anyIsError(r,e,n,a,o))return B.value;if(r<0||e<0||n<0||a<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o)===-1||a>n)return B.num;if(e>=r)return 0;for(var l=(1-Math.pow(e/r,1/n)).toFixed(3),c=r*l*o/12,i=c,t=0,u=a===n?n-1:a,f=2;f<=u;f++)t=(r-i)*l,i+=t;return a===1?c:a===n?(r-i)*l:t};q.DDB=function(r,e,n,a,o){if(o=o===void 0?2:o,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),M.anyIsError(r,e,n,a,o))return B.value;if(r<0||e<0||n<0||a<0||o<=0||a>n)return B.num;if(e>=r)return 0;for(var l=0,c=0,i=1;i<=a;i++)c=Math.min((r-l)*(o/n),r-e-l),l+=c;return c};q.DISC=function(){throw new Error("DISC is not implemented")};q.DOLLARDE=function(r,e){if(r=M.parseNumber(r),e=M.parseNumber(e),M.anyIsError(r,e))return B.value;if(e<0)return B.num;if(e>=0&&e<1)return B.div0;e=parseInt(e,10);var n=parseInt(r,10);n+=r%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var a=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return n=Math.round(n*a)/a,n};q.DOLLARFR=function(r,e){if(r=M.parseNumber(r),e=M.parseNumber(e),M.anyIsError(r,e))return B.value;if(e<0)return B.num;if(e>=0&&e<1)return B.div0;e=parseInt(e,10);var n=parseInt(r,10);return n+=r%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e,n};q.DURATION=function(){throw new Error("DURATION is not implemented")};q.EFFECT=function(r,e){return r=M.parseNumber(r),e=M.parseNumber(e),M.anyIsError(r,e)?B.value:r<=0||e<1?B.num:(e=parseInt(e,10),Math.pow(1+r/e,e)-1)};q.FV=function(r,e,n,a,o){if(a=a||0,o=o||0,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),M.anyIsError(r,e,n,a,o))return B.value;var l;if(r===0)l=a+n*e;else{var c=Math.pow(1+r,e);o===1?l=a*c+n*(1+r)*(c-1)/r:l=a*c+n*(c-1)/r}return-l};q.FVSCHEDULE=function(r,e){if(r=M.parseNumber(r),e=M.parseNumberArray(M.flatten(e)),M.anyIsError(r,e))return B.value;for(var n=e.length,a=r,o=0;o<n;o++)a*=1+e[o];return a};q.INTRATE=function(){throw new Error("INTRATE is not implemented")};q.IPMT=function(r,e,n,a,o,l){if(o=o||0,l=l||0,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),l=M.parseNumber(l),M.anyIsError(r,e,n,a,o,l))return B.value;var c=q.PMT(r,n,a,o,l),i;return e===1?l===1?i=0:i=-a:l===1?i=q.FV(r,e-2,c,a,1)-c:i=q.FV(r,e-1,c,a,0),i*r};q.IRR=function(r,e){if(e=e||0,r=M.parseNumberArray(M.flatten(r)),e=M.parseNumber(e),M.anyIsError(r,e))return B.value;for(var n=function(p,g,h){for(var N=h+1,m=p[0],A=1;A<p.length;A++)m+=p[A]/Math.pow(N,(g[A]-g[0])/365);return m},a=function(p,g,h){for(var N=h+1,m=0,A=1;A<p.length;A++){var R=(g[A]-g[0])/365;m-=R*p[A]/Math.pow(N,R+1)}return m},o=[],l=!1,c=!1,i=0;i<r.length;i++)o[i]=i===0?0:o[i-1]+365,r[i]>0&&(l=!0),r[i]<0&&(c=!0);if(!l||!c)return B.num;e=e===void 0?.1:e;var t=e,u=1e-10,f,s,v,E=!0;do v=n(r,o,t),f=t-v/a(r,o,t),s=Math.abs(f-t),t=f,E=s>u&&Math.abs(v)>u;while(E);return t};q.ISPMT=function(r,e,n,a){return r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),M.anyIsError(r,e,n,a)?B.value:a*r*(e/n-1)};q.MDURATION=function(){throw new Error("MDURATION is not implemented")};q.MIRR=function(r,e,n){if(r=M.parseNumberArray(M.flatten(r)),e=M.parseNumber(e),n=M.parseNumber(n),M.anyIsError(r,e,n))return B.value;for(var a=r.length,o=[],l=[],c=0;c<a;c++)r[c]<0?o.push(r[c]):l.push(r[c]);var i=-q.NPV(n,l)*Math.pow(1+n,a-1),t=q.NPV(e,o)*(1+e);return Math.pow(i/t,1/(a-1))-1};q.NOMINAL=function(r,e){return r=M.parseNumber(r),e=M.parseNumber(e),M.anyIsError(r,e)?B.value:r<=0||e<1?B.num:(e=parseInt(e,10),(Math.pow(r+1,1/e)-1)*e)};q.NPER=function(r,e,n,a,o){if(o=o===void 0?0:o,a=a===void 0?0:a,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),M.anyIsError(r,e,n,a,o))return B.value;var l=e*(1+r*o)-a*r,c=n*r+e*(1+r*o);return Math.log(l/c)/Math.log(1+r)};q.NPV=function(){var r=M.parseNumberArray(M.flatten(arguments));if(r instanceof Error)return r;for(var e=r[0],n=0,a=1;a<r.length;a++)n+=r[a]/Math.pow(1+e,a);return n};q.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")};q.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")};q.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")};q.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")};q.PDURATION=function(r,e,n){return r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),M.anyIsError(r,e,n)?B.value:r<=0?B.num:(Math.log(n)-Math.log(e))/Math.log(1+r)};q.PMT=function(r,e,n,a,o){if(a=a||0,o=o||0,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),M.anyIsError(r,e,n,a,o))return B.value;var l;if(r===0)l=(n+a)/e;else{var c=Math.pow(1+r,e);o===1?l=(a*r/(c-1)+n*r/(1-1/c))/(1+r):l=a*r/(c-1)+n*r/(1-1/c)}return-l};q.PPMT=function(r,e,n,a,o,l){return o=o||0,l=l||0,r=M.parseNumber(r),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),l=M.parseNumber(l),M.anyIsError(r,n,a,o,l)?B.value:q.PMT(r,n,a,o,l)-q.IPMT(r,e,n,a,o,l)};q.PRICE=function(){throw new Error("PRICE is not implemented")};q.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")};q.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")};q.PV=function(r,e,n,a,o){return a=a||0,o=o||0,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),M.anyIsError(r,e,n,a,o)?B.value:r===0?-n*e-a:((1-Math.pow(1+r,e))/r*n*(1+r*o)-a)/Math.pow(1+r,e)};q.RATE=function(r,e,n,a,o,l){if(l=l===void 0?.01:l,a=a===void 0?0:a,o=o===void 0?0:o,r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),o=M.parseNumber(o),l=M.parseNumber(l),M.anyIsError(r,e,n,a,o,l))return B.value;var c=1e-10,i=50,t,u,f,s,v=0,E=0,p=0,g=l;for(Math.abs(g)<c?t=n*(1+r*g)+e*(1+g*o)*r+a:(E=Math.exp(r*Math.log(1+g)),t=n*E+e*(1/g+o)*(E-1)+a),u=n+e*r+a,f=n*E+e*(1/g+o)*(E-1)+a,p=s=0,v=g;Math.abs(u-f)>c&&p<i;)g=(f*s-u*v)/(f-u),s=v,v=g,Math.abs(g)<c?t=n*(1+r*g)+e*(1+g*o)*r+a:(E=Math.exp(r*Math.log(1+g)),t=n*E+e*(1/g+o)*(E-1)+a),u=f,f=t,++p;return g};q.RECEIVED=function(){throw new Error("RECEIVED is not implemented")};q.RRI=function(r,e,n){return r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),M.anyIsError(r,e,n)?B.value:r===0||e===0?B.num:Math.pow(n/e,1/r)-1};q.SLN=function(r,e,n){return r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),M.anyIsError(r,e,n)?B.value:n===0?B.num:(r-e)/n};q.SYD=function(r,e,n,a){return r=M.parseNumber(r),e=M.parseNumber(e),n=M.parseNumber(n),a=M.parseNumber(a),M.anyIsError(r,e,n,a)?B.value:n===0||a<1||a>n?B.num:(a=parseInt(a,10),(r-e)*(n-a+1)*2/(n*(n+1)))};q.TBILLEQ=function(r,e,n){return r=M.parseDate(r),e=M.parseDate(e),n=M.parseNumber(n),M.anyIsError(r,e,n)?B.value:n<=0||r>e||e-r>365*24*60*60*1e3?B.num:365*n/(360-n*me.DAYS360(r,e,!1))};q.TBILLPRICE=function(r,e,n){return r=M.parseDate(r),e=M.parseDate(e),n=M.parseNumber(n),M.anyIsError(r,e,n)?B.value:n<=0||r>e||e-r>365*24*60*60*1e3?B.num:100*(1-n*me.DAYS360(r,e,!1)/360)};q.TBILLYIELD=function(r,e,n){return r=M.parseDate(r),e=M.parseDate(e),n=M.parseNumber(n),M.anyIsError(r,e,n)?B.value:n<=0||r>e||e-r>365*24*60*60*1e3?B.num:(100-n)*360/(n*me.DAYS360(r,e,!1))};q.VDB=function(){throw new Error("VDB is not implemented")};q.XNPV=function(r,e,n){if(r=M.parseNumber(r),e=M.parseNumberArray(M.flatten(e)),n=M.parseDateArray(M.flatten(n)),M.anyIsError(r,e,n))return B.value;for(var a=0,o=0;o<e.length;o++)a+=e[o]/Math.pow(1+r,me.DAYS(n[o],n[0])/365);return a};q.YIELD=function(){throw new Error("YIELD is not implemented")};q.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")};q.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}});var zn=vr(Qe=>{var Wr=wr(),qt=Hr();Qe.MATCH=function(r,e,n){if(!r&&!e||(arguments.length===2&&(n=1),!(e instanceof Array))||n!==-1&&n!==0&&n!==1)return Wr.na;for(var a,o,l=0;l<e.length;l++)if(n===1){if(e[l]===r)return l+1;e[l]<r&&(o?e[l]>o&&(a=l+1,o=e[l]):(a=l+1,o=e[l]))}else if(n===0){if(typeof r=="string"){if(r=r.replace(/\?/g,"."),e[l].toLowerCase().match(r.toLowerCase()))return l+1}else if(e[l]===r)return l+1}else if(n===-1){if(e[l]===r)return l+1;e[l]>r&&(o?e[l]<o&&(a=l+1,o=e[l]):(a=l+1,o=e[l]))}return a||Wr.na};Qe.VLOOKUP=function(r,e,n,a){if(!r||!e||!n)return Wr.na;a=a||!1;for(var o=0;o<e.length;o++){var l=e[o];if(!a&&l[0]===r||l[0]===r||a&&typeof l[0]=="string"&&l[0].toLowerCase().indexOf(r.toLowerCase())!==-1)return n<l.length+1?l[n-1]:Wr.ref}return Wr.na};Qe.HLOOKUP=function(r,e,n,a){if(!r||!e||!n)return Wr.na;a=a||!1;for(var o=qt.transpose(e),l=0;l<o.length;l++){var c=o[l];if(!a&&c[0]===r||c[0]===r||a&&typeof c[0]=="string"&&c[0].toLowerCase().indexOf(r.toLowerCase())!==-1)return n<c.length+1?c[n-1]:Wr.ref}return Wr.na}});var $n=vr(hn=>{var Zn=[Xn(),Kn(),ln(),Qn(),he(),Ue(),Xe(),Wn(),Ge(),zn(),Ne(),an()];for(Jn in Zn){Nn=Zn[Jn];for(We in Nn)hn[We]=hn[We]||Nn[We]}var Nn,We,Jn});var st=Cn(Ln(),1);function Nr(r){var e;return typeof r=="number"?e=r:typeof r=="string"&&(e=r.indexOf(".")>-1?parseFloat(r):parseInt(r,10)),e}function Dn(r){return-1*Nr(r)}var Xr;function Jr(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}var ue="ERROR",Ve="DIV/0",$r="NAME",wn="N/A",dn="NULL",Pn="NUM",Vn="REF",Vr="VALUE",ce=(Xr={},Jr(Xr,ue,"#ERROR!"),Jr(Xr,Ve,"#DIV/0!"),Jr(Xr,$r,"#NAME?"),Jr(Xr,wn,"#N/A"),Jr(Xr,dn,"#NULL!"),Jr(Xr,Pn,"#NUM!"),Jr(Xr,Vn,"#REF!"),Jr(Xr,Vr,"#VALUE!"),Xr);function jr(r){var e;return r=(r+"").replace(/#|!|\?/g,""),ce[r]&&(e=ce[r]),e||null}function Un(r){var e=!1;for(var n in ce)if(Object.prototype.hasOwnProperty.call(ce,n)&&ce[n]===r){e=!0;break}return e}var Nt="+";function ve(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var o=n.reduce(function(l,c){return l+Nr(c)},Nr(r));if(isNaN(o))throw Error(Vr);return o}ve.SYMBOL=Nt;var ht="&";function Ee(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return e.reduce(function(a,o){return a+o.toString()},"")}Ee.SYMBOL=ht;var mt="/";function ge(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var o=n.reduce(function(l,c){return l/Nr(c)},Nr(r));if(o===1/0)throw Error(Ve);if(isNaN(o))throw Error(Vr);return o}ge.SYMBOL=mt;var It="=";function pe(r,e){return r===e}pe.SYMBOL=It;var Ie=Cn($n(),1);var Gt=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"],mn=Gt;var Bt=mn;function se(r){return function(){r=r.toUpperCase();var n=r.split("."),a=!1,o;if(n.length===1)Ie.default[n[0]]&&(a=!0,o=Ie.default[n[0]].apply(Ie.default,arguments));else{for(var l=n.length,c=0,i=Ie.default;c<l;)if(i=i[n[c]],c++,!i){i=null;break}i&&(a=!0,o=i.apply(void 0,arguments))}if(!a)throw Error($r);return o}}se.isFactory=!0;se.SYMBOL=Bt;var Yt=">";function Ae(r,e){return r>e}Ae.SYMBOL=Yt;var St=">=";function Re(r,e){return r>=e}Re.SYMBOL=St;var Ht="<";function Te(r,e){return r<e}Te.SYMBOL=Ht;var kt="<=";function Oe(r,e){return r<=e}Oe.SYMBOL=kt;var Xt="-";function ye(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var o=n.reduce(function(l,c){return l-Nr(c)},Nr(r));if(isNaN(o))throw Error(Vr);return o}ye.SYMBOL=Xt;var Kt="*";function Me(r){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var o=n.reduce(function(l,c){return l*Nr(c)},Nr(r));if(isNaN(o))throw Error(Vr);return o}Me.SYMBOL=Kt;var Qt="<>";function Ce(r,e){return r!==e}Ce.SYMBOL=Qt;var Wt="^";function Le(r,e){var n=Math.pow(Nr(r),Nr(e));if(isNaN(n))throw Error(Vr);return n}Le.SYMBOL=Wt;function zt(r){return _t(r)||$t(r)||Jt(r)||Zt()}function Zt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jt(r,e){if(!!r){if(typeof r=="string")return In(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return In(r,e)}}function $t(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}function _t(r){if(Array.isArray(r))return In(r)}function In(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=r[n];return a}var De=Object.create(null);function ze(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(r=r.toUpperCase(),!De[r])throw Error($r);return De[r].apply(De,zt(e))}function dr(r,e){Array.isArray(r)||(r=[r.toUpperCase()]),r.forEach(function(n){e.isFactory?De[n]=e(n):De[n]=e})}dr(ve.SYMBOL,ve);dr(Ee.SYMBOL,Ee);dr(ge.SYMBOL,ge);dr(pe.SYMBOL,pe);dr(Le.SYMBOL,Le);dr(se.SYMBOL,se);dr(Ae.SYMBOL,Ae);dr(Re.SYMBOL,Re);dr(Te.SYMBOL,Te);dr(Oe.SYMBOL,Oe);dr(Me.SYMBOL,Me);dr(Ce.SYMBOL,Ce);dr(ye.SYMBOL,ye);var H=function(e,n,a,o){for(a=a||{},o=e.length;o--;a[e[o]]=n);return a},nr=[1,5],tr=[1,8],ur=[1,6],ar=[1,7],or=[1,9],ir=[1,14],fr=[1,15],sr=[1,16],lr=[1,12],cr=[1,13],er=[1,17],gr=[1,19],we=[1,20],Br=[1,21],ee=[1,22],ne=[1,23],le=[1,24],Yr=[1,25],Mr=[1,26],Cr=[1,27],mr=[1,28],rr=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],_n=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],An=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],Ze=[5,10,11,13,14,15,16,17,29,30],de=[5,10,13,14,15,16,29,30],xn=[5,10,11,13,14,15,16,17,18,19,29,30],Je=[13,29,30],Rn={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(e,n,a,o,l,c,i){var t=c.length-1;switch(l){case 1:return c[t-1];case 2:this.$=o.callVariable(c[t][0]);break;case 3:this.$=o.toNumber(c[t]);break;case 4:this.$=o.trimEdges(c[t]);break;case 5:this.$=o.evaluateByOperator("&",[c[t-2],c[t]]);break;case 6:this.$=o.evaluateByOperator("=",[c[t-2],c[t]]);break;case 7:this.$=o.evaluateByOperator("+",[c[t-2],c[t]]);break;case 8:this.$=c[t-1];break;case 9:this.$=o.evaluateByOperator("<=",[c[t-3],c[t]]);break;case 10:this.$=o.evaluateByOperator(">=",[c[t-3],c[t]]);break;case 11:this.$=o.evaluateByOperator("<>",[c[t-3],c[t]]);break;case 12:this.$=o.evaluateByOperator("NOT",[c[t-2],c[t]]);break;case 13:this.$=o.evaluateByOperator(">",[c[t-2],c[t]]);break;case 14:this.$=o.evaluateByOperator("<",[c[t-2],c[t]]);break;case 15:this.$=o.evaluateByOperator("-",[c[t-2],c[t]]);break;case 16:this.$=o.evaluateByOperator("*",[c[t-2],c[t]]);break;case 17:this.$=o.evaluateByOperator("/",[c[t-2],c[t]]);break;case 18:this.$=o.evaluateByOperator("^",[c[t-2],c[t]]);break;case 19:var u=o.invertNumber(c[t]);this.$=u,isNaN(this.$)&&(this.$=0);break;case 20:var u=o.toNumber(c[t]);this.$=u,isNaN(this.$)&&(this.$=0);break;case 21:this.$=o.callFunction(c[t-2]);break;case 22:this.$=o.callFunction(c[t-3],c[t-1]);break;case 26:case 27:case 28:this.$=o.cellValue(c[t]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=o.rangeValue(c[t-2],c[t]);break;case 38:case 42:this.$=[c[t]];break;case 39:this.$=o.trimEdges(e).split(",");break;case 40:case 41:c[t-2].push(c[t]),this.$=c[t-2];break;case 43:this.$=Array.isArray(c[t-2])?c[t-2]:[c[t-2]],this.$.push(c[t]);break;case 44:this.$=c[t];break;case 45:this.$=(c[t-2]+"."+c[t])*1;break;case 46:this.$=c[t-1]*.01;break;case 47:this.$=o.throwError(c[t]);break}},table:[{2:11,3:1,4:2,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{1:[3]},{5:[1,18],9:gr,10:we,11:Br,14:ee,15:ne,16:le,17:Yr,18:Mr,19:Cr,20:mr},H(rr,[2,2],{32:[1,29]}),H(rr,[2,3],{34:[1,30]}),H(rr,[2,4]),{2:11,4:31,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:32,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:33,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{12:[1,34]},H(rr,[2,23]),H(rr,[2,24],{2:35,35:er}),H(_n,[2,42]),H(An,[2,44],{32:[1,36]}),H(rr,[2,26],{27:[1,37]}),H(rr,[2,27],{27:[1,38]}),H(rr,[2,28],{27:[1,39]}),H([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:41,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:42,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:45,6:3,7:4,8:nr,10:[1,43],11:tr,12:ur,15:[1,44],17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:47,6:3,7:4,8:nr,10:[1,46],11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:48,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:49,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:50,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:51,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:52,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{31:[1,53]},H(An,[2,46]),{9:gr,10:we,11:Br,13:[1,54],14:ee,15:ne,16:le,17:Yr,18:Mr,19:Cr,20:mr},H(Ze,[2,19],{9:gr,18:Mr,19:Cr,20:mr}),H(Ze,[2,20],{9:gr,18:Mr,19:Cr,20:mr}),{2:11,4:57,6:3,7:4,8:nr,11:tr,12:ur,13:[1,55],17:ar,21:or,22:56,23:10,24:ir,25:fr,26:sr,28:[1,58],31:lr,33:cr,35:er},H(rr,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},H(rr,[2,5]),H([5,10,13,29,30],[2,6],{9:gr,11:Br,14:ee,15:ne,16:le,17:Yr,18:Mr,19:Cr,20:mr}),H(Ze,[2,7],{9:gr,18:Mr,19:Cr,20:mr}),{2:11,4:69,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:70,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},H(de,[2,14],{9:gr,11:Br,17:Yr,18:Mr,19:Cr,20:mr}),{2:11,4:71,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},H(de,[2,13],{9:gr,11:Br,17:Yr,18:Mr,19:Cr,20:mr}),H([5,10,13,16,29,30],[2,12],{9:gr,11:Br,14:ee,15:ne,17:Yr,18:Mr,19:Cr,20:mr}),H(Ze,[2,15],{9:gr,18:Mr,19:Cr,20:mr}),H(xn,[2,16],{9:gr,20:mr}),H(xn,[2,17],{9:gr,20:mr}),H([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:gr}),H(_n,[2,43]),H(rr,[2,8]),H(rr,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},H(Je,[2,38],{9:gr,10:we,11:Br,14:ee,15:ne,16:le,17:Yr,18:Mr,19:Cr,20:mr}),H(Je,[2,39]),H(An,[2,45]),H(rr,[2,29]),H(rr,[2,30]),H(rr,[2,31]),H(rr,[2,32]),H(rr,[2,33]),H(rr,[2,34]),H(rr,[2,35]),H(rr,[2,36]),H(rr,[2,37]),H(de,[2,9],{9:gr,11:Br,17:Yr,18:Mr,19:Cr,20:mr}),H(de,[2,11],{9:gr,11:Br,17:Yr,18:Mr,19:Cr,20:mr}),H(de,[2,10],{9:gr,11:Br,17:Yr,18:Mr,19:Cr,20:mr}),H(rr,[2,22]),{2:11,4:75,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},{2:11,4:76,6:3,7:4,8:nr,11:tr,12:ur,17:ar,21:or,23:10,24:ir,25:fr,26:sr,31:lr,33:cr,35:er},H(Je,[2,40],{9:gr,10:we,11:Br,14:ee,15:ne,16:le,17:Yr,18:Mr,19:Cr,20:mr}),H(Je,[2,41],{9:gr,10:we,11:Br,14:ee,15:ne,16:le,17:Yr,18:Mr,19:Cr,20:mr})],defaultActions:{18:[2,1]},parseError:function(e,n){if(n.recoverable)this.trace(e);else{var a=new Error(e);throw a.hash=n,a}},parse:function(e){var n=this,a=[0],o=[],l=[null],c=[],i=this.table,t="",u=0,f=0,s=0,v=2,E=1,p=c.slice.call(arguments,1),g=Object.create(this.lexer),h={yy:{}};for(var N in this.yy)Object.prototype.hasOwnProperty.call(this.yy,N)&&(h.yy[N]=this.yy[N]);g.setInput(e,h.yy),h.yy.lexer=g,h.yy.parser=this,typeof g.yylloc>"u"&&(g.yylloc={});var m=g.yylloc;c.push(m);var A=g.options&&g.options.ranges;typeof h.yy.parseError=="function"?this.parseError=h.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function R(Lr){a.length=a.length-2*Lr,l.length=l.length-Lr,c.length=c.length-Lr}for(var y=function(){var $;return $=g.lex()||E,typeof $!="number"&&($=n.symbols_[$]||$),$},C,V,P,Y,Ir,z,W={},Ar,pr,j,Pr;;){if(P=a[a.length-1],this.defaultActions[P]?Y=this.defaultActions[P]:((C===null||typeof C>"u")&&(C=y()),Y=i[P]&&i[P][C]),typeof Y>"u"||!Y.length||!Y[0]){var Dr=function($){for(var Sr=a.length-1,Zr=0;;){if(v.toString()in i[$])return Zr;if($===0||Sr<2)return!1;Sr-=2,$=a[Sr],++Zr}},Rr,Tr="";if(s)V!==E&&(Rr=Dr(P));else{Rr=Dr(P),Pr=[];for(Ar in i[P])this.terminals_[Ar]&&Ar>v&&Pr.push("'"+this.terminals_[Ar]+"'");g.showPosition?Tr="Parse error on line "+(u+1)+`:
`+g.showPosition()+`
Expecting `+Pr.join(", ")+", got '"+(this.terminals_[C]||C)+"'":Tr="Parse error on line "+(u+1)+": Unexpected "+(C==E?"end of input":"'"+(this.terminals_[C]||C)+"'"),this.parseError(Tr,{text:g.match,token:this.terminals_[C]||C,line:g.yylineno,loc:m,expected:Pr,recoverable:Rr!==!1})}if(s==3){if(C===E||V===E)throw new Error(Tr||"Parsing halted while starting to recover from another error.");f=g.yyleng,t=g.yytext,u=g.yylineno,m=g.yylloc,C=y()}if(Rr===!1)throw new Error(Tr||"Parsing halted. No suitable error recovery rule available.");R(Rr),V=C==v?null:C,C=v,P=a[a.length-1],Y=i[P]&&i[P][v],s=3}if(Y[0]instanceof Array&&Y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+P+", token: "+C);switch(Y[0]){case 1:a.push(C),l.push(g.yytext),c.push(g.yylloc),a.push(Y[1]),C=null,V?(C=V,V=null):(f=g.yyleng,t=g.yytext,u=g.yylineno,m=g.yylloc,s>0&&s--);break;case 2:if(pr=this.productions_[Y[1]][1],W.$=l[l.length-pr],W._$={first_line:c[c.length-(pr||1)].first_line,last_line:c[c.length-1].last_line,first_column:c[c.length-(pr||1)].first_column,last_column:c[c.length-1].last_column},A&&(W._$.range=[c[c.length-(pr||1)].range[0],c[c.length-1].range[1]]),z=this.performAction.apply(W,[t,f,u,h.yy,Y[1],l,c].concat(p)),typeof z<"u")return z;pr&&(a=a.slice(0,-1*pr*2),l=l.slice(0,-1*pr),c=c.slice(0,-1*pr)),a.push(this.productions_[Y[1]][0]),l.push(W.$),c.push(W._$),j=i[a[a.length-2]][a[a.length-1]],a.push(j);break;case 3:return!0}}return!0}},xt=function(){var r={EOF:1,parseError:function(n,a){if(this.yy.parser)this.yy.parser.parseError(n,a);else throw new Error(n)},setInput:function(n,a){return this.yy=a||this.yy||{},this._input=n,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var n=this._input[0];this.yytext+=n,this.yyleng++,this.offset++,this.match+=n,this.matched+=n;var a=n.match(/(?:\r\n?|\n).*/g);return a?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),n},unput:function(n){var a=n.length,o=n.split(/(?:\r\n?|\n)/g);this._input=n+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-a),this.offset-=a;var l=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),o.length-1&&(this.yylineno-=o.length-1);var c=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:o?(o.length===l.length?this.yylloc.first_column:0)+l[l.length-o.length].length-o[0].length:this.yylloc.first_column-a},this.options.ranges&&(this.yylloc.range=[c[0],c[0]+this.yyleng-a]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var n=this.matched.substr(0,this.matched.length-this.match.length);return(n.length>20?"...":"")+n.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var n=this.match;return n.length<20&&(n+=this._input.substr(0,20-n.length)),(n.substr(0,20)+(n.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var n=this.pastInput(),a=new Array(n.length+1).join("-");return n+this.upcomingInput()+`
`+a+"^"},test_match:function(n,a){var o,l,c;if(this.options.backtrack_lexer&&(c={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(c.yylloc.range=this.yylloc.range.slice(0))),l=n[0].match(/(?:\r\n?|\n).*/g),l&&(this.yylineno+=l.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:l?l[l.length-1].length-l[l.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+n[0].length},this.yytext+=n[0],this.match+=n[0],this.matches=n,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(n[0].length),this.matched+=n[0],o=this.performAction.call(this,this.yy,this,a,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),o)return o;if(this._backtrack){for(var i in c)this[i]=c[i];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var n,a,o,l;this._more||(this.yytext="",this.match="");for(var c=this._currentRules(),i=0;i<c.length;i++)if(o=this._input.match(this.rules[c[i]]),o&&(!a||o[0].length>a[0].length)){if(a=o,l=i,this.options.backtrack_lexer){if(n=this.test_match(o,c[i]),n!==!1)return n;if(this._backtrack){a=!1;continue}else return!1}else if(!this.options.flex)break}return a?(n=this.test_match(a,c[l]),n!==!1?n:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var n=this.next();return n||this.lex()},begin:function(n){this.conditionStack.push(n)},popState:function(){var n=this.conditionStack.length-1;return n>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(n){return n=this.conditionStack.length-1-Math.abs(n||0),n>=0?this.conditionStack[n]:"INITIAL"},pushState:function(n){this.begin(n)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(n,a,o,l){var c=l;switch(o){case 0:break;case 1:return 8;case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:return 26;case 7:return 26;case 8:return 25;case 9:return 21;case 10:return 31;case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};return r}();Rn.lexer=xt;function $e(){this.yy={}}$e.prototype=Rn;Rn.Parser=$e;function jn(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return r=r.substring(e,r.length-e),r}function jt(r,e){return tu(r)||nu(r,e)||eu(r,e)||ru()}function ru(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eu(r,e){if(!!r){if(typeof r=="string")return rt(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(r,e)}}function rt(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=r[n];return a}function nu(r,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var n=[],a=!0,o=!1,l=void 0;try{for(var c=r[Symbol.iterator](),i;!(a=(i=c.next()).done)&&(n.push(i.value),!(e&&n.length===e));a=!0);}catch(t){o=!0,l=t}finally{try{!a&&c.return!=null&&c.return()}finally{if(o)throw l}}return n}}function tu(r){if(Array.isArray(r))return r}function nt(r){var e=parseInt(r,10);return isNaN(e)?e=-1:e=Math.max(e-1,-1),e}function tt(r){var e="";return r>=0&&(e="".concat(r+1)),e}var ut="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Tn=ut.length;function at(r){var e=0;if(typeof r=="string"){r=r.toUpperCase();for(var n=0,a=r.length-1;n<r.length;n+=1,a-=1)e+=Math.pow(Tn,a)*(ut.indexOf(r[n])+1)}return--e,e}function ot(r){for(var e="";r>=0;)e=String.fromCharCode(r%Tn+97)+e,r=Math.floor(r/Tn)-1;return e.toUpperCase()}var et=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function Pe(r){if(typeof r!="string"||!et.test(r))return[];var e=r.toUpperCase().match(et),n=jt(e,5),a=n[1],o=n[2],l=n[3],c=n[4];return[{index:nt(c),label:c,isAbsolute:l==="$"},{index:at(o),label:o,isAbsolute:a==="$"}]}function _e(r,e){var n=(r.isAbsolute?"$":"")+tt(r.index),a=(e.isAbsolute?"$":"")+ot(e.index);return a+n}function xe(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xe=function(n){return typeof n}:xe=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},xe(r)}function On(r,e){return iu(r)||ou(r,e)||au(r,e)||uu()}function uu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function au(r,e){if(!!r){if(typeof r=="string")return it(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(r,e)}}function it(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=r[n];return a}function ou(r,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var n=[],a=!0,o=!1,l=void 0;try{for(var c=r[Symbol.iterator](),i;!(a=(i=c.next()).done)&&(n.push(i.value),!(e&&n.length===e));a=!0);}catch(t){o=!0,l=t}finally{try{!a&&c.return!=null&&c.return()}finally{if(o)throw l}}return n}}function iu(r){if(Array.isArray(r))return r}function fu(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ft(r,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}function su(r,e,n){return e&&ft(r.prototype,e),n&&ft(r,n),r}function lu(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&yn(r,e)}function yn(r,e){return yn=Object.setPrototypeOf||function(a,o){return a.__proto__=o,a},yn(r,e)}function cu(r){var e=gu();return function(){var a=je(r),o;if(e){var l=je(this).constructor;o=Reflect.construct(a,arguments,l)}else o=a.apply(this,arguments);return vu(this,o)}}function vu(r,e){return e&&(xe(e)==="object"||typeof e=="function")?e:Eu(r)}function Eu(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function gu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function je(r){return je=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},je(r)}var pu=function(r){lu(n,r);var e=cu(n);function n(){var a;return fu(this,n),a=e.call(this),a.parser=new $e,a.parser.yy={toNumber:Nr,trimEdges:jn,invertNumber:Dn,throwError:function(l){return a._throwError(l)},callVariable:function(l){return a._callVariable(l)},evaluateByOperator:ze,callFunction:function(l,c){return a._callFunction(l,c)},cellValue:function(l){return a._callCellValue(l)},rangeValue:function(l,c){return a._callRangeValue(l,c)}},a.variables=Object.create(null),a.functions=Object.create(null),a.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),a}return su(n,[{key:"parse",value:function(o){var l=null,c=null;try{o===""?l="":l=this.parser.parse(o)}catch(t){var i=jr(t.message);i?c=i:c=jr(ue)}return l instanceof Error&&(c=jr(l.message)||jr(ue),l=null),{error:c,result:l}}},{key:"setVariable",value:function(o,l){return this.variables[o]=l,this}},{key:"getVariable",value:function(o){return this.variables[o]}},{key:"_callVariable",value:function(o){var l=this.getVariable(o);if(this.emit("callVariable",o,function(c){c!==void 0&&(l=c)}),l===void 0)throw Error($r);return l}},{key:"setFunction",value:function(o,l){return this.functions[o]=l,this}},{key:"getFunction",value:function(o){return this.functions[o]}},{key:"_callFunction",value:function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=this.getFunction(o),i;return c&&(i=c(l)),this.emit("callFunction",o,l,function(t){t!==void 0&&(i=t)}),i===void 0?ze(o,l):i}},{key:"_callCellValue",value:function(o){o=o.toUpperCase();var l=Pe(o),c=On(l,2),i=c[0],t=c[1],u=void 0;return this.emit("callCellValue",{label:o,row:i,column:t},function(f){u=f}),u}},{key:"_callRangeValue",value:function(o,l){o=o.toUpperCase(),l=l.toUpperCase();var c=Pe(o),i=On(c,2),t=i[0],u=i[1],f=Pe(l),s=On(f,2),v=s[0],E=s[1],p={},g={};t.index<=v.index?(p.row=t,g.row=v):(p.row=v,g.row=t),u.index<=E.index?(p.column=u,g.column=E):(p.column=E,g.column=u),p.label=_e(p.row,p.column),g.label=_e(g.row,g.column);var h=[];return this.emit("callRangeValue",p,g,function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];h=N}),h}},{key:"_throwError",value:function(o){throw Un(o)?Error(o):Error(ue)}}]),n}(st.default),Nu=pu;export{ue as ERROR,Ve as ERROR_DIV_ZERO,$r as ERROR_NAME,wn as ERROR_NOT_AVAILABLE,dn as ERROR_NULL,Pn as ERROR_NUM,Vn as ERROR_REF,Vr as ERROR_VALUE,Nu as Parser,mn as SUPPORTED_FORMULAS,ot as columnIndexToLabel,at as columnLabelToIndex,jr as error,Pe as extractLabel,tt as rowIndexToLabel,nt as rowLabelToIndex,_e as toLabel};
